!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((t="undefined"!=typeof globalThis?globalThis:t||self).monaco={})}(this,function(t){"use strict";const s=document.createElement("style");s.textContent="\n  .monaco-hover .hover-row.status-bar {\n    display: none !important;\n  }\n",document.head.appendChild(s);class n{t={};o={};i;u=0;h=1e4;constructor(t){this.i=t,Object.keys(t).forEach(t=>{this.o[t]=[]})}l(t,s,n=this.h){return new Promise((o,e)=>{const i=t;this.u++,this.o[i].push({uid:this.u,cmd:i,args:s,onSuccess:o,onError:e,timeout:n});this.t[i]||this.m(i)})}m(t){const s=this.o[t].shift();if(this.t[t]=s,s){const n=this.i[t],o=this.p.bind(this);setTimeout(()=>{const{cmd:t,args:e,uid:i,timeout:c}=s;n(i,...e),s.timer=setTimeout(()=>o(i,t,"error",void 0),c)})}}p(t,s,n,o){const e=s,i=this.t[e];i&&i.uid===t&&(i.timer&&clearTimeout(i.timer),"success"===n?i.onSuccess(o):i.onError(o),this.m(e))}}const o={"Type (.+) is missing the following properties from type 'any\\[\\]'.+$":"Is not an array: $1"};function e(t){if(t)for(const s in o){const n=new RegExp(s);if(n.test(t))return t.replace(n,o[s])}return t}class i extends n{$;_;v;k;constructor(t,s,n,o){super({cd:(t,n,o,e)=>{this.st(n),this.sd(o),this.T(t,"cd",s.doc,e)},ce:(t,n,o)=>{this.se(n),this.T(t,"ce",s.exp,o)}}),this.$=s,this._=n,this.v=o,t.editor.registerLinkOpener({open:this.S})}S=t=>{if("file"===t.scheme&&t.path.startsWith("/@/")){const s=[t.path.substring(3),t.query].filter(Boolean).join("?");this.k?.(s)}return!0};fm=()=>{const t=this.v.getAction("editor.action.formatDocument")?.run();return t||Promise.resolve()};ol=t=>{this.k=t};iv=t=>{const s=this.v,n=s.getSelection();if(n){const o=function(t,s){const n=t.join("\n").replace(/\\`/g,'\\"').matchAll(/`[^`]*`/g),o=[];for(const t of n)o.push([t.index,t.index+t[0].length]);const e=t.slice(0,s.lineNumber-1);e.push(t[s.lineNumber-1].slice(0,s.column-1));const i=e.join("\n").length;for(const t of o)if(t[0]<i&&t[1]>i)return!0;return!1}(s.getModel().getLinesContent(),n.getStartPosition());o&&(t=`\${${t}}`);const e={range:n,text:t};s.executeEdits("",[e])}};T(t,s,n,o){const i=this._;Promise.all([i.getSyntacticDiagnostics(n.url),i.getSemanticDiagnostics(n.url)]).then(([i,c])=>{const r=[...i,...c];if(r.length){const i=n.model.getLinesContent()||[],c=r.map(t=>{const{lineNumber:s=1}=n.model.getPositionAt(t.start||0);return function(t,s,n,o){let i=s-1;const c=t[i];for(;i>-1;){const s=t[i];if(s.startsWith(o)){const t=e(n).substring(0,200);return{id:s.substring(o.length),message:t||c.substring(0,200)}}i--}}(i,s,"string"==typeof t.messageText?t.messageText:t.messageText?.messageText||"",o)}).reduce((t,s)=>(s&&(t[s.id]=s.message),t),{});this.p(t,s,"success",c)}else this.p(t,s,"success",{})}).catch(n=>{this.p(t,s,"error",n)})}ss=t=>{const s=this.$;return s.sys.value!==t&&(s.sys.value=t,s.sys.model.setValue(t),console.log(`${s.sys.url}\n`,t),!0)};su=t=>{const s=this.$;return s.utl.value!==t&&(s.utl.value=t,s.utl.model.setValue(t),console.log(`${s.utl.url}\n`,t),!0)};sv=t=>{const s=this.$;return s.var.value!==t&&(s.var.value=t,s.var.model.setValue(t),console.log(`${s.var.url}\n`,t),!0)};st=t=>{const s=this.$;return s.typ.value!==t&&(s.typ.value=t,s.typ.model.setValue(t),console.log(`${s.typ.url}\n`,t),!0)};sd=t=>{const s=this.$;return s.doc.value!==t&&(s.doc.value=t,s.doc.model.setValue(`${t}\nexport {};`),console.log(`${s.doc.url}\n`,`${t}\nexport {};`),!0)};se=t=>{const s=this.$;return s.exp.value!==t&&(s.exp.value=t,s.exp.model.setValue(`${t}\nexport {};`),console.log(`${s.exp.url}\n`,`${t}\nexport {};`),!0)};sc=(t,s="",n="expression")=>{const o=this.$;return o.ctx.value!==s&&(o.ctx.value=s,o.ctx.model.setValue(s),console.log(`${o.ctx.url}\n`,s)),o.cur.value=t,o.cur.model.setValue(t),console.log(`${o.cur.url}\n`,t),!0};gc=()=>this.$.cur.model.getValue();cd=(t,s,n)=>this.l("cd",[t,s,n]);ce=(t,s)=>this.l("ce",[t,s])}t.initMonaco=async function(t){const s=t.languages.typescript.typescriptDefaults.getCompilerOptions();s.lib=["es5"],s.isolatedModules=!0,s.checkJs=!1,s.skipLibCheck=!0,s.strict=!0,t.languages.typescript.typescriptDefaults.setCompilerOptions(s),t.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSuggestionDiagnostics:!0}),t.languages.registerDefinitionProvider("typescript",{provideDefinition:()=>[]});const n=["exp","ctx","cur","doc","sys.d","typ.d","var.d","utl.d"].reduce((s,n)=>{const o=n.split(".")[0];return s[o]={url:`ts://lib/${n}.ts`,value:""},s[o].model=t.editor.createModel("","typescript",t.Uri.parse(s[o].url)),s},{}),o=await t.languages.typescript.getTypeScriptWorker(),e=await o(n.sys.model.uri,n.doc.model.uri,n.exp.model.uri),c=function(t,s){const n=document.createElement("div");return n.style="width: 100%; height: 100%; ",document.body.appendChild(n),t.editor.create(n,{model:t.editor.getModel(t.Uri.parse(s)),theme:"vs-dark",wordWrap:"on",minimap:{enabled:!1},contextmenu:!1,accessibilitySupport:"off",codeLens:!1,quickSuggestions:!1})}(t,n.cur.url),r=new i(t,n,e,c),u=window.parent;u["@baseflow/schema"]?.initTSServer(["cd","ce","ss","su","sv","st","sc","gc","iv","fm","ol"].reduce((t,s)=>(t[s]=r[s],t),{}))}});
