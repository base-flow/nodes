/*! version: 0.0.31 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Baseflow={},e.React)}(this,function(e,t){"use strict";const n={clear:"清空",delete:"删除",copy:"复制",cut:"剪切",paste:"粘贴",rename:"重命名",resetId:"更改ID",remark:"备注",refresh:"刷新",fold:"折叠",unfold:"展开",load:"加载",more:"更多",input:"输入",output:"输出",listen:"监听",mapping:"映射",run:"运行",testRun:"试运行",stop:"停止",retry:"重运行",export:"导出",publish:"发布",log:"日志",switchLogs:"切换日志",runLogs:"运行日志",currentNode:"当前节点",flowStatus:"流程状态",copyCommitId:"点击可复制文档当前的CommitID",commitIdPrompt:"导入的日志文件必须与当前CommitID匹配",executing:"正在执行",executionNodes:"运行节点",executionCompleted:"执行完成",executionTime:"耗时",totalTime:"总耗时",flowInput:"流程入参",noDataPrompt:"..No Data..",noLogsPrompt:"没有发现与当前 CommitID 匹配的任何运行日志，请点击 “试运行“ 或 “导入“ 相关日志文件。",noOutputs:"没有输出",allNodes:"所有节点",envMode:"环境模式",envModeTips:"可将系统环境变量_ENV_设置为相应值",variableNodes:"变量节点",outputsTab:"节点输出",contextTab:"迭代变量",utilsTab:"表达式函数",triggers:"触发器",triggersTips:"没有触发器的流程仅可以被其它流程内部调用",noErrors:"没有发现错误",deleteConfirm:"确定要删除此项目吗？",nodeIdFormat:"节点ID只允许包含[字母,数字,$,_]且以字母或$开头",cancel:"取消",submit:"提交",format:"格式化",insertNext:"插入后续",insertChild:"插入子级",mock:"模拟",disable:"禁用",enable:"启用",disableNode:"禁用节点",enableNode:"启用节点",version:"版本",currentNodeIsDisabled:"当前节点已禁用",currentNodeIsDisabledDesc:"禁用节点将不执行内部逻辑，但仍可以设置模拟输出...",mockOutput:"设置模拟输出",noLogsTips:"未加载任何日志文件...",help:"帮助",uploadConfig:"保存配置到云端",downloadConfig:"应用配置从云端",graphErrorsPrompt:"节点中存在错误！",flowRequiresParams:"流程需要入参...",clipboardIsEmpty:"剪贴板数据无效",idCannotBeModify:"开始/结束/节点的ID不允许修改",nodeCannotBeDisable:"开始/返回/节点不允许禁用",nodeHasExist:"(${node})已经存在...",nodeNotExist:"(${node})节点不存在...",notAllowedToSelectFlowNode:"流程节点只能单独选择",alreadyToClipboard:"已放入剪贴板",startOrEndCanOnlyBeReplace:"开始/结束节点只能被替换，无法添加或删除",notAllowedToAddBranch:"不能在(${node})中添加分支节点",notAllowedToAddBehind:"不能在(${node})后添加节点",notAllowedToAddChild:"不能为(${node})添加子节点",onlySameBranchCanBeAdd:"(${node})中只能添加同类型分支节点",notAllowedToDelete:"不能删除节点(${node})",notAllowedToDeleteDefaultBranch:"不能删除默认分支(${node})",notAllowedToMove:"不能移动节点(${node})",notAllowedToMoveThat:"不能移动到此(${node})",notAllowedToMoveDefaultBranch:"不能移动默认分支(${node})",keepAtLeast2Branches:"(${node})至少保留2个分支",inputSchemaChanged:"流程入参定义发生了变动，请确认各触发器节点映射数据！",returnSchemaChanged:"流程返回定义发生了变动，请确认各返回节点返回数据！"};function a(e,t={}){return e.replace(/\$\{([^}]*)\}/g,(e,n)=>t[n])}const o={inputSchemaChanged:"InputSchema has changed and needs to be confirmed",returnSchemaChanged:"ReturnSchema has changed and needs to be confirmed"},r="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9Ijg1Ljk1MiA3OC44NzIgMzQwLjk1NyAzNDAuOTU3IiB3aWR0aD0iMzQwLjk1N3B4IiBoZWlnaHQ9IjM0MC45NTdweCI+PGc+PHJlY3QgeD0iODUuOTUyIiB5PSI3OC44NzIiIHdpZHRoPSIzNDAuOTU3IiBoZWlnaHQ9IjM0MC45NTciIHN0eWxlPSJmaWxsOiMyYjdiZWE7IiAvPjxwYXRoIGQ9Ik0gMzI4LjAyNSAyOTUuOTYgQyAzMTkuMjg2IDI5NS45NiAzMTEuMjIxIDI5OS4wMjcgMzA0LjkwNSAzMDQuMTQ4IEwgMjQxLjM2NyAyNTguMTgzIEMgMjQyLjQzMiAyNTIuMzQgMjQyLjQzMiAyNDYuMzU1IDI0MS4zNjcgMjQwLjUyMSBMIDMwNC45MDUgMTk0LjU1NiBDIDMxMS4yMjEgMTk5LjY3NyAzMTkuMjg2IDIwMi43NDEgMzI4LjAyNSAyMDIuNzQxIEMgMzQ4LjMyNSAyMDIuNzQxIDM2NC44MjIgMTg2LjI0NiAzNjQuODIyIDE2NS45NDggQyAzNjQuODIyIDE0NS42NDIgMzQ4LjMyNSAxMjkuMTQ3IDMyOC4wMjUgMTI5LjE0NyBDIDMwNy43MjUgMTI5LjE0NyAyOTEuMjI4IDE0NS42NDIgMjkxLjIyOCAxNjUuOTQ4IEMgMjkxLjIyOCAxNjkuNTAyIDI5MS43MTkgMTcyLjkwNCAyOTIuNjY5IDE3Ni4xNTUgTCAyMzIuMzIyIDIxOS44NSBDIDIyMy4zNjcgMjA3Ljk4NiAyMDkuMTM5IDIwMC4yOTEgMTkzLjEwMiAyMDAuMjkxIEMgMTY1Ljk5NiAyMDAuMjkxIDE0NC4wNCAyMjIuMjQ2IDE0NC4wNCAyNDkuMzQ4IEMgMTQ0LjA0IDI3Ni40NTggMTY1Ljk5NiAyOTguNDEzIDE5My4xMDIgMjk4LjQxMyBDIDIwOS4xMzkgMjk4LjQxMyAyMjMuMzY3IDI5MC43MTcgMjMyLjMyMiAyNzguODQ5IEwgMjkyLjY2OSAzMjIuNTQ2IEMgMjkxLjcxOSAzMjUuNzk3IDI5MS4yMjggMzI5LjIzMSAyOTEuMjI4IDMzMi43NTcgQyAyOTEuMjI4IDM1My4wNTcgMzA3LjcyNSAzNjkuNTU1IDMyOC4wMjUgMzY5LjU1NSBDIDM0OC4zMjUgMzY5LjU1NSAzNjQuODIyIDM1My4wNTcgMzY0LjgyMiAzMzIuNzU3IEMgMzY0LjgyMiAzMTIuNDU3IDM0OC4zMjUgMjk1Ljk2IDMyOC4wMjUgMjk1Ljk2IFogTSAzMjguMDI1IDE0OS45OTcgQyAzMzYuODI2IDE0OS45OTcgMzQzLjk3MSAxNTcuMTQgMzQzLjk3MSAxNjUuOTQ4IEMgMzQzLjk3MSAxNzQuNzQ4IDMzNi44MjYgMTgxLjg5MSAzMjguMDI1IDE4MS44OTEgQyAzMTkuMjI0IDE4MS44OTEgMzEyLjA4IDE3NC43NDggMzEyLjA4IDE2NS45NDggQyAzMTIuMDggMTU3LjE0IDMxOS4yMjQgMTQ5Ljk5NyAzMjguMDI1IDE0OS45OTcgWiBNIDE5My4xMDIgMjc2LjMzNSBDIDE3OC4yMyAyNzYuMzM1IDE2Ni4xMTggMjY0LjIyMiAxNjYuMTE4IDI0OS4zNDggQyAxNjYuMTE4IDIzNC40NzQgMTc4LjIzIDIyMi4zNjEgMTkzLjEwMiAyMjIuMzYxIEMgMjA3Ljk3NSAyMjIuMzYxIDIyMC4wODYgMjM0LjQ3NCAyMjAuMDg2IDI0OS4zNDggQyAyMjAuMDg2IDI2NC4yMjIgMjA3Ljk3NSAyNzYuMzM1IDE5My4xMDIgMjc2LjMzNSBaIE0gMzI4LjAyNSAzNDguNzAzIEMgMzE5LjIyNCAzNDguNzAzIDMxMi4wOCAzNDEuNTU4IDMxMi4wOCAzMzIuNzU3IEMgMzEyLjA4IDMyMy45NTcgMzE5LjIyNCAzMTYuODEyIDMyOC4wMjUgMzE2LjgxMiBDIDMzNi44MjYgMzE2LjgxMiAzNDMuOTcxIDMyMy45NTcgMzQzLjk3MSAzMzIuNzU3IEMgMzQzLjk3MSAzNDEuNTU4IDMzNi44MjYgMzQ4LjcwMyAzMjguMDI1IDM0OC43MDMgWiIgc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIC8+PC9nPjwvc3ZnPg==",s={Flow:"Flow",Start:"Start",End:"End",Return:"Return",Task:"Task",Variable:"Variable",VariableUpdate:"VariableUpdate",Choice:"Choice",Branch:"Branch",Parallel:"Parallel",Thread:"Thread",Loop:"Loop",Break:"Break",Group:"Group",Trigger:"Trigger"},i={version:"1.0.0",icon:r,type:s.Task,desc:"UnkownNode",defaultData:()=>({meta:{name:"unkown",width:v.nodeDefaultSize.width,height:v.nodeDefaultSize.height},props:{}}),executor:{}},l={};function c(e){return l[e]||console.error(`node: ${e} not found!`),l[e]||i}function d(e,t){return l[e]||(t.icon||(t.icon=r),l[e]=t),l[e]}function u(e,t,n){e={...e};const a=Object.keys(e),o={};return a.forEach(n=>{let[a,r]=e[n].split("@").filter(Boolean);e[n].startsWith("@")&&(a=`@${a}`),r&&"*"!==r||(r=t[n]?t[n].split("@").filter(Boolean).pop():"latest",e[n]=`${a}@${r}`),t[n]&&t[n]!==e[n]&&(o[e[n]]=t[n],e[n]=t[n])}),Promise.all(a.map(t=>{const a=e[t],o=l[a];return o||n(a)})).then(t=>(t.forEach((t,n)=>{const o=a[n],r=e[o];l[r]||d(r,t)},{}),{sources:e,replaced:o}))}const h={[s.Flow]:!0,[s.Choice]:!0,[s.Branch]:!0,[s.Parallel]:!0,[s.Thread]:!0,[s.Loop]:!0,[s.Group]:!0},m={isFork:e=>e===s.Branch||e===s.Thread,isRoute:e=>e===s.Choice||e===s.Parallel,isContainer:e=>!!h[e],mockAble:e=>!(e===s.Start||e===s.End||e===s.Flow||e===s.Return),deleteAble:e=>!(e===s.Start||e===s.End),reidAble:e=>!(e===s.Start||e===s.End)},p=500,g=0,f=500,y=300,v={nodeDefaultSize:{width:260,height:68}};function b({lang:e,nodeDefaultSize:t}){e&&Object.assign(n,e),t&&(v.nodeDefaultSize=t)}function E(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var N,C={exports:{}};var w=(N||(N=1,function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,a(n)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var a="";for(var r in e)t.call(e,r)&&e[r]&&(a=o(a,r));return a}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(C)),C.exports),S=E(w);const x="@baseflow/schema",R={String:"ͼSTRINGͼ",Number:"ͼNUMBERͼ",Bool:"ͼBOOLͼ",Date:"ͼDATEͼ",Time:"ͼTIMEͼ",DateTime:"ͼDATETIMEͼ",Object:"ͼOBJECTͼ",Array:"ͼARRAYͼ",Map:"ͼMAPͼ",File:"ͼFILEͼ",Any:"ͼANYͼ"},M=Object.keys(R).reduce((e,t)=>(e[R[t]]=t,e),{}),_=Object.keys(R).map(e=>({value:R[e],label:e})),I={Variable:"ͼVARIABLEͼ",Template:"ͼTEMPLATEͼ",Expression:"ͼEXPRESSIONͼ"},k=Object.keys(I).reduce((e,t)=>(e[I[t]]=t,e),{}),L="*",T={"'":/\\'/g,'"':/\\"/g};function D(e,t,n){if(""===n){const e=t.slice(-1);t="!"===e||"?"===e?e+t.slice(0,-1):`!${t}`}else"!"!==n&&"?"!==n||(t=n+t);e.push(t)}const A={parse(e){if("string"!=typeof e)throw new TypeError("ObjectPath.parse must be passed a string");let t=0;const n=[];let a,o,r,s,i;for(;t<e.length;)if(a=e.indexOf(".",t),o=e.indexOf("[",t),-1===a&&-1===o)D(n,e.slice(t,e.length),""),t=e.length;else if(-1===o||-1!==a&&a<o)D(n,e.slice(t,a),""),t=a+1;else if(o>t&&(D(n,e.slice(t,o),""),t=o),r=e.slice(o+1,o+2),'"'!==r&&"'"!==r)s=e.indexOf("]",o),-1===s&&(s=e.length),i=e.charAt(s+1),D(n,e.slice(t+1,s),"?"===i||"!"===i?i:"!"),t="?"===i||"!"===i?s+3:"."===i?s+2:s+1;else{for(s=e.indexOf(`${r}]`,o),-1===s&&(s=e.length);"\\"===e.slice(s-1,s)&&-1!==s;)s=e.indexOf(`${r}]`,s+1);-1===s&&(s=e.length),i=e.charAt(s+2),D(n,e.slice(t+2,s).replace(T[r],r).replace(/\\+/g,e=>Array.from({length:Math.ceil(e.length/2)+1}).join("\\")),"?"===i||"!"===i?i:"!"),t="?"===i||"!"===i?s+4:"."===i?s+3:s+2}return n},stringify(e,t,n){Array.isArray(e)||(e=[e]),t='"'===t?'"':"'";const a=new RegExp(`(\\\\|${t})`,"g"),o=e.map(e=>{const o="?"===e.charAt(0)?"?":"";let r=e.substring(1);return!n&&/^[$A-Z_]\w*$/i.test(r)?r+o:n||/\D/.test(r)?(r=r.replace(a,"\\$1"),`[${t}${r}${t}]${o}`):`[${r}]${o}`});return o.slice(1).reduce((e,t)=>{const n=e.slice(-1);return"["===t.charAt(0)&&"?"!==n?e+t:`${e}.${t}`},o[0]).replace(/\?$/,"")},normalize:(e,t,n)=>A.stringify(Array.isArray(e)?e:A.parse(e),t,n)},$="⫻",O=`//${$}Expression${$}=`,P=`//${$}Node${$}=`,z="⫻";function V(e,t,n,a){let o,r;return a?(o=/\D/.test(e)?/^[\w$]+$/.test(e)?e:`["${e.replace(/"/g,'\\"')}"]`:`[${e}]`,r="["!==o.charAt(0)||n.endsWith("?")?".":"",t&&(o=`${o}?`)):(o=`${t?"?":"!"}${e}`,r=$),n?n+r+o:o}const B=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",j=new RegExp("^"+("["+B+"]["+(B+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*")+"$");function F(e,t){const n=[];let a=t.exec(e);for(;a;){const o=[];o.startIndex=t.lastIndex-a[0].length;const r=a.length;for(let e=0;e<r;e++)o.push(a[e]);n.push(o),a=t.exec(e)}return n}const H=function(e){const t=j.exec(e);return!(null==t)};const Z={allowBooleanAttributes:!1,unpairedTags:[]};function Y(e,t){t=Object.assign({},Z,t);const n=[];let a=!1,o=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let r=0;r<e.length;r++)if("<"===e[r]&&"?"===e[r+1]){if(r+=2,r=U(e,r),r.err)return r}else{if("<"!==e[r]){if(X(e[r]))continue;return te("InvalidChar","char '"+e[r]+"' is not expected.",oe(e,r))}{let s=r;if(r++,"!"===e[r]){r=G(e,r);continue}{let i=!1;"/"===e[r]&&(i=!0,r++);let l="";for(;r<e.length&&">"!==e[r]&&" "!==e[r]&&"\t"!==e[r]&&"\n"!==e[r]&&"\r"!==e[r];r++)l+=e[r];if(l=l.trim(),"/"===l[l.length-1]&&(l=l.substring(0,l.length-1),r--),!ae(l)){let t;return t=0===l.trim().length?"Invalid space after '<'.":"Tag '"+l+"' is an invalid name.",te("InvalidTag",t,oe(e,r))}const c=Q(e,r);if(!1===c)return te("InvalidAttr","Attributes for '"+l+"' have open quote.",oe(e,r));let d=c.value;if(r=c.index,"/"===d[d.length-1]){const n=r-d.length;d=d.substring(0,d.length-1);const o=J(d,t);if(!0!==o)return te(o.err.code,o.err.msg,oe(e,n+o.err.line));a=!0}else if(i){if(!c.tagClosed)return te("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",oe(e,r));if(d.trim().length>0)return te("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",oe(e,s));if(0===n.length)return te("InvalidTag","Closing tag '"+l+"' has not been opened.",oe(e,s));{const t=n.pop();if(l!==t.tagName){let n=oe(e,t.tagStartPos);return te("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+n.line+", col "+n.col+") instead of closing tag '"+l+"'.",oe(e,s))}0==n.length&&(o=!0)}}else{const i=J(d,t);if(!0!==i)return te(i.err.code,i.err.msg,oe(e,r-d.length+i.err.line));if(!0===o)return te("InvalidXml","Multiple possible root nodes found.",oe(e,r));-1!==t.unpairedTags.indexOf(l)||n.push({tagName:l,tagStartPos:s}),a=!0}for(r++;r<e.length;r++)if("<"===e[r]){if("!"===e[r+1]){r++,r=G(e,r);continue}if("?"!==e[r+1])break;if(r=U(e,++r),r.err)return r}else if("&"===e[r]){const t=ee(e,r);if(-1==t)return te("InvalidChar","char '&' is not expected.",oe(e,r));r=t}else if(!0===o&&!X(e[r]))return te("InvalidXml","Extra text at the end",oe(e,r));"<"===e[r]&&r--}}}return a?1==n.length?te("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",oe(e,n[0].tagStartPos)):!(n.length>0)||te("InvalidXml","Invalid '"+JSON.stringify(n.map(e=>e.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):te("InvalidXml","Start tag expected.",1)}function X(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function U(e,t){const n=t;for(;t<e.length;t++)if("?"==e[t]||" "==e[t]){const a=e.substr(n,t-n);if(t>5&&"xml"===a)return te("InvalidXml","XML declaration allowed only at the start of the document.",oe(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}continue}return t}function G(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let n=1;for(t+=8;t<e.length;t++)if("<"===e[t])n++;else if(">"===e[t]&&(n--,0===n))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}const q='"',K="'";function Q(e,t){let n="",a="",o=!1;for(;t<e.length;t++){if(e[t]===q||e[t]===K)""===a?a=e[t]:a!==e[t]||(a="");else if(">"===e[t]&&""===a){o=!0;break}n+=e[t]}return""===a&&{value:n,index:t,tagClosed:o}}const W=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function J(e,t){const n=F(e,W),a={};for(let e=0;e<n.length;e++){if(0===n[e][1].length)return te("InvalidAttr","Attribute '"+n[e][2]+"' has no space in starting.",re(n[e]));if(void 0!==n[e][3]&&void 0===n[e][4])return te("InvalidAttr","Attribute '"+n[e][2]+"' is without value.",re(n[e]));if(void 0===n[e][3]&&!t.allowBooleanAttributes)return te("InvalidAttr","boolean attribute '"+n[e][2]+"' is not allowed.",re(n[e]));const o=n[e][2];if(!ne(o))return te("InvalidAttr","Attribute '"+o+"' is an invalid name.",re(n[e]));if(a.hasOwnProperty(o))return te("InvalidAttr","Attribute '"+o+"' is repeated.",re(n[e]));a[o]=1}return!0}function ee(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let n=/\d/;for("x"===e[t]&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(n))break}return-1}(e,++t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(";"===e[t])break;return-1}return t}function te(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function ne(e){return H(e)}function ae(e){return H(e)}function oe(e,t){const n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function re(e){return e.startIndex+e[1].length}const se={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,n){return e},captureMetaData:!1};let ie;ie="function"!=typeof Symbol?"@@xmlMetadata":Symbol("XML Node Metadata");class le{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e,t){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),void 0!==t&&(this.child[this.child.length-1][ie]={startIndex:t})}static getMetaDataSymbol(){return ie}}class ce{constructor(e){this.suppressValidationErr=!e}readDocType(e,t){const n={};if("O"!==e[t+3]||"C"!==e[t+4]||"T"!==e[t+5]||"Y"!==e[t+6]||"P"!==e[t+7]||"E"!==e[t+8])throw new Error("Invalid Tag instead of DOCTYPE");{t+=9;let a=1,o=!1,r=!1,s="";for(;t<e.length;t++)if("<"!==e[t]||r)if(">"===e[t]){if(r?"-"===e[t-1]&&"-"===e[t-2]&&(r=!1,a--):a--,0===a)break}else"["===e[t]?o=!0:s+=e[t];else{if(o&&ue(e,"!ENTITY",t)){let a,o;t+=7,[a,o,t]=this.readEntityExp(e,t+1,this.suppressValidationErr),-1===o.indexOf("&")&&(n[a]={regx:RegExp(`&${a};`,"g"),val:o})}else if(o&&ue(e,"!ELEMENT",t)){t+=8;const{index:n}=this.readElementExp(e,t+1);t=n}else if(o&&ue(e,"!ATTLIST",t))t+=8;else if(o&&ue(e,"!NOTATION",t)){t+=9;const{index:n}=this.readNotationExp(e,t+1,this.suppressValidationErr);t=n}else{if(!ue(e,"!--",t))throw new Error("Invalid DOCTYPE");r=!0}a++,s=""}if(0!==a)throw new Error("Unclosed DOCTYPE")}return{entities:n,i:t}}readEntityExp(e,t){t=de(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t])&&'"'!==e[t]&&"'"!==e[t];)n+=e[t],t++;if(he(n),t=de(e,t),!this.suppressValidationErr){if("SYSTEM"===e.substring(t,t+6).toUpperCase())throw new Error("External entities are not supported");if("%"===e[t])throw new Error("Parameter entities are not supported")}let a="";return[t,a]=this.readIdentifierVal(e,t,"entity"),[n,a,--t]}readNotationExp(e,t){t=de(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;!this.suppressValidationErr&&he(n),t=de(e,t);const a=e.substring(t,t+6).toUpperCase();if(!this.suppressValidationErr&&"SYSTEM"!==a&&"PUBLIC"!==a)throw new Error(`Expected SYSTEM or PUBLIC, found "${a}"`);t+=a.length,t=de(e,t);let o=null,r=null;if("PUBLIC"===a)[t,o]=this.readIdentifierVal(e,t,"publicIdentifier"),'"'!==e[t=de(e,t)]&&"'"!==e[t]||([t,r]=this.readIdentifierVal(e,t,"systemIdentifier"));else if("SYSTEM"===a&&([t,r]=this.readIdentifierVal(e,t,"systemIdentifier"),!this.suppressValidationErr&&!r))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:n,publicIdentifier:o,systemIdentifier:r,index:--t}}readIdentifierVal(e,t,n){let a="";const o=e[t];if('"'!==o&&"'"!==o)throw new Error(`Expected quoted string, found "${o}"`);for(t++;t<e.length&&e[t]!==o;)a+=e[t],t++;if(e[t]!==o)throw new Error(`Unterminated ${n} value`);return[++t,a]}readElementExp(e,t){t=de(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;if(!this.suppressValidationErr&&!H(n))throw new Error(`Invalid element name: "${n}"`);let a="";if("E"===e[t=de(e,t)]&&ue(e,"MPTY",t))t+=4;else if("A"===e[t]&&ue(e,"NY",t))t+=2;else if("("===e[t]){for(t++;t<e.length&&")"!==e[t];)a+=e[t],t++;if(")"!==e[t])throw new Error("Unterminated content model")}else if(!this.suppressValidationErr)throw new Error(`Invalid Element Expression, found "${e[t]}"`);return{elementName:n,contentModel:a.trim(),index:t}}readAttlistExp(e,t){t=de(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;he(n),t=de(e,t);let a="";for(;t<e.length&&!/\s/.test(e[t]);)a+=e[t],t++;if(!he(a))throw new Error(`Invalid attribute name: "${a}"`);t=de(e,t);let o="";if("NOTATION"===e.substring(t,t+8).toUpperCase()){if(o="NOTATION","("!==e[t=de(e,t+=8)])throw new Error(`Expected '(', found "${e[t]}"`);t++;let n=[];for(;t<e.length&&")"!==e[t];){let a="";for(;t<e.length&&"|"!==e[t]&&")"!==e[t];)a+=e[t],t++;if(a=a.trim(),!he(a))throw new Error(`Invalid notation name: "${a}"`);n.push(a),"|"===e[t]&&(t++,t=de(e,t))}if(")"!==e[t])throw new Error("Unterminated list of notations");t++,o+=" ("+n.join("|")+")"}else{for(;t<e.length&&!/\s/.test(e[t]);)o+=e[t],t++;const n=["CDATA","ID","IDREF","IDREFS","ENTITY","ENTITIES","NMTOKEN","NMTOKENS"];if(!this.suppressValidationErr&&!n.includes(o.toUpperCase()))throw new Error(`Invalid attribute type: "${o}"`)}t=de(e,t);let r="";return"#REQUIRED"===e.substring(t,t+8).toUpperCase()?(r="#REQUIRED",t+=8):"#IMPLIED"===e.substring(t,t+7).toUpperCase()?(r="#IMPLIED",t+=7):[t,r]=this.readIdentifierVal(e,t,"ATTLIST"),{elementName:n,attributeName:a,attributeType:o,defaultValue:r,index:t}}}const de=(e,t)=>{for(;t<e.length&&/\s/.test(e[t]);)t++;return t};function ue(e,t,n){for(let a=0;a<t.length;a++)if(t[a]!==e[n+a+1])return!1;return!0}function he(e){if(H(e))return e;throw new Error(`Invalid entity name ${e}`)}const me=/^[-+]?0x[a-fA-F0-9]+$/,pe=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,ge={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function fe(e,t={}){if(t=Object.assign({},ge,t),!e||"string"!=typeof e)return e;let n=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(n))return e;if("0"===e)return 0;if(t.hex&&me.test(n))return function(e,t){if(parseInt)return parseInt(e,t);if(Number.parseInt)return Number.parseInt(e,t);if(window&&window.parseInt)return window.parseInt(e,t);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}(n,16);if(n.includes("e")||n.includes("E"))return function(e,t,n){if(!n.eNotation)return e;const a=t.match(ye);if(a){let o=a[1]||"";const r=-1===a[3].indexOf("e")?"E":"e",s=a[2],i=o?e[s.length+1]===r:e[s.length]===r;return s.length>1&&i?e:1!==s.length||!a[3].startsWith(`.${r}`)&&a[3][0]!==r?n.leadingZeros&&!i?(t=(a[1]||"")+a[3],Number(t)):e:Number(t)}return e}(e,n,t);{const a=pe.exec(n);if(a){const o=a[1]||"",r=a[2];let s=function(e){if(e&&-1!==e.indexOf("."))return"."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substring(0,e.length-1)),e;return e}(a[3]);const i=o?"."===e[r.length+1]:"."===e[r.length];if(!t.leadingZeros&&(r.length>1||1===r.length&&!i))return e;{const a=Number(n),i=String(a);if(0===a)return a;if(-1!==i.search(/[eE]/))return t.eNotation?a:e;if(-1!==n.indexOf("."))return"0"===i||i===s||i===`${o}${s}`?a:e;let l=r?s:n;return r?l===i||o+l===i?a:e:l===i||l===o+i?a:e}}return e}}const ye=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function ve(e){return"function"==typeof e?e:Array.isArray(e)?t=>{for(const n of e){if("string"==typeof n&&t===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}}:()=>!1}class be{constructor(e){if(this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,16))}},this.addExternalEntities=Ee,this.parseXml=xe,this.parseTextData=Ne,this.resolveNameSpace=Ce,this.buildAttributesMap=Se,this.isItStopNode=Ie,this.replaceEntitiesValue=Me,this.readStopNodeData=Te,this.saveTextToParentTag=_e,this.addChild=Re,this.ignoreAttributesFn=ve(this.options.ignoreAttributes),this.options.stopNodes&&this.options.stopNodes.length>0){this.stopNodesExact=new Set,this.stopNodesWildcard=new Set;for(let e=0;e<this.options.stopNodes.length;e++){const t=this.options.stopNodes[e];"string"==typeof t&&(t.startsWith("*.")?this.stopNodesWildcard.add(t.substring(2)):this.stopNodesExact.add(t))}}}}function Ee(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const a=t[n];this.lastEntities[a]={regex:new RegExp("&"+a+";","g"),val:e[a]}}}function Ne(e,t,n,a,o,r,s){if(void 0!==e&&(this.options.trimValues&&!a&&(e=e.trim()),e.length>0)){s||(e=this.replaceEntitiesValue(e));const a=this.options.tagValueProcessor(t,e,n,o,r);if(null==a)return e;if(typeof a!=typeof e||a!==e)return a;if(this.options.trimValues)return De(e,this.options.parseTagValue,this.options.numberParseOptions);return e.trim()===e?De(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function Ce(e){if(this.options.removeNSPrefix){const t=e.split(":"),n="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=n+t[1])}return e}const we=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function Se(e,t){if(!0!==this.options.ignoreAttributes&&"string"==typeof e){const n=F(e,we),a=n.length,o={};for(let e=0;e<a;e++){const a=this.resolveNameSpace(n[e][1]);if(this.ignoreAttributesFn(a,t))continue;let r=n[e][4],s=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(s=this.options.transformAttributeName(s)),"__proto__"===s&&(s="#__proto__"),void 0!==r){this.options.trimValues&&(r=r.trim()),r=this.replaceEntitiesValue(r);const e=this.options.attributeValueProcessor(a,r,t);o[s]=null==e?r:typeof e!=typeof r||e!==r?e:De(r,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[s]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=o,e}return o}}const xe=function(e){e=e.replace(/\r\n?/g,"\n");const t=new le("!xml");let n=t,a="",o="";const r=new ce(this.options.processEntities);for(let s=0;s<e.length;s++){if("<"===e[s])if("/"===e[s+1]){const t=ke(e,">",s,"Closing Tag is not closed.");let r=e.substring(s+2,t).trim();if(this.options.removeNSPrefix){const e=r.indexOf(":");-1!==e&&(r=r.substr(e+1))}this.options.transformTagName&&(r=this.options.transformTagName(r)),n&&(a=this.saveTextToParentTag(a,n,o));const i=o.substring(o.lastIndexOf(".")+1);if(r&&-1!==this.options.unpairedTags.indexOf(r))throw new Error(`Unpaired tag can not be used as closing tag: </${r}>`);let l=0;i&&-1!==this.options.unpairedTags.indexOf(i)?(l=o.lastIndexOf(".",o.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=o.lastIndexOf("."),o=o.substring(0,l),n=this.tagsNodeStack.pop(),a="",s=t}else if("?"===e[s+1]){let t=Le(e,s,!1,"?>");if(!t)throw new Error("Pi Tag is not closed.");if(a=this.saveTextToParentTag(a,n,o),this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags);else{const e=new le(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,o)),this.addChild(n,e,o,s)}s=t.closeIndex+1}else if("!--"===e.substr(s+1,3)){const t=ke(e,"--\x3e",s+4,"Comment is not closed.");if(this.options.commentPropName){const r=e.substring(s+4,t-2);a=this.saveTextToParentTag(a,n,o),n.add(this.options.commentPropName,[{[this.options.textNodeName]:r}])}s=t}else if("!D"===e.substr(s+1,2)){const t=r.readDocType(e,s);this.docTypeEntities=t.entities,s=t.i}else if("!["===e.substr(s+1,2)){const t=ke(e,"]]>",s,"CDATA is not closed.")-2,r=e.substring(s+9,t);a=this.saveTextToParentTag(a,n,o);let i=this.parseTextData(r,n.tagname,o,!0,!1,!0,!0);null==i&&(i=""),this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:r}]):n.add(this.options.textNodeName,i),s=t+2}else{let r=Le(e,s,this.options.removeNSPrefix),i=r.tagName;const l=r.rawTagName;let c=r.tagExp,d=r.attrExpPresent,u=r.closeIndex;if(this.options.transformTagName){const e=this.options.transformTagName(i);c===i&&(c=e),i=e}n&&a&&"!xml"!==n.tagname&&(a=this.saveTextToParentTag(a,n,o,!1));const h=n;h&&-1!==this.options.unpairedTags.indexOf(h.tagname)&&(n=this.tagsNodeStack.pop(),o=o.substring(0,o.lastIndexOf("."))),i!==t.tagname&&(o+=o?"."+i:i);const m=s;if(this.isItStopNode(this.stopNodesExact,this.stopNodesWildcard,o,i)){let t="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)"/"===i[i.length-1]?(i=i.substr(0,i.length-1),o=o.substr(0,o.length-1),c=i):c=c.substr(0,c.length-1),s=r.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(i))s=r.closeIndex;else{const n=this.readStopNodeData(e,l,u+1);if(!n)throw new Error(`Unexpected end of ${l}`);s=n.i,t=n.tagContent}const a=new le(i);i!==c&&d&&(a[":@"]=this.buildAttributesMap(c,o)),t&&(t=this.parseTextData(t,i,o,!0,d,!0,!0)),o=o.substr(0,o.lastIndexOf(".")),a.add(this.options.textNodeName,t),this.addChild(n,a,o,m)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){if("/"===i[i.length-1]?(i=i.substr(0,i.length-1),o=o.substr(0,o.length-1),c=i):c=c.substr(0,c.length-1),this.options.transformTagName){const e=this.options.transformTagName(i);c===i&&(c=e),i=e}const e=new le(i);i!==c&&d&&(e[":@"]=this.buildAttributesMap(c,o)),this.addChild(n,e,o,m),o=o.substr(0,o.lastIndexOf("."))}else{const e=new le(i);this.tagsNodeStack.push(n),i!==c&&d&&(e[":@"]=this.buildAttributesMap(c,o)),this.addChild(n,e,o,m),n=e}a="",s=u}}else a+=e[s]}return t.child};function Re(e,t,n,a){this.options.captureMetaData||(a=void 0);const o=this.options.updateTag(t.tagname,n,t[":@"]);!1===o||("string"==typeof o?(t.tagname=o,e.addChild(t,a)):e.addChild(t,a))}const Me=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const n=this.docTypeEntities[t];e=e.replace(n.regx,n.val)}for(let t in this.lastEntities){const n=this.lastEntities[t];e=e.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const n=this.htmlEntities[t];e=e.replace(n.regex,n.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function _e(e,t,n,a){return e&&(void 0===a&&(a=0===t.child.length),void 0!==(e=this.parseTextData(e,t.tagname,n,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,a))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function Ie(e,t,n,a){return!(!t||!t.has(a))||!(!e||!e.has(n))}function ke(e,t,n,a){const o=e.indexOf(t,n);if(-1===o)throw new Error(a);return o+t.length-1}function Le(e,t,n,a=">"){const o=function(e,t,n=">"){let a,o="";for(let r=t;r<e.length;r++){let t=e[r];if(a)t===a&&(a="");else if('"'===t||"'"===t)a=t;else if(t===n[0]){if(!n[1])return{data:o,index:r};if(e[r+1]===n[1])return{data:o,index:r}}else"\t"===t&&(t=" ");o+=t}}(e,t+1,a);if(!o)return;let r=o.data;const s=o.index,i=r.search(/\s/);let l=r,c=!0;-1!==i&&(l=r.substring(0,i),r=r.substring(i+1).trimStart());const d=l;if(n){const e=l.indexOf(":");-1!==e&&(l=l.substr(e+1),c=l!==o.data.substr(e+1))}return{tagName:l,tagExp:r,closeIndex:s,attrExpPresent:c,rawTagName:d}}function Te(e,t,n){const a=n;let o=1;for(;n<e.length;n++)if("<"===e[n])if("/"===e[n+1]){const r=ke(e,">",n,`${t} is not closed`);if(e.substring(n+2,r).trim()===t&&(o--,0===o))return{tagContent:e.substring(a,n),i:r};n=r}else if("?"===e[n+1]){n=ke(e,"?>",n+1,"StopNode is not closed.")}else if("!--"===e.substr(n+1,3)){n=ke(e,"--\x3e",n+3,"StopNode is not closed.")}else if("!["===e.substr(n+1,2)){n=ke(e,"]]>",n,"StopNode is not closed.")-2}else{const a=Le(e,n,">");if(a){(a&&a.tagName)===t&&"/"!==a.tagExp[a.tagExp.length-1]&&o++,n=a.closeIndex}}}function De(e,t,n){if(t&&"string"==typeof e){const t=e.trim();return"true"===t||"false"!==t&&fe(e,n)}return void 0!==e?e:""}const Ae=le.getMetaDataSymbol();function $e(e,t){return Oe(e,t)}function Oe(e,t,n){let a;const o={};for(let r=0;r<e.length;r++){const s=e[r],i=Pe(s);let l="";if(l=void 0===n?i:n+"."+i,i===t.textNodeName)void 0===a?a=s[i]:a+=""+s[i];else{if(void 0===i)continue;if(s[i]){let e=Oe(s[i],t,l);const n=Ve(e,t);void 0!==s[Ae]&&(e[Ae]=s[Ae]),s[":@"]?ze(e,s[":@"],l,t):1!==Object.keys(e).length||void 0===e[t.textNodeName]||t.alwaysCreateTextNode?0===Object.keys(e).length&&(t.alwaysCreateTextNode?e[t.textNodeName]="":e=""):e=e[t.textNodeName],void 0!==o[i]&&o.hasOwnProperty(i)?(Array.isArray(o[i])||(o[i]=[o[i]]),o[i].push(e)):t.isArray(i,l,n)?o[i]=[e]:o[i]=e}}}return"string"==typeof a?a.length>0&&(o[t.textNodeName]=a):void 0!==a&&(o[t.textNodeName]=a),o}function Pe(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const n=t[e];if(":@"!==n)return n}}function ze(e,t,n,a){if(t){const o=Object.keys(t),r=o.length;for(let s=0;s<r;s++){const r=o[s];a.isArray(r,n+"."+r,!0,!0)?e[r]=[t[r]]:e[r]=t[r]}}}function Ve(e,t){const{textNodeName:n}=t,a=Object.keys(e).length;return 0===a||!(1!==a||!e[n]&&"boolean"!=typeof e[n]&&0!==e[n])}class Be{constructor(e){this.externalEntities={},this.options=function(e){return Object.assign({},se,e)}(e)}parse(e,t){if("string"!=typeof e&&e.toString)e=e.toString();else if("string"!=typeof e)throw new Error("XML data is accepted in String or Bytes[] form.");if(t){!0===t&&(t={});const n=Y(e,t);if(!0!==n)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}const n=new be(this.options);n.addExternalEntities(this.externalEntities);const a=n.parseXml(e);return this.options.preserveOrder||void 0===a?a:$e(a,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}static getMetaDataSymbol(){return le.getMetaDataSymbol()}}function je(e,t){let n="";return t.format&&t.indentBy.length>0&&(n="\n"),Fe(e,t,"",n)}function Fe(e,t,n,a){let o="",r=!1;for(let s=0;s<e.length;s++){const i=e[s],l=He(i);if(void 0===l)continue;let c="";if(c=0===n.length?l:`${n}.${l}`,l===t.textNodeName){let e=i[l];Ye(c,t)||(e=t.tagValueProcessor(l,e),e=Xe(e,t)),r&&(o+=a),o+=e,r=!1;continue}if(l===t.cdataPropName){r&&(o+=a),o+=`<![CDATA[${i[l][0][t.textNodeName]}]]>`,r=!1;continue}if(l===t.commentPropName){o+=a+`\x3c!--${i[l][0][t.textNodeName]}--\x3e`,r=!0;continue}if("?"===l[0]){const e=Ze(i[":@"],t),n="?xml"===l?"":a;let s=i[l][0][t.textNodeName];s=0!==s.length?" "+s:"",o+=n+`<${l}${s}${e}?>`,r=!0;continue}let d=a;""!==d&&(d+=t.indentBy);const u=a+`<${l}${Ze(i[":@"],t)}`,h=Fe(i[l],t,c,d);-1!==t.unpairedTags.indexOf(l)?t.suppressUnpairedNode?o+=u+">":o+=u+"/>":h&&0!==h.length||!t.suppressEmptyNode?h&&h.endsWith(">")?o+=u+`>${h}${a}</${l}>`:(o+=u+">",h&&""!==a&&(h.includes("/>")||h.includes("</"))?o+=a+t.indentBy+h+a:o+=h,o+=`</${l}>`):o+=u+"/>",r=!0}return o}function He(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const a=t[n];if(e.hasOwnProperty(a)&&":@"!==a)return a}}function Ze(e,t){let n="";if(e&&!t.ignoreAttributes)for(let a in e){if(!e.hasOwnProperty(a))continue;let o=t.attributeValueProcessor(a,e[a]);o=Xe(o,t),!0===o&&t.suppressBooleanAttributes?n+=` ${a.substr(t.attributeNamePrefix.length)}`:n+=` ${a.substr(t.attributeNamePrefix.length)}="${o}"`}return n}function Ye(e,t){let n=(e=e.substr(0,e.length-t.textNodeName.length-1)).substr(e.lastIndexOf(".")+1);for(let a in t.stopNodes)if(t.stopNodes[a]===e||t.stopNodes[a]==="*."+n)return!0;return!1}function Xe(e,t){if(e&&e.length>0&&t.processEntities)for(let n=0;n<t.entities.length;n++){const a=t.entities[n];e=e.replace(a.regex,a.val)}return e}const Ue={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Ge(e){this.options=Object.assign({},Ue,e),!0===this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=ve(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=Qe),this.processTextOrObjNode=qe,this.options.format?(this.indentate=Ke,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function qe(e,t,n,a){const o=this.j2x(e,n+1,a.concat(t));return void 0!==e[this.options.textNodeName]&&1===Object.keys(e).length?this.buildTextValNode(e[this.options.textNodeName],t,o.attrStr,n):this.buildObjectNode(o.val,t,o.attrStr,n)}function Ke(e){return this.options.indentBy.repeat(e)}function Qe(e){return!(!e.startsWith(this.options.attributeNamePrefix)||e===this.options.textNodeName)&&e.substr(this.attrPrefixLen)}Ge.prototype.build=function(e){return this.options.preserveOrder?je(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0,[]).val)},Ge.prototype.j2x=function(e,t,n){let a="",o="";const r=n.join(".");for(let s in e)if(Object.prototype.hasOwnProperty.call(e,s))if(void 0===e[s])this.isAttribute(s)&&(o+="");else if(null===e[s])this.isAttribute(s)||s===this.options.cdataPropName?o+="":"?"===s[0]?o+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if(e[s]instanceof Date)o+=this.buildTextValNode(e[s],s,"",t);else if("object"!=typeof e[s]){const n=this.isAttribute(s);if(n&&!this.ignoreAttributesFn(n,r))a+=this.buildAttrPairStr(n,""+e[s]);else if(!n)if(s===this.options.textNodeName){let t=this.options.tagValueProcessor(s,""+e[s]);o+=this.replaceEntitiesValue(t)}else o+=this.buildTextValNode(e[s],s,"",t)}else if(Array.isArray(e[s])){const a=e[s].length;let r="",i="";for(let l=0;l<a;l++){const a=e[s][l];if(void 0===a);else if(null===a)"?"===s[0]?o+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:o+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if("object"==typeof a)if(this.options.oneListGroup){const e=this.j2x(a,t+1,n.concat(s));r+=e.val,this.options.attributesGroupName&&a.hasOwnProperty(this.options.attributesGroupName)&&(i+=e.attrStr)}else r+=this.processTextOrObjNode(a,s,t,n);else if(this.options.oneListGroup){let e=this.options.tagValueProcessor(s,a);e=this.replaceEntitiesValue(e),r+=e}else r+=this.buildTextValNode(a,s,"",t)}this.options.oneListGroup&&(r=this.buildObjectNode(r,s,i,t)),o+=r}else if(this.options.attributesGroupName&&s===this.options.attributesGroupName){const t=Object.keys(e[s]),n=t.length;for(let o=0;o<n;o++)a+=this.buildAttrPairStr(t[o],""+e[s][t[o]])}else o+=this.processTextOrObjNode(e[s],s,t,n);return{attrStr:a,val:o}},Ge.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&"true"===t?" "+e:" "+e+'="'+t+'"'},Ge.prototype.buildObjectNode=function(e,t,n,a){if(""===e)return"?"===t[0]?this.indentate(a)+"<"+t+n+"?"+this.tagEndChar:this.indentate(a)+"<"+t+n+this.closeTag(t)+this.tagEndChar;{let o="</"+t+this.tagEndChar,r="";return"?"===t[0]&&(r="?",o=""),!n&&""!==n||-1!==e.indexOf("<")?!1!==this.options.commentPropName&&t===this.options.commentPropName&&0===r.length?this.indentate(a)+`\x3c!--${e}--\x3e`+this.newLine:this.indentate(a)+"<"+t+n+r+this.tagEndChar+e+this.indentate(a)+o:this.indentate(a)+"<"+t+n+r+">"+e+o}},Ge.prototype.closeTag=function(e){let t="";return-1!==this.options.unpairedTags.indexOf(e)?this.options.suppressUnpairedNode||(t="/"):t=this.options.suppressEmptyNode?"/":`></${e}`,t},Ge.prototype.buildTextValNode=function(e,t,n,a){if(!1!==this.options.cdataPropName&&t===this.options.cdataPropName)return this.indentate(a)+`<![CDATA[${e}]]>`+this.newLine;if(!1!==this.options.commentPropName&&t===this.options.commentPropName)return this.indentate(a)+`\x3c!--${e}--\x3e`+this.newLine;if("?"===t[0])return this.indentate(a)+"<"+t+n+"?"+this.tagEndChar;{let o=this.options.tagValueProcessor(t,e);return o=this.replaceEntitiesValue(o),""===o?this.indentate(a)+"<"+t+n+this.closeTag(t)+this.tagEndChar:this.indentate(a)+"<"+t+n+">"+o+"</"+t+this.tagEndChar}},Ge.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const n=this.options.entities[t];e=e.replace(n.regex,n.val)}return e};const We={validate:Y},Je="remove",et="replace",tt="add",nt=Symbol.for("__MUTATIVE_PROXY_DRAFT__"),at=Symbol("__MUTATIVE_RAW_RETURN_SYMBOL__"),ot=Symbol.iterator,rt={mutable:"mutable",immutable:"immutable"},st={};function it(e,t){return e instanceof Map?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function lt(e,t){if(t in e){let n=Reflect.getPrototypeOf(e);for(;n;){const e=Reflect.getOwnPropertyDescriptor(n,t);if(e)return e;n=Reflect.getPrototypeOf(n)}}}function ct(e){return Object.getPrototypeOf(e)===Set.prototype}function dt(e){return Object.getPrototypeOf(e)===Map.prototype}function ut(e){var t;return null!==(t=e.copy)&&void 0!==t?t:e.original}function ht(e){return!!mt(e)}function mt(e){return"object"!=typeof e?null:null==e?void 0:e[nt]}function pt(e){var t;const n=mt(e);return n?null!==(t=n.copy)&&void 0!==t?t:n.original:e}function gt(e,t){if(!e||"object"!=typeof e)return!1;let n;return Object.getPrototypeOf(e)===Object.prototype||Array.isArray(e)||e instanceof Map||e instanceof Set||!!(null==t?void 0:t.mark)&&((n=t.mark(e,rt))===rt.immutable||"function"==typeof n)}function ft(e,t=[]){if(Object.hasOwnProperty.call(e,"key")){const n=e.parent.copy,a=mt(vt(n,e.key));if(null!==a&&(null==a?void 0:a.original)!==e.original)return null;const o=3===e.parent.type,r=o?Array.from(e.parent.setMap.keys()).indexOf(e.key):e.key;if(!(o&&n.size>r||it(n,r)))return null;t.push(r)}if(e.parent)return ft(e.parent,t);t.reverse();try{!function(e,t){for(let n=0;n<t.length-1;n+=1){const a=t[n];if("object"!=typeof(e=vt(3===yt(e)?Array.from(e):e,a)))throw new Error(`Cannot resolve patch at '${t.join("/")}'.`)}}(e.copy,t)}catch(e){return null}return t}function yt(e){return Array.isArray(e)?1:e instanceof Map?2:e instanceof Set?3:0}function vt(e,t){return 2===yt(e)?e.get(t):e[t]}function bt(e,t,n){2===yt(e)?e.set(t,n):e[t]=n}function Et(e,t){const n=mt(e);return(n?ut(n):e)[t]}function Nt(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Ct(e){if(e)for(;e.finalities.revoke.length>0;){e.finalities.revoke.pop()()}}function wt(e,t){return t?e:[""].concat(e).map(e=>{const t=`${e}`;return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}).join("/")}const St=Object.prototype.propertyIsEnumerable;function xt(e,t){let n;if(Array.isArray(e))return Array.prototype.concat.call(e);if(e instanceof Set){if(!ct(e)){return new(0,Object.getPrototypeOf(e).constructor)(e.values())}return Set.prototype.difference?Set.prototype.difference.call(e,new Set):new Set(e.values())}if(e instanceof Map){if(!dt(e)){return new(0,Object.getPrototypeOf(e).constructor)(e)}return new Map(e)}if((null==t?void 0:t.mark)&&(n=t.mark(e,rt),void 0!==n)&&n!==rt.mutable){if(n===rt.immutable)return function(e){const t=Object.create(Object.getPrototypeOf(e));return Reflect.ownKeys(e).forEach(n=>{let a=Reflect.getOwnPropertyDescriptor(e,n);a.enumerable&&a.configurable&&a.writable?t[n]=e[n]:(a.writable||(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(a={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[n]}),Reflect.defineProperty(t,n,a))}),t}(e);if("function"==typeof n){if(t.enablePatches||t.enableAutoFreeze)throw new Error("You can't use mark and patches or auto freeze together.");return n()}throw new Error(`Unsupported mark result: ${n}`)}if("object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype){const t={};return Object.keys(e).forEach(n=>{t[n]=e[n]}),Object.getOwnPropertySymbols(e).forEach(n=>{St.call(e,n)&&(t[n]=e[n])}),t}throw new Error("Please check mark() to ensure that it is a stable marker draftable function.")}function Rt(e){e.copy||(e.copy=xt(e.original,e.options))}function Mt(e){if(!gt(e))return pt(e);if(Array.isArray(e))return e.map(Mt);if(e instanceof Map){const t=Array.from(e.entries()).map(([e,t])=>[e,Mt(t)]);if(!dt(e)){return new(0,Object.getPrototypeOf(e).constructor)(t)}return new Map(t)}if(e instanceof Set){const t=Array.from(e).map(Mt);if(!ct(e)){return new(0,Object.getPrototypeOf(e).constructor)(t)}return new Set(t)}const t=Object.create(Object.getPrototypeOf(e));for(const n in e)t[n]=Mt(e[n]);return t}function _t(e){return ht(e)?Mt(e):e}function It(e){var t;e.assignedMap=null!==(t=e.assignedMap)&&void 0!==t?t:new Map,e.operated||(e.operated=!0,e.parent&&It(e.parent))}function kt(){throw new Error("Cannot modify frozen object")}function Lt(e,t,n,a,o){{n=null!=n?n:new WeakMap,a=null!=a?a:[],o=null!=o?o:[];const r=n.has(e)?n.get(e):e;if(a.length>0){const e=a.indexOf(r);if(r&&"object"==typeof r&&-1!==e){if(a[0]===r)throw new Error("Forbids circular reference");throw new Error(`Forbids circular reference: ~/${o.slice(0,e).map((e,t)=>{if("symbol"==typeof e)return`[${e.toString()}]`;const n=a[t];return"object"==typeof e&&(n instanceof Map||n instanceof Set)?Array.from(n.keys()).indexOf(e):e}).join("/")}`)}a.push(r),o.push(t)}else a.push(r)}if(Object.isFrozen(e)||ht(e))return a.pop(),void o.pop();switch(yt(e)){case 2:for(const[t,r]of e)Lt(t,t,n,a,o),Lt(r,t,n,a,o);e.set=e.clear=e.delete=kt;break;case 3:for(const t of e)Lt(t,t,n,a,o);e.add=e.clear=e.delete=kt;break;case 1:Object.freeze(e);let t=0;for(const r of e)Lt(r,t,n,a,o),t+=1;break;default:Object.freeze(e),Object.keys(e).forEach(t=>{Lt(e[t],t,n,a,o)})}a.pop(),o.pop()}function Tt(e,t){const n=yt(e);if(0===n)Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)});else if(1===n){let n=0;for(const a of e)t(n,a,e),n+=1}else e.forEach((n,a)=>t(a,n,e))}function Dt(e,t,n){if(ht(e)||!gt(e,n)||t.has(e)||Object.isFrozen(e))return;const a=e instanceof Set,o=a?new Map:void 0;if(t.add(e),Tt(e,(r,s)=>{var i;if(ht(s)){const t=mt(s);Rt(t);const n=(null===(i=t.assignedMap)||void 0===i?void 0:i.size)||t.operated?t.copy:t.original;bt(a?o:e,r,n)}else Dt(s,t,n)}),o){const t=e,n=Array.from(t);t.clear(),n.forEach(e=>{t.add(o.has(e)?o.get(e):e)})}}function At(e,t){const n=3===e.type?e.setMap:e.copy;e.finalities.revoke.length>1&&e.assignedMap.get(t)&&n&&Dt(vt(n,t),e.finalities.handledSet,e.options)}function $t(e){3===e.type&&e.copy&&(e.copy.clear(),e.setMap.forEach(t=>{e.copy.add(pt(t))}))}function Ot(e,t,n,a){if(e.operated&&e.assignedMap&&e.assignedMap.size>0&&!e.finalized){if(n&&a){const o=ft(e);o&&t(e,o,n,a)}e.finalized=!0}}function Pt(e,t,n,a){const o=mt(n);o&&(o.callbacks||(o.callbacks=[]),o.callbacks.push((r,s)=>{var i;const l=3===e.type?e.setMap:e.copy;if(Nt(vt(l,t),n)){let n=o.original;o.copy&&(n=o.copy),$t(e),Ot(e,a,r,s),e.options.enableAutoFreeze&&(e.options.updatedValues=null!==(i=e.options.updatedValues)&&void 0!==i?i:new WeakMap,e.options.updatedValues.set(n,o.original)),bt(l,t,n)}}),e.options.enableAutoFreeze&&o.finalities!==e.finalities&&(e.options.enableAutoFreeze=!1)),gt(n,e.options)&&e.finalities.draft.push(()=>{Nt(vt(3===e.type?e.setMap:e.copy,t),n)&&At(e,t)})}function zt(e,t,n,a){const{pathAsArray:o=!0}=e.options.enablePatches;switch(e.type){case 0:case 2:return function({original:e,copy:t,assignedMap:n},a,o,r,s){n.forEach((n,i)=>{const l=vt(e,i),c=_t(vt(t,i)),d=n?it(e,i)?et:tt:Je;if(Nt(l,c)&&d===et)return;const u=wt(a.concat(i),s);o.push(d===Je?{op:d,path:u}:{op:d,path:u,value:c}),r.push(d===tt?{op:Je,path:u}:d===Je?{op:tt,path:u,value:l}:{op:et,path:u,value:l})})}(e,t,n,a,o);case 1:return function(e,t,n,a,o){let{original:r,assignedMap:s,options:i}=e,l=e.copy;l.length<r.length&&([r,l]=[l,r],[n,a]=[a,n]);for(let e=0;e<r.length;e+=1)if(s.get(e.toString())&&l[e]!==r[e]){const s=wt(t.concat([e]),o);n.push({op:et,path:s,value:_t(l[e])}),a.push({op:et,path:s,value:_t(r[e])})}for(let e=r.length;e<l.length;e+=1){const a=wt(t.concat([e]),o);n.push({op:tt,path:a,value:_t(l[e])})}if(r.length<l.length){const{arrayLengthAssignment:e=!0}=i.enablePatches;if(e){const e=wt(t.concat(["length"]),o);a.push({op:et,path:e,value:r.length})}else for(let e=l.length;r.length<e;e-=1){const n=wt(t.concat([e-1]),o);a.push({op:Je,path:n})}}}(e,t,n,a,o);case 3:return function({original:e,copy:t},n,a,o,r){let s=0;e.forEach(e=>{if(!t.has(e)){const t=wt(n.concat([s]),r);a.push({op:Je,path:t,value:e}),o.unshift({op:tt,path:t,value:e})}s+=1}),s=0,t.forEach(t=>{if(!e.has(t)){const e=wt(n.concat([s]),r);a.push({op:tt,path:e,value:t}),o.unshift({op:Je,path:e,value:t})}s+=1})}(e,t,n,a,o)}}const Vt=(e,t,n=!1)=>{if("object"==typeof e&&null!==e&&(!gt(e,t)||n))throw new Error("Strict mode: Mutable data cannot be accessed directly, please use 'unsafe(callback)' wrap.")},Bt={get size(){return ut(mt(this)).size},has(e){return ut(mt(this)).has(e)},set(e,t){const n=mt(this),a=ut(n);return a.has(e)&&Nt(a.get(e),t)||(Rt(n),It(n),n.assignedMap.set(e,!0),n.copy.set(e,t),Pt(n,e,t,zt)),this},delete(e){if(!this.has(e))return!1;const t=mt(this);return Rt(t),It(t),t.original.has(e)?t.assignedMap.set(e,!1):t.assignedMap.delete(e),t.copy.delete(e),!0},clear(){const e=mt(this);if(this.size){Rt(e),It(e),e.assignedMap=new Map;for(const[t]of e.original)e.assignedMap.set(t,!1);e.copy.clear()}},forEach(e,t){ut(mt(this)).forEach((n,a)=>{e.call(t,this.get(a),a,this)})},get(e){var t,n;const a=mt(this),o=ut(a).get(e),r=(null===(n=(t=a.options).mark)||void 0===n?void 0:n.call(t,o,rt))===rt.mutable;if(a.options.strict&&Vt(o,a.options,r),r)return o;if(a.finalized||!gt(o,a.options))return o;if(o!==a.original.get(e))return o;const s=st.createDraft({original:o,parentDraft:a,key:e,finalities:a.finalities,options:a.options});return Rt(a),a.copy.set(e,s),s},keys(){return ut(mt(this)).keys()},values(){const e=this.keys();return{[ot]:()=>this.values(),next:()=>{const t=e.next();if(t.done)return t;return{done:!1,value:this.get(t.value)}}}},entries(){const e=this.keys();return{[ot]:()=>this.entries(),next:()=>{const t=e.next();if(t.done)return t;const n=this.get(t.value);return{done:!1,value:[t.value,n]}}}},[ot](){return this.entries()}},jt=Reflect.ownKeys(Bt),Ft=(e,t,{isValuesIterator:n})=>()=>{var a,o;const r=t.next();if(r.done)return r;const s=r.value;let i=e.setMap.get(s);const l=mt(i),c=(null===(o=(a=e.options).mark)||void 0===o?void 0:o.call(a,i,rt))===rt.mutable;if(e.options.strict&&Vt(s,e.options,c),c||l||!gt(s,e.options)||e.finalized||!e.original.has(s))l&&(i=l.proxy);else{const t=st.createDraft({original:s,parentDraft:e,key:s,finalities:e.finalities,options:e.options});e.setMap.set(s,t),i=t}return{done:!1,value:n?i:[i,i]}},Ht={get size(){return mt(this).setMap.size},has(e){const t=mt(this);if(t.setMap.has(e))return!0;Rt(t);const n=mt(e);return!(!n||!t.setMap.has(n.original))},add(e){const t=mt(this);return this.has(e)||(Rt(t),It(t),t.assignedMap.set(e,!0),t.setMap.set(e,e),Pt(t,e,e,zt)),this},delete(e){if(!this.has(e))return!1;const t=mt(this);Rt(t),It(t);const n=mt(e);return n&&t.setMap.has(n.original)?(t.assignedMap.set(n.original,!1),t.setMap.delete(n.original)):(!n&&t.setMap.has(e)?t.assignedMap.set(e,!1):t.assignedMap.delete(e),t.setMap.delete(e))},clear(){if(!this.size)return;const e=mt(this);Rt(e),It(e);for(const t of e.original)e.assignedMap.set(t,!1);e.setMap.clear()},values(){const e=mt(this);Rt(e);const t=e.setMap.keys();return{[Symbol.iterator]:()=>this.values(),next:Ft(e,t,{isValuesIterator:!0})}},entries(){const e=mt(this);Rt(e);const t=e.setMap.keys();return{[Symbol.iterator]:()=>this.entries(),next:Ft(e,t,{isValuesIterator:!1})}},keys(){return this.values()},[ot](){return this.values()},forEach(e,t){const n=this.values();let a=n.next();for(;!a.done;)e.call(t,a.value,a.value,this),a=n.next()}};Set.prototype.difference&&Object.assign(Ht,{intersection(e){return Set.prototype.intersection.call(new Set(this.values()),e)},union(e){return Set.prototype.union.call(new Set(this.values()),e)},difference(e){return Set.prototype.difference.call(new Set(this.values()),e)},symmetricDifference(e){return Set.prototype.symmetricDifference.call(new Set(this.values()),e)},isSubsetOf(e){return Set.prototype.isSubsetOf.call(new Set(this.values()),e)},isSupersetOf(e){return Set.prototype.isSupersetOf.call(new Set(this.values()),e)},isDisjointFrom(e){return Set.prototype.isDisjointFrom.call(new Set(this.values()),e)}});const Zt=Reflect.ownKeys(Ht),Yt={get(e,t,n){var a,o;const r=null===(a=e.copy)||void 0===a?void 0:a[t];if(r&&e.finalities.draftsCache.has(r))return r;if(t===nt)return e;let s;if(e.options.mark){const a="size"===t&&(e.original instanceof Map||e.original instanceof Set)?Reflect.get(e.original,t):Reflect.get(e.original,t,n);if(s=e.options.mark(a,rt),s===rt.mutable)return e.options.strict&&Vt(a,e.options,!0),a}const i=ut(e);if(i instanceof Map&&jt.includes(t)){if("size"===t)return Object.getOwnPropertyDescriptor(Bt,"size").get.call(e.proxy);return Bt[t].bind(e.proxy)}if(i instanceof Set&&Zt.includes(t)){if("size"===t)return Object.getOwnPropertyDescriptor(Ht,"size").get.call(e.proxy);return Ht[t].bind(e.proxy)}if(!it(i,t)){const n=lt(i,t);return n?"value"in n?n.value:null===(o=n.get)||void 0===o?void 0:o.call(e.proxy):void 0}const l=i[t];if(e.options.strict&&Vt(l,e.options),e.finalized||!gt(l,e.options))return l;if(l===Et(e.original,t)){if(Rt(e),e.copy[t]=Xt({original:e.original[t],parentDraft:e,key:1===e.type?Number(t):t,finalities:e.finalities,options:e.options}),"function"==typeof s){const n=mt(e.copy[t]);return Rt(n),It(n),n.copy}return e.copy[t]}return ht(l)&&e.finalities.draftsCache.add(l),l},set(e,t,n){var a;if(3===e.type||2===e.type)throw new Error("Map/Set draft does not support any property assignment.");let o;if(1===e.type&&"length"!==t&&(!(Number.isInteger(o=Number(t))&&o>=0)||0!==t&&0!==o&&String(o)!==String(t)))throw new Error("Only supports setting array indices and the 'length' property.");const r=lt(ut(e),t);if(null==r?void 0:r.set)return r.set.call(e.proxy,n),!0;const s=Et(ut(e),t),i=mt(s);return i&&Nt(i.original,n)?(e.copy[t]=n,e.assignedMap=null!==(a=e.assignedMap)&&void 0!==a?a:new Map,e.assignedMap.set(t,!1),!0):(Nt(n,s)&&(void 0!==n||it(e.original,t))||(Rt(e),It(e),it(e.original,t)&&Nt(n,e.original[t])?e.assignedMap.delete(t):e.assignedMap.set(t,!0),e.copy[t]=n,Pt(e,t,n,zt)),!0)},has:(e,t)=>t in ut(e),ownKeys:e=>Reflect.ownKeys(ut(e)),getOwnPropertyDescriptor(e,t){const n=ut(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a?{writable:!0,configurable:1!==e.type||"length"!==t,enumerable:a.enumerable,value:n[t]}:a},getPrototypeOf:e=>Reflect.getPrototypeOf(e.original),setPrototypeOf(){throw new Error("Cannot call 'setPrototypeOf()' on drafts")},defineProperty(){throw new Error("Cannot call 'defineProperty()' on drafts")},deleteProperty(e,t){var n;return 1===e.type?Yt.set.call(this,e,t,void 0,e.proxy):(void 0!==Et(e.original,t)||t in e.original?(Rt(e),It(e),e.assignedMap.set(t,!1)):(e.assignedMap=null!==(n=e.assignedMap)&&void 0!==n?n:new Map,e.assignedMap.delete(t)),e.copy&&delete e.copy[t],!0)}};function Xt(e){const{original:t,parentDraft:n,key:a,finalities:o,options:r}=e,s=yt(t),i={type:s,finalized:!1,parent:n,original:t,copy:null,proxy:null,finalities:o,options:r,setMap:3===s?new Map(t.entries()):void 0};(a||"key"in e)&&(i.key=a);const{proxy:l,revoke:c}=Proxy.revocable(1===s?Object.assign([],i):i,Yt);if(o.revoke.push(c),i.proxy=l,n){const e=n;e.finalities.draft.push((t,n)=>{var o,r;const s=mt(l);let i=3===e.type?e.setMap:e.copy;const c=vt(i,a),d=mt(c);if(d){let r=d.original;d.operated&&(r=pt(c)),$t(d),Ot(d,zt,t,n),e.options.enableAutoFreeze&&(e.options.updatedValues=null!==(o=e.options.updatedValues)&&void 0!==o?o:new WeakMap,e.options.updatedValues.set(r,d.original)),bt(i,a,r)}null===(r=s.callbacks)||void 0===r||r.forEach(e=>{e(t,n)})})}else{const e=mt(l);e.finalities.draft.push((t,n)=>{$t(e),Ot(e,zt,t,n)})}return l}function Ut(e,t,n,a,o){var r;const s=mt(e),i=null!==(r=null==s?void 0:s.original)&&void 0!==r?r:e,l=!!t.length;if(null==s?void 0:s.operated)for(;s.finalities.draft.length>0;){s.finalities.draft.pop()(n,a)}const c=l?t[0]:s?s.operated?s.copy:s.original:e;return s&&Ct(s),o&&Lt(c,c,null==s?void 0:s.options.updatedValues),[c,n&&l?[{op:et,path:[],value:t[0]}]:n,a&&l?[{op:et,path:[],value:i}]:a]}function Gt(e){const{rootDraft:t,value:n,useRawReturn:a=!1,isRoot:o=!0}=e;Tt(n,(n,a,o)=>{const r=mt(a);if(r&&t&&r.finalities===t.finalities){e.isContainDraft=!0;const t=r.original;if(o instanceof Set){const e=Array.from(o);o.clear(),e.forEach(e=>o.add(n===e?t:e))}else bt(o,n,t)}else"object"==typeof a&&null!==a&&(e.value=a,e.isRoot=!1,Gt(e))}),o&&(e.isContainDraft||console.warn("The return value does not contain any draft, please use 'rawReturn()' to wrap the return value to improve performance."),a&&console.warn("The return value contains drafts, please don't use 'rawReturn()' to wrap the return value."))}function qt(e){var t;const n=mt(e);if(!gt(e,null==n?void 0:n.options))return e;const a=yt(e);if(n&&!n.operated)return n.original;let o;function r(){o=2===a?dt(e)?new Map(e):new(Object.getPrototypeOf(e).constructor)(e):3===a?Array.from(n.setMap.values()):xt(e,null==n?void 0:n.options)}if(n){n.finalized=!0;try{r()}finally{n.finalized=!1}}else o=e;if(Tt(o,(t,a)=>{if(n&&Nt(vt(n.original,t),a))return;const s=qt(a);s!==a&&(o===e&&r(),bt(o,t,s))}),3===a){const e=null!==(t=null==n?void 0:n.original)&&void 0!==t?t:o;return ct(e)?new Set(o):new(Object.getPrototypeOf(e).constructor)(o)}return o}function Kt(e){if(!ht(e))throw new Error(`current() is only used for Draft, parameter: ${e}`);return qt(e)}st.createDraft=Xt;const Qt=function e(t,n,a){var o,r,s;if("function"==typeof t&&"function"!=typeof n)return function(a,...o){return e(a,e=>t.call(this,e,...o),n)};const i=t,l=n;let c=a;if("function"!=typeof n&&(c=n),void 0!==c&&"[object Object]"!==Object.prototype.toString.call(c))throw new Error(`Invalid options: ${c}, 'options' should be an object.`);c=Object.assign(Object.assign({},Wt),c);const d=ht(i)?Kt(i):i,u=Array.isArray(c.mark)?(e,t)=>{for(const n of c.mark){if("function"!=typeof n)throw new Error(`Invalid mark: ${n}, 'mark' should be a function.`);const a=n(e,t);if(a)return a}}:c.mark,h=null!==(o=c.enablePatches)&&void 0!==o&&o,m=null!==(r=c.strict)&&void 0!==r&&r,p={enableAutoFreeze:null!==(s=c.enableAutoFreeze)&&void 0!==s&&s,mark:u,strict:m,enablePatches:h};if(!gt(d,p)&&"object"==typeof d&&null!==d)throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");const[g,f]=function(e,t){var n;const a={draft:[],revoke:[],handledSet:new WeakSet,draftsCache:new WeakSet};let o,r;t.enablePatches&&(o=[],r=[]);const s=(null===(n=t.mark)||void 0===n?void 0:n.call(t,e,rt))!==rt.mutable&&gt(e,t)?Xt({original:e,parentDraft:null,finalities:a,options:t}):e;return[s,(e=[])=>{const[n,a,i]=Ut(s,e,o,r,t.enableAutoFreeze);return t.enablePatches?[n,a,i]:n}]}(d,p);if("function"!=typeof n){if(!gt(d,p))throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");return[g,f]}let y;try{y=l(g)}catch(e){throw Ct(mt(g)),e}const v=e=>{const t=mt(g);if(!ht(e)){if(void 0!==e&&!Nt(e,g)&&(null==t?void 0:t.operated))throw new Error("Either the value is returned as a new non-draft value, or only the draft is modified without returning any value.");const n=null==e?void 0:e[at];if(n){const a=n[0];return p.strict&&"object"==typeof e&&null!==e&&Gt({rootDraft:t,value:e,useRawReturn:!0}),f([a])}if(void 0!==e)return"object"==typeof e&&null!==e&&Gt({rootDraft:t,value:e}),f([e])}if(e===g||void 0===e)return f([]);const n=mt(e);if(p===n.options){if(n.operated)throw new Error("Cannot return a modified child draft.");return f([Kt(e)])}return f([e])};return y instanceof Promise?y.then(v,e=>{throw Ct(mt(g)),e}):v(y)};var Wt;Object.prototype.constructor.toString();class Jt{_listenerId=0;_listenerMap;constructor(e){this._listenerMap=e}addListener(e,t){const n=e,a=this._listenerMap[n];if(a){this._listenerId++;const e=`${this._listenerId}`;return a[e]=t,()=>{delete a[e]}}throw new Error(`event[${n}] not found`)}dispatch(e,t){const n=e,a=this._listenerMap[n];a&&Object.keys(a).forEach(e=>{a[e]?.(t)})}}function en(e,t=0){let n=null;return(...a)=>{n&&clearTimeout(n),n=setTimeout(()=>{n=null,e(...a)},t)}}const tn={root:void 0,item:void 0,path:"",ids:"",level:0},nn={find(e,t,n=tn,a=0){const o={parent:n.item,index:a,path:e.name&&n.path?`${n.path}${$}${e.name}`:e.name||"",ids:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",level:n.level+1,hasChildren:Boolean(e.children&&e.children.length),root:n.root||e},r=t(e,o);if(r)return"boolean"==typeof r?e:r;if(o.hasChildren){const{path:n,ids:a,level:r,root:s}=o,i=e.children||[];for(let o=0,l=i.length;o<l;o++){const l=i[o],c=nn.find(l,t,{item:e,path:n,ids:a,level:r,root:s},o);if(c)return"boolean"==typeof c?l:c}}},list(e,t,n=tn,a=0,o,r=[]){const s={parent:n.item,index:a,path:e.name&&n.path?`${n.path}${$}${e.name}`:e.name||"",ids:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",level:n.level+1,hasChildren:Boolean(e.children&&e.children.length),root:n.root||e},i=t(e,o,s);if(i&&(r.push(i),s.hasChildren)){const{path:n,ids:a,level:o,root:l}=s,c=e.children||[];for(let s=0,d=c.length;s<d;s++){const d=c[s];nn.list(d,t,{item:e,path:n,ids:a,level:o,root:l},s,i,r)}}return r},map(e,t,n=tn,a=0,o){const r={parent:n.item,index:a,path:e.name&&n.path?`${n.path}${$}${e.name}`:e.name||"",ids:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",level:n.level+1,hasChildren:Boolean(e.children&&e.children.length),root:n.root||e},s=t(e,o,r);if(delete s.children,r.hasChildren){const{path:n,ids:a,level:o,root:i}=r;s.children=e.children.map((r,l)=>nn.map(r,t,{item:e,path:n,ids:a,level:o,root:i},l,s))}return s},filter(e,t,n=tn,a=0){const o={parent:n.item,index:a,path:e.name&&n.path?`${n.path}${$}${e.name}`:e.name||"",ids:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",level:n.level+1,hasChildren:Boolean(e.children&&e.children.length),root:n.root||e};if(t(e,o)){if(o.hasChildren){const{path:n,ids:a,level:r,root:s}=o,i=e.children.map((o,i)=>nn.filter(o,t,{item:e,path:n,ids:a,level:r,root:s},i)).filter(Boolean);e.children=i.length?i:void 0}return e}},each(e,t,n=tn,a=0){const{name:o,id:r,children:s}=e,i={parent:n.item,index:a,path:o&&n.path?`${n.path}${$}${o}`:o||"",ids:r&&n.ids?`${n.ids}${$}${r}`:r||"",level:n.level+1,hasChildren:Boolean(s&&s.length),root:n.root||e},l=t(e,i);if(void 0!==l)return l;if(i.hasChildren){const{path:n,ids:a,level:o,root:r}=i,l=s;for(let s=0,i=l.length;s<i;s++){const i=l[s];if(nn.each(i,t,{item:e,path:n,ids:a,level:o,root:r},s))return!0}}},recurse(e,t,n,a=tn,o=0){const r={parent:a.item,index:o,path:e.name&&a.path?`${a.path}${$}${e.name}`:e.name||"",ids:e.id&&a.ids?`${a.ids}${$}${e.id}`:e.id||"",level:a.level+1,hasChildren:Boolean(e.children&&e.children.length),root:a.root||e};if(t(e,r))return n(e,r),!0;if(r.hasChildren){const{path:a,ids:o,level:s,root:i}=r,l=e.children;for(let c=0,d=l.length;c<d;c++){const d=l[c];if(nn.recurse(d,t,n,{item:e,path:a,ids:o,level:s,root:i},c))return n(e,r),!0}}n(e,r)},toMap(e,t="id"){const n={};return nn.each(e,e=>{const a=e[t];n[a]=e}),n},produce:(e,t,n,a={item:void 0,path:"",ids:"",level:0},o=0)=>Qt(e,e=>{const r=e;nn.each(r,t,a,o),n?.(r)})},an={eachDeviceAndOutput(e,t,n=tn,a=0){const o={parent:n.item,index:a,path:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",ids:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",level:n.level+1,hasChildren:Boolean(e.children&&e.children.length),root:n.root||e,isDevice:!0},r=t(e,o);if(!0===r)return r;if(void 0===r&&e.outputSchema&&nn.each(e.outputSchema,t,{root:void 0,item:void 0,path:o.path,ids:o.ids,level:o.level+1}))return!0;if(o.hasChildren){const{path:n,ids:a,level:r,root:s}=o,i=e.children||[];for(let o=0,l=i.length;o<l;o++){const l=i[o];if(an.eachDeviceAndOutput(l,t,{item:e,path:n,ids:a,level:r,root:s},o))return!0}}},mapDeviceAndOutput(e,t,n=tn,a=0,o){const r={parent:n.item,index:a,path:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",ids:e.id&&n.ids?`${n.ids}${$}${e.id}`:e.id||"",level:n.level+1,hasChildren:Boolean(e.children&&e.children.length),root:n.root||e,isDevice:!0},s=t(e,o,r);if(delete s.children,delete s.outputSchema,e.outputSchema&&(s.outputSchema=nn.map(e.outputSchema,t,{root:void 0,item:void 0,path:r.path,ids:r.ids,level:r.level+1})),r.hasChildren){const{path:n,ids:a,level:o,root:i}=r;s.children=e.children.map((r,l)=>an.mapDeviceAndOutput(r,t,{item:e,path:n,ids:a,level:o,root:i},l,s))}return s},produceDeviceAndOutput:(e,t,n)=>Qt(e,e=>{const a=e;an.eachDeviceAndOutput(a,t),n?.(a)}),flatToVariableMap(e){const t={};return an.eachDeviceAndOutput(e,(e,{isDevice:n})=>{n||(t[e.id]=e)}),t},highlightOutputs(e,t,n){const a={};let o;const r=an.produceDeviceAndOutput(t,(t,{ids:r})=>{a[t.id]=t,t.id===e?(o=r,t.folded&&(t.folded=void 0),t.highlighted=!0):(n&&(t.folded=!0),t.highlighted&&(t.highlighted=void 0))},()=>{o&&o.split($).forEach(e=>{const t=a[e];t.folded&&(t.folded=void 0)})});return r}};function on(e,t){const n=(e.getAttribute("class")||"").split(" ");n.includes(t)||n.push(t),e.setAttribute("class",n.join(" "))}function rn(e,t){const n=(e.getAttribute("class")||"").split(" ").filter(e=>e!==t);e.setAttribute("class",n.join(" "))}const sn={domRoles:{SuperInput:"ͼbaseflow-SuperInput",SuperInputVariables:"ͼbaseflow-SuperInputVariables",GraphContiner:"ͼbaseflow-GraphContiner",FlowNode:"ͼbaseflow-FlowNode",FlowNodePlus:"ͼbaseflow-FlowNodePlus",FlowNodeRange:"ͼbaseflow-FlowNodeRange"},attrRoles:"data-baseflow-role",closestTarget:function(e,t,n,a=9999){let o=0;do{if(o++,t(e))return e;e=e.parentElement}while(e&&e!==n&&o<a);return null},addClass:on,removeClass:rn,classNames:(...e)=>S(...e),buildDragHandlers:function(e,t,n,a){let o={source:void 0,target:void 0,folder:void 0};return{onDragStart(e){a&&a.current&&e.dataTransfer.setDragImage(a.current,0,0);const t=e.target;on(t,"ͼbaseflow-dragging"),o={source:t},n?.(t,!0)},onDragEnter(t){if(!o.source)return;const{target:n,folder:a}=e(t.target);o.folder!==a&&(o.folder&&rn(o.folder,"drop-active"),a&&on(a,"drop-active"),o.folder=a),o.target!==n&&(o.target&&rn(o.target,"drop-active"),n&&(on(n,"drop-active"),t.preventDefault()),o.target=n)},onDragOver(e){o.target&&e.preventDefault()},onDragEnd(e){o.source&&(n?.(o.source,!1),rn(o.source,"ͼbaseflow-dragging")),o.target&&rn(o.target,"drop-active"),o.folder&&rn(o.folder,"drop-active"),o={}},onDrap(){o.source&&o.target&&t(o.source,o.target)}}}},ln={requiredPrompt:"请输入...",iteratorSource:"迭代源",systemVariables:"系统变量",nameIsRequired:"名称必填",nameIsRepeat:"${name}名称重复",typeRestricted:"${type}类型受到限制",typeMismatch:"类型不匹配",nameMismatch:"名称不匹配",optionalMismatch:"必填设置不匹配",structureMismatch:"结构不匹配",emptyStringTips:"空字符串",envVariable:"环境变量",envVariableTips:"环境变量取值可为：development | production | test",selectPrompt:"请选择...",loopContextPrompt:"请输入迭代源(Array/Map/Number)",name:"变量名",label:"展示名",tips:"备注",optional:"可为空",type:"类型",subType:"子元素",useEnum:"值枚举",nameRestricted:"${name}名称受到限制",hasExist:"(${item})已经存在...",jsonValueTips:"必须是有效的JSON",schemaValueTips:"必须是有效的Schema结构...",alreadyToClipboard:"已放入剪贴板",jsonValue:"Json样例",schemaModel:"Schema结构",noOutputs:"无输出",paste:"粘贴",invalidTips:"检测到Value与Schema不匹配",infer:"推断",fix:"修复",format:"格式化",ButtonOk:"确定",ButtonCancel:"取消",ButtonSubmit:"提交",generate:"生成",simpleValue:"简单值",complexValue:"表达式",export:"导出",import:"导入",copy:"复制",create:"新建",edit:"编辑",update:"修改",delete:"删除",insertNext:"插入后续",insertChild:"插入子级",createdFromManual:"手动创建",createdFromDSL:"Schema导入",clipboardIsEmpty:"剪贴板数据无效",copied:"已复制",mapping:"迭代",assign:"赋值",deconstruct:"解构",nullAssert:"非空断言",setPath:"设置路径参数",convertTo:"强转为",equalTo:"等于",notEqualTo:"不等于",startsWith:"开头是",endsWith:"结尾是",containsString:"包含",notContainsString:"不包含",containsItem:"包含元素",notContainsItem:"不包含元素",containedIn:"被包含",notContainedIn:"不被包含",hasKey:"包含Key",notHasKey:"不包含Key",in:"在其中",notIn:"不在其中",greaterThan:"大于",lessThan:"小于",greaterOrEqual:"大于等于",lessOrEqual:"小于等于",earlierThan:"早于",laterThan:"晚于",earlierOrEqual:"早于等于",laterOrEqual:"晚于等于",condition:"条件判断",scriptsMode:"脚本模式",conditionScripts:"使用(JS)表达式返回Boolean值",createCondition:"增加条件",addGroup:"增加分组",delGroup:"删除分组",exportSchemaTips:"* 右边的输入为当前的Schema结构，左边的Json样例仅作为参考...",importSchemaTips:"* 可以在左边输入Json样例值，点击推断在右边生成其Schema结构... 也可以直接粘贴或编辑右边的Schema结构...\n* 最终提交将以右边的Schema结构为准..."};function cn(e,t={}){return e.replace(/\$\{([^}]*)\}/g,(e,n)=>t[n])}const dn=new Ge({preserveOrder:!0,ignoreAttributes:!1,suppressEmptyNode:!0,suppressBooleanAttributes:!0,format:!0}),un=new Be({preserveOrder:!0,ignoreAttributes:!1,allowBooleanAttributes:!0});function hn(e){const{type:t,name:n,label:a,tips:o,optional:r,direct:s,enums:i,children:l=[]}=e,c={[M[t]]:l.map(hn),":@":{}},d=c[":@"];return n&&(d["@_name"]=n),a&&(d["@_label"]=a),o&&(d["@_tips"]=o),s&&(d["@_direct"]=s),r&&(d["@_optional"]=!0),i?.length&&(d["@_enums"]=JSON.stringify(i)),c}const mn={string:R.String,number:R.Number,boolean:R.Bool,object:R.Object,array:R.Array,map:R.Map};function pn(e,t,n,a,o,r,s){return e.map(e=>{const i=V(n!==R.Array&&n!==R.Map||e.name!==L||!r&&!s?e.name:"0",e.optional,t,a),l=a?i.replace(/\?$/,""):i,c={...e,id:l};void 0!==o&&(c.folded=o);const d=r&&e.type===R.File?[{name:"fileName",type:R.String},{name:"fileSize",type:R.Number}]:e.children;return c.children=d?pn(r&&e.type===R.Array?[{name:"length",type:R.Number},...d]:d,i,e.type,a,o,r,s):void 0,c})}function gn(e,t="",n=!1,a,o,r){const s=V(e.name,e.optional,t,n),i=o&&e.type===R.File?[{name:"fileName",type:R.String},{name:"fileSize",type:R.Number}]:e.children;return{...e,id:s,folded:a,children:i?pn(o&&e.type===R.Array?[{name:"length",type:R.Number},...i]:i,s,e.type,n,a,o,r):void 0}}function fn(e,t,n){if(null==e)return void n.push({name:t,type:R.String,optional:!0});const a=typeof e,o="object"!==a?a:Array.isArray(e)?"array":L in e?"map":"object",r={name:t,type:mn[o]};if(n.push(r),r.type===R.Object){r.children=[];for(const t in e){fn(e[t],t,r.children)}}else r.type===R.Array?(r.children=[],fn(e[0],L,r.children)):r.type===R.Map&&(r.children=[],fn(e[L],L,r.children))}function yn(e){switch(e){case R.String:return"xxx";case R.Number:return 123;case R.Bool:return!0;case R.Date:return"1970-01-01 00:00:00";case R.Object:return{};case R.Array:return[];case R.Map:return{};case R.Any:return"xxx"}}function vn(e,t,n){e.forEach(e=>{const a=t===R.Array?"0":e.name,o=yn(e.type);n[a]=o,e.children&&vn(e.children,e.type,o)})}function bn(e,t){const n={};return e.map(e=>{const[a]=Object.keys(e),o=e[":@"]||{},r={};for(const e in o)r[e.substring(2)]=o[e].toString();const s=t===R.Array||t===R.Map?L:r.name,i=r.label;if(!s)throw ln.nameIsRequired;if(n[s])throw cn(ln.nameIsRepeat,{name:s});if(!R[a])throw cn(ln.typeRestricted,{type:a});n[s]=!0;const l=e[a],c={name:s,type:R[a]};if("true"===r.optional&&(c.optional=!0),r.tips&&(c.tips=r.tips),r.enums&&(c.enums=JSON.parse(r.enums)),i&&(c.label=i),c.type===R.Array||c.type===R.Map){const e=l[0]||{[M[R.String]]:[]};c.children=bn([e],c.type)}else c.type===R.Object&&l.length&&(c.children=bn(l,c.type));return c})}const En={toSchemaTitle(e,t,n){const a=n&&n(e,t)||{},o=e.name===L?"item":e.name,r=void 0!==a.label?a.label:e.label;return{title:(a.name||o)+(r?` (${r})`:""),tips:a.tips||e.tips||""}},toSchemaModelTree:(e,t="")=>gn(e,t),toSchemaModelTreeWithJsObject:(e,t="",n)=>gn(e,t,!0,n,!0),regenSchemaModelWithJsObject:(e,t,n)=>gn(e,t,!0,n,!1,!0),patchSchemaDirect(e,t,n,a){if(e.direct){const o=t[e.direct];if(o){if(!(o.type!==R.Array&&o.type!==R.Map||e.name!==Cn&&e.name!==wn)){if(e.name!==Cn)return void Object.assign(e,{type:o.type===R.Array?R.Number:R.String,direct:void 0});{const o=t[`${e.direct}[0]`];if(o){const r=En.regenSchemaModelWithJsObject({...o,name:e.name,label:e.label,direct:void 0},n,a);return Object.assign(e,r),void nn.each(e,e=>{t[e.id]=e})}}}const r=gn({...o,name:e.name,label:e.label,direct:void 0},n,!0,a,!1,!0);Object.assign(e,r),nn.each(e,e=>{t[e.id]=e})}}},highlightOutputs(e,t,n){const a={};let o;const r=nn.produce(t,(t,{ids:r})=>{a[t.id]=t,t.id===e?(o=r,t.folded&&(t.folded=void 0),t.highlighted=!0):(n&&(t.folded=!0),t.highlighted&&(t.highlighted=void 0))},()=>{o&&o.split($).forEach(e=>{const t=a[e];t.folded&&(t.folded=void 0)})});return r},filterArraySpecific(e){if(e.children){const t={...e};return e.type===R.Array&&(t.children=e.children.filter(e=>e.name===L)),t.children=t.children.map(e=>En.filterArraySpecific(e)),t}return e},schemaModelToXmlData:hn,schemaModelToXml:e=>dn.build([hn(e)]).trim(),xmlDataToSchemaModel:bn,xmlToSchemaModel:e=>bn(un.parse(e))[0],formatXml(e){const t=un.parse(e);return dn.build(t).trim()},jsonToSchemaModel(e){const t=JSON.parse(e);if(null==t)return{name:"???",type:R.String,optional:!0};const n=typeof t,a="object"!==n?n:Array.isArray(t)?"array":L in t?"map":"object",o={name:"???",type:mn[a]};if(o.type===R.Object){o.children=[];for(const e in t){fn(t[e],e,o.children)}}else o.type===R.Array?(o.children=[],fn(t[0],L,o.children)):o.type===R.Map&&(o.children=[],fn(t[L],L,o.children));return o},schemaModelToJson(e){const t=yn(e.type);return e.children&&vn(e.children,e.type,t),JSON.stringify(t,null,4)}},Nn="_temp_",Cn="_item_",wn="_key_",Sn="_length_",xn=`^${Cn}(?=[.[])`,Rn="_Brand_",Mn="_ENV_",_n={_string:"_string",_number:"_number",_boolean:"_boolean",_date:"_date",_time:"_time",_datetime:"_datetime",_any:"_any",_path:"_path"},In={_createMap:"_createMap",_arrayPush:"_arrayPush",_mappingEach:"_mappingEach",_loopKeyValue:"_loopKeyValue",_matchVariable:"_matchVariable"},kn="_utils",Ln={..._n,...In,[Mn]:Mn,[Rn]:Rn,[kn]:kn,[Nn]:Nn,[Sn]:Sn,[Cn]:Cn,[wn]:wn};Object.keys(Ln).reduce((e,t)=>(e[Ln[t]]=t,e),{});const Tn={schema:{id:kn,name:kn,type:R.Object,children:[]},nameReg:""};function Dn(e){Tn.schema=En.toSchemaModelTreeWithJsObject({name:kn,disabled:!0,type:R.Object,children:e.children});const t=e.children.map(e=>e.name).join("|");Tn.nameReg=`^(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})\\.`}const An={id:"_system_",name:"_system_",label:ln.systemVariables,type:R.Object,disabled:!0,children:[{id:Mn,name:Mn,tips:ln.envVariableTips,type:R.String},{id:"''",name:"emptyString",tips:ln.emptyStringTips,type:R.String},{id:"null",name:"null",type:R.Any},{id:"undefined",name:"undefined",type:R.Any}]},$n={isContainer:e=>e===R.Object||e===R.Array||e===R.Map,matchVariable(e){if(e){const t=e.match(new RegExp(`^(${Object.values(_n).join("|")})\\((.+)\\)$`));if(t){const n=t[2].split(","),a=n.shift().trim(),o=n.map(e=>e.trim());return{text:e,fun:t[1],variable:a,args:o,isAssert:a.endsWith("!")}}return{text:e,fun:"",variable:e,args:[],isAssert:e.endsWith("!")}}return{text:e,fun:"",variable:"",args:[],isAssert:!1}},getValidContextRef({text:e,source:t}){if(t===I.Variable){const{fun:t,variable:n}=$n.matchVariable(e);return t===_n._number?"0":n}return/\D/.test(e)?"":"0"},getVariableMode:e=>e===wn||e.startsWith(Cn)?"context":An.children.some(t=>t.id===e)?"constant":e.startsWith(kn)?"utils":"output",getConstants:()=>An,getUtils:()=>Tn.schema,getContext(e,t){if(e){if(/\D/.test(e)){if(t){const n=t.children?.find(e=>e.name===L)||{name:L,type:R.Any};return{id:"_context_",name:"_context_",label:`${ln.iteratorSource}: ${e}`,type:R.Any,disabled:!0,children:[{id:wn,name:wn,type:t.type===R.Array?R.Number:R.String},{id:Sn,name:Sn,type:R.Number},En.regenSchemaModelWithJsObject({...n,label:"",name:Cn})]}}return{id:"_context_",name:"_context_",label:`${ln.iteratorSource}: ${e}`,type:R.Any,disabled:!0,children:[{id:wn,name:wn,type:R.Any},{id:Sn,name:Sn,type:R.Number},{id:Cn,name:Cn,type:R.Any}]}}return{id:"_context_",name:"_context_",label:`${ln.iteratorSource}: Number`,type:R.Any,disabled:!0,children:[{id:Cn,name:Cn,type:R.Number},{id:wn,name:wn,type:R.Number},{id:Sn,name:Sn,type:R.Number}]}}}},On="Node",Pn={[R.Any]:"any",[R.String]:"string",[R.Number]:"number",[R.Bool]:"boolean",[R.Date]:"_Date_",[R.Time]:"_Time_",[R.DateTime]:"_DateTime_",[R.Object]:"_Object_",[R.Map]:"_Map_",[R.Array]:"_Array_",[R.File]:"_File_"},zn=" | null | undefined",Vn=[`declare const ${Rn}: unique symbol;\ndeclare const ${Mn}: string;\ninterface ${Pn[R.Time]} {\n  [${Rn}]: 'Time';\n  toString: () => string;\n};\ninterface ${Pn[R.Date]} {\n  [${Rn}]: 'Date';\n  toString: () => string;\n};\ninterface ${Pn[R.DateTime]} {\n  [${Rn}]: 'DateTime';\n  toString: () => string;\n};\ninterface ${Pn[R.File]} {\n  [${Rn}]: 'File';\n  toString: () => string;\n  fileName: string;\n  fileSize: number;\n};\ntype ${Pn[R.Object]} = { [key: string]: any };\ntype ${Pn[R.Map]} = { [key: string]: any };\ntype ${Pn[R.Array]} = any[];\ntype _Iterator_ = number | { [key: string]: any };\ntype _IMapItems_<T, Keys extends keyof T = keyof T> = Keys extends any ? { [K in keyof T]: T[Keys] } : never;\nfunction ${_n._string}(value: any): string;\nfunction ${_n._number}(value: any): number;\nfunction ${_n._boolean}(value: any): boolean;\nfunction ${_n._any}(value: any): any;\nfunction ${_n._date}(value: any): ${Pn[R.Date]};\nfunction ${_n._time}(value: any): ${Pn[R.Time]};\nfunction ${_n._datetime}(value: any): ${Pn[R.DateTime]};\nfunction ${_n._path}<T>(value: T, ...args: any[]): T;\nfunction ${In._createMap}<T extends {[key:string]: any}>(obj: T & (T extends _IMapItems_<T> ? unknown : never)): T;\nfunction ${In._loopKeyValue}<A extends number>(arr: A): {${Cn}: number; ${wn}: number; ${Sn}: number};\nfunction ${In._loopKeyValue}<A extends any[]>(arr: A): {${Cn}: A[0]; ${wn}: number; ${Sn}: number};\nfunction ${In._loopKeyValue}<A extends {[key: string]: any}>(arr: A): {${Cn}: A[0]; ${wn}: string; ${Sn}: number};\nfunction ${In._arrayPush}<A extends any[]>(arr: A, ...item: A): A;\nfunction ${In._mappingEach}<A extends {[key: string | number]: any}, T extends number>(target: A, source: T, reduce: (${Cn}: number, ${wn}: number, ${Sn}: number) => A[0]);\nfunction ${In._mappingEach}<A extends {[key: string | number]: any}, T extends any[]>(target: A, source: T, reduce: (${Cn}: T[0], ${wn}: number, ${Sn}: number) => A[0]);\nfunction ${In._mappingEach}<A extends {[key: string | number]: any}, T extends {[key: string]: any}>(target: A, source: T, reduce: (${Cn}: T[0], ${wn}: string, ${Sn}: number) => A[0]);\nfunction ${In._matchVariable}<T, U extends T>(variable: T, value: U): void;\n  `];function Bn(e,t){return e.map(e=>{const n=V(e.name,!1,t,!1),a={...e,id:n};return a.children=e.children?Bn(e.children,n):void 0,a})}function jn(e,t,n){return e.map(e=>Fn(e,t,n))}function Fn(e,t,n){const{id:a,name:o,type:r,optional:s}=e;let i=e.children||[];const l="string"==typeof n?V(o,!1,n,!1):void 0,c=t[o],d=c?.value,u=c?.children,h=u?.reduce((e,t)=>(e[t.name]=t,e),{}),m=i.length&&u;let p=d?d.type===r&&d.optional===s?d:{...d,type:r,optional:s}:{type:r,optional:s,source:I.Variable,text:""};if(m||p.text!==L||(p.text=""),m){const{id:e,type:t,optional:n,children:a}=i[0];if(r===R.Array||r===R.Map)if(p.text===L)if(r===R.Array){i=[];let o=0;for(;h.hasOwnProperty(`${o}`);)i.push({name:`${o}`,id:e,type:t,optional:n,children:a}),o++;i.length||i.push({name:"0",id:e,type:t,optional:n,children:a})}else r===R.Map&&(i=Object.keys(h).map(o=>({name:o,id:e,type:t,optional:n,children:a})),i.length||i.push({name:"???",id:e,type:t,optional:n,children:a}));else i=[{name:L,id:e,type:t,optional:n,children:a}];else p={type:r,optional:s,source:I.Template,text:L}}const g={name:o,value:p,children:m?jn(i,h||{},l):void 0};return"string"==typeof n&&(g.id=l,g.schemaId=a),g}const Hn={getValueMode(e){const t=e.value,n=t.type;return n===R.Object?t.text===L?"deconstruct":"assign":n===R.Array||n===R.Map?t.text===L?"deconstruct":e.children?"mapping":"assign":"assign"},valueModeIsMapping(e){const t=e.value,n=e.value.type,a=(n===R.Array||n===R.Map)&&t.text!==L&&e.children;return Boolean(a)},toSchemaValueTree:(e,t)=>Bn(e,t),createSchemaValueByModel:(e,t,n)=>Fn(n?e:En.toSchemaModelTree(e),{[e.name]:t}),createSchemaValueTreeByModel:(e,t,n="",a)=>Fn(a?e:En.toSchemaModelTree(e),{[e.name]:t},n),checkForm(e){const t=e.querySelector(".ͼbaseflow-SuperInput[data-error]"),n=t?.getAttribute("data-error");return n||""},matchSchemaValueByModel(e,t){if(e.name!==t.name&&e.name!==L)return`(${t.name})${ln.nameMismatch}`;if(e.type!==t.value.type)return`(${t.name})${ln.typeMismatch}`;if(e.optional!==t.value.optional)return`(${t.name})${ln.optionalMismatch}`;const n=e.children,a=t.children;if(!n&&a)return`(${t.name})${ln.structureMismatch}`;if(n&&!a&&t.value.text===L)return`(${t.name})${ln.structureMismatch}`;if(n&&a)if(e.type===R.Object){if(a.length!==n.length)return`(${t.name})${ln.structureMismatch}`;const e=a.reduce((e,t)=>(e[t.name]=t,e),{});for(let t=0,a=n.length;t<a;t++){const a=n[t],o=e[a.name];if(!o)return`(${a.name})${ln.requiredPrompt}`;{const e=Hn.matchSchemaValueByModel(a,o);if(e)return e}}}else{const e=n[0];for(let t=0,n=a.length;t<n;t++){const n=a[t],o=Hn.matchSchemaValueByModel(e,n);if(o)return o}}},setValueMode(e,t,n){let a=t.children||[];"assign"===n||a[0]||(n="assign");const o=t.type,r={type:o,optional:t.optional,source:"deconstruct"===n?I.Template:I.Variable,text:"deconstruct"===n?L:""};if("assign"===n)return{...e,value:r,children:void 0};const{id:s,name:i,type:l,optional:c,children:d}=a[0];o!==R.Array&&o!==R.Map||(a=[{name:"deconstruct"===n?o===R.Array?"0":"???":i,id:s,type:l,optional:c,children:d}]);const u=jn(a,{},e.id);return{...e,value:r,children:u}},createNoDuplicateKey(e,t="???"){let n=1,a=t+n;for(;e[a];)n++,a=t+n;return a}},Zn={A:`{${z}`,B:`${z}}`,REG:`\\{${z}([^${z}]+?)${z}\\}`,VarTag:"CITE",toJSTpl:e=>e?`\`${e.replace(new RegExp(Zn.REG,"g"),(e,t)=>`\${${t}}`)}\``:"",hasVariable:e=>new RegExp(Zn.REG).test(e),extractVariable:e=>e.match(new RegExp(Zn.REG,"g"))?.map(e=>e.slice(2,-2)),wrapVariable:e=>`${Zn.A}${e}${Zn.B}`,getPureValue(e){const t=Zn.extractVariable(e);return t?1===t.length&&Zn.wrapVariable(t[0])===e?t[0]:"":e},getSingleVariable(e){const t=Zn.extractVariable(e);return t&&1===t.length&&Zn.wrapVariable(t[0])===e?t[0]:""}};function Yn(e){return Boolean(k[e.source]&&e.text)}function Xn(e){return Boolean(M[e.type]&&e.name)}function Un(e){return Boolean(e.value&&k[e.value.source]&&e.name)}function Gn(e,t,n,a={current:0},o=""){const r=`${o}const v${a.current++}`;if(t)n.push(`${r}: _Iterator_ = ${e.text||"null"};`);else{const t=`${r}: ${Pn[e.type]}${e.optional?zn:""} = `;if(e.text){if(e.source!==I.Template)n.push(`${t}${e.text};`);else if(e.text!==L){const a=Zn.extractVariable(e.text);a&&(1===a.length&&Zn.wrapVariable(a[0])===e.text?n.push(`${t}${a[0]};`):a.forEach(e=>{n.push(`${o}${e};`)}))}}else n.push(`${t}null;`)}}function qn(e,t,n,a=0,o=""){const r="    ".repeat(a),s=Hn.valueModeIsMapping(e);if(Gn(e.value,s,t,n,r),s){t.push(`${r}{`);const{text:n,source:a}=e.value;if(!n||a!==I.Variable&&/\D/.test(n)||new RegExp(xn).test(n)&&!o)t.push(`${r}    const ${Nn} = undefined;`),t.push(`${r}    const ${Sn} = undefined;`),t.push(`${r}    const ${Cn} = undefined;`),t.push(`${r}    const ${wn} = undefined;`),o="";else if(/\D/.test(n)){const e=n.replace(new RegExp(xn),o);t.push(`${r}    const ${Nn} = ${e};`),t.push(`${r}    const {${Sn}, ${Cn}, ${wn}} = ${In._loopKeyValue}(${Nn});`),o=`${e}[0]`}else t.push(`${r}    const ${Nn}: number[] = null as any;`),t.push(`${r}    const ${Sn}: number = null as any;`),t.push(`${r}    const ${Cn}: number = null as any;`),t.push(`${r}    const ${wn}: number = null as any;`),o=""}const i=e.children;if(i)for(let e=0,r=i.length;e<r;e++)qn(i[e],t,n,s?a+1:a,o);s&&t.push(`${r}}`)}function Kn(e,t){const n={current:0};for(const a in e){const o=e[a];o&&"object"===typeof o&&(Un(o)?qn(o,t,n):Yn(o)?Gn(o,!1,t,n,""):Xn(o)||Kn(o,t))}}function Qn(e,t=[]){return e&&(/\D/.test(e)?(t.push(`const ${Nn} = ${e};`),t.push(`const {${Sn}, ${Cn}, ${wn}} = ${In._loopKeyValue}(${Nn});`)):(t.push(`const ${Nn}: number[] = null as any;`),t.push(`const ${Sn}: number = null as any;`),t.push(`const ${Cn}: number = null as any;`),t.push(`const ${wn}: number = null as any;`))),t.join("\n")}function Wn(e,t,n,a,o,r){const s=" ".repeat(2*(t-1));if(n){const n=e[0];return n.type===R.Array?(a.push(`${s}Array<`),Wn(n.children||[],t+1,!0,a,o+$+(n.optional?"?":"!")+"0",n),a.push(`${s}${n.optional?zn:""}>`)):n.type===R.Object||n.type===R.Map?(a.push(`${s}Array<{`),Wn(n.children||[],t+1,!1,a,o+$+(n.optional?"?":"!")+"0",n),a.push(`${s}}${n.optional?zn:""}>`)):n.optional?a.push(`${s}(${Pn[n.type]} | null)[]`):a.push(`${s}${Pn[n.type]}[]`),a}{const n=r?.type===R.Map;return e.forEach(e=>{const r=o?`${o}${$}${e.optional?"?":"!"}${e.name}`:`${e.optional?"?":"!"}${e.name}`;n||a.push(`${s}/** [@${r.substring(1).replace(new RegExp(`${$}[?!]+`,"g"),"->").replace(/([[\]])/g,"\\$1")}](@/${r.replace(/([()])/g,"\\$1")}) */`);const i=e.optional?zn:"",l=1===t?`${s}type ${e.name} = `:n?`${s}[key: string]: `:`${s}"${e.name.replace(/"/g,'\\"')}"${e.optional?"?":""}: `;if(e.type===R.Object||e.type===R.Map)a.push(`${l}{`),Wn(e.children||[],t+1,!1,a,r,e),a.push(`${s}}${i};`);else if(e.type===R.Array){const n=(e.children||[])[0]||{type:R.Any};n.type===R.Object||n.type===R.Map?(a.push(`${l}Array<{`),Wn(n.children||[],t+1,!1,a,r+$+(n.optional?"?":"!")+"0",n),a.push(`${s}}${n.optional?zn:""}>${i};`)):n.type===R.Array?(a.push(`${l}Array<`),Wn(n.children||[],t+1,!0,a,r+$+(n.optional?"?":"!")+"0",n),a.push(`${s}${n.optional?zn:""}>${i};`)):n.optional?a.push(`${l}(${Pn[n.type]} | null)[]${i};`):a.push(`${l}${Pn[n.type]}[]${i};`)}else a.push(`${l}${Pn[e.type]}${i};`)}),a}}function Jn(e,t,n,a=0,o=!1){const r=" ".repeat(2*a),s=Hn.getValueMode(e),{name:i,children:l}=e,{type:c,text:d,source:u}=e.value,h=i===L?"0":i.replace(/"/g,'\\"'),m=o||0===a?`${r}`:`${r}"${h}": `,p=0===a?n:`${n}["${h}"]`,g=0===a?"":",";if("assign"===s)t.push(`${m}${u===I.Template?"'' as any":d||"null"}${g}`);else if("deconstruct"===s){const e=c===R.Array;t.push(`${m}${e?`${In._arrayPush}(${p}!, `:"{"}`),l?.forEach(n=>{Jn(n,t,p,a+1,e)}),t.push(`${r}${e?")":"}"}${g}`)}else"mapping"===s&&(t.push(`${m}${In._mappingEach}(${p}!, ${d||"null"}, (${Cn}, ${wn}, ${Sn}) => (`),l?.forEach(e=>{Jn(e,t,p,a+1,!0)}),t[t.length-1]=t[t.length-1].replace(/,$/,""),t.push(`)${r})${g}`))}const ea={NodeFlag:P,NodeNamespace:On,systemDTS:Vn,superInputToInspector:function(e,t,n){const a=[];return Qn(t,a),Gn(e,n,a),a.join("\n")},propsToInspector:function(e){const t=[];return Kn(e,t),t},contextToInspector:Qn,deviceToVariable:function(e){const t=[];return nn.each(e,e=>{e.outputSchema&&t.push(`const ${e.id}: ${On}.${e.id};`)}),t.join("\n")},schemaToDTS:function(e){return Wn(e,1,!1,[],"",null)},schemaValueToSRC:function(e){const{variable:t}=$n.matchVariable(e.path);if(e.value){const n=[];return Jn(e.value,n,t),`    ${In._matchVariable}(${t}, ${n.join("\n")});`}return`    ${In._matchVariable}(${t}, undefined);`}},ta={locale:"",monacoEditorUrl:"/monaco/index.html"};function na({locale:e,lang:t,monacoEditorUrl:n,expressionUtils:a}){t&&Object.assign(ln,t),e&&(ta.locale=e),n&&(ta.monacoEditorUrl=n),a&&Dn(a)}const aa=50;if(!window[x]){let e,t=1;class n{proxy;bindId;tsServer;iframe;callback={resolve:()=>{},reject:()=>{}};validateSuperInputTimer;constructor(){const e=document.createElement("iframe");this.iframe=e,e.className="ͼbaseflow-sr-monaco",e.src=ta.monacoEditorUrl,document.body.appendChild(e),this.proxy=new Promise((e,t)=>{this.callback={resolve:e,reject:t}})}init(e){this.tsServer=e,e.ss(ea.systemDTS.join("\n")),this.callback.resolve({tsServer:e,editorDom:this.iframe,validateSuperInput:this.validateSuperInput.bind(this)})}destory=()=>{this.iframe.remove(),e=void 0};bindApp(e){this.bindId=e}validateSuperInput(e,t,n){this.validateSuperInputTimer||(this.validateSuperInputTimer={timer:setTimeout(()=>{const e=this.validateSuperInputTimer.items;this.validateSuperInputTimer=void 0,this.commitValidateSuperInput(e)},aa),items:{}});this.validateSuperInputTimer.items[e]={validator:t,callback:n}}commitValidateSuperInput(e){const t=[];for(const n in e){const a=e[n];t.push(O+n),t.push("{"),t.push(a.validator),t.push("}")}const n=t.join("\n");this.tsServer?.ce(n,O).then(t=>{for(const n in e)e[n].callback(t[n]||"")})}}window[x]={createUID:()=>(t++,t),initTSServer:t=>{e&&e.init(t)},createValidateProvider:()=>(e||(e=new n),e)}}const oa=window[x],ra={message:{error:e=>alert(e),success:e=>alert(e)},confirm:(e,t)=>{window.confirm(e)?t(!0):t(!1)},clipboard:{write:e=>navigator.clipboard?navigator.clipboard.writeText(e):Promise.resolve(localStorage.setItem("@baseflow-clipboard",e)),read:()=>navigator.clipboard?navigator.clipboard.readText():Promise.resolve(localStorage.getItem("@baseflow-clipboard")||"")}};function sa(e,t){const n={id:e.id,folded:e.folded,data:e.type};return e.childrenIds.length&&(n.children=e.childrenIds.map(e=>sa(t[e],t))),n}function ia(e){const t={};let n=null;return e.forEach(e=>{e.parentId||(n=e),t[e.id]=e}),{nodes:sa(n,t)}}function la(e,t="id"){return e.reduce((e,n)=>(e[n[t]]=n,e),{})}function ca(e,t){return Number(e.toFixed(t))}function da(e,t){if(t)for(const n in t)if(e[n]!==t[n])return!0;return!1}class ua{limit=20;undoList=[];redoList=[];running=!1;lock=0;graph;constructor(e){this.graph=e}getState(){return{undoAble:this.undoList.length>0,redoAble:this.redoList.length>0}}push(e){this.running||this.lock||(this.lock=setTimeout(()=>{this.lock=0},f),this.undoList.unshift(e),this.redoList.length=0,this.undoList.length>this.limit&&(this.undoList.length=this.limit),this.graph.dispatch("historyChanged",this.getState()))}undo(){if(!this.running&&this.undoList.length>0){const e=this.undoList.shift();return this.redoList.unshift(this.graph.toHistoryItem()),this.graph.dispatch("historyChanged",this.getState()),this.running=!0,this.graph.restoreHistory(e),this.running=!1,e}}redo(){if(!this.running&&this.redoList.length>0){const e=this.redoList.shift();return this.undoList.unshift(this.graph.toHistoryItem()),this.graph.dispatch("historyChanged",this.getState()),this.running=!0,this.graph.restoreHistory(e),this.running=!1,e}}}class ha{_state="disable";_data;_result;graph;_successed;fetch;constructor(e,t,n){this.graph=e,this._successed=t,this.fetch=n}setData(e){this._data=e,"disable"===this._state&&this._successed!==e?(this._state="enable",this.graph.dispatch("saverChanged",this._state)):"enable"===this._state&&this._successed===e&&(this._state="disable",this.graph.dispatch("saverChanged",this._state))}doSave=()=>{if(this.graph.hasBusy())setTimeout(this.doSave,p);else if(this._data){const e=this._data;this._data=void 0,this.fetch(e).then(()=>{this._successed=e,this._state=this._data&&this._data!==e?"enable":"disable",this.graph.dispatch("saverChanged",this._state),this._result?.resolve(),this._result=void 0},t=>{this._data||(this._data=e),this._state=this._successed===this._data?"disable":"enable",this.graph.dispatch("saverChanged",this._state),this._result?.reject(t),this._result=void 0})}else this._state="disable",this.graph.dispatch("saverChanged",this._state),this._result?.resolve(),this._result=void 0};save=()=>{if("saving"!==this._state)return this._state="saving",this.graph.dispatch("saverChanged",this._state),setTimeout(this.doSave,p),new Promise((e,t)=>{this._result={resolve:e,reject:t}})};getState(){return this._state}}function ma(e,t,n){const a=e[t],o=a.childrenIds;o.length&&o.forEach(t=>{n(e[t],a),ma(e,t,n)})}function pa(e,t){return e.map(e=>{const n=t[e],a=n.childrenIds;return delete n.childrenIds,a.length&&(n.children=pa(a,t)),n})}const ga={jsonToGraph(e){const{layout:t,sources:n,nodes:a,triggers:o,extend:r}=e;return{layout:t,sources:n,triggers:o.map(e=>{const t={...e,parentId:"",childrenIds:[]};return t.props=t.props||{},delete t.children,t}),nodes:nn.list(a,(e,t,{parent:n})=>{const a={...e,parentId:n?.id||"",childrenIds:[]};return a.props=a.props||{},delete a.children,t&&t.childrenIds.push(e.id),a}),extend:r}},graphToJson(e){const{layout:t,sources:n,triggers:a,extend:o}=e,r={};let s=null;e.nodes.forEach(e=>{const{id:t,tag:n,folded:a,meta:o,props:i,type:l,parentId:c,childrenIds:d}=e,{name:u,summary:h,remark:m,width:p,height:g,asyncState:f,mockState:y,valueReference:v,outputSchema:b,referenceErrors:E,configurationErrors:N}=o,C={id:t,tag:n,folded:a,meta:{name:u,summary:h,remark:m,width:p,height:g,asyncState:f,mockState:y,valueReference:v,outputSchema:b,referenceErrors:E,configurationErrors:N},props:i,type:l,parentId:c,childrenIds:d};delete C.parentId,delete C.type,r[e.id]=C,e.parentId||(s=C)});const i=s.childrenIds;return delete s.childrenIds,s.children=pa(i,r),JSON.parse(JSON.stringify({layout:t,sources:n,triggers:a,extend:o,nodes:s}))}},fa={[s.Flow]:"flow",[s.Start]:"start",[s.End]:"end"},ya={};class va extends Jt{_graphData;_graph;__graph__;_options;_unlinks=[];_hooks;_history;_saveManager;_selectedNodes=[];_nodeMap={};_dataMap={};_state="Editable";_nodeErrors;_validateReferenceTimer=0;_updateNodeDataTimer;_updateNodeErrorTimer;_currentNode;_currentInput;_lastLogs;_container;_onShowCreater;validateServer;constructor(e,t,n,a,o,r){super({dataChanged:{},statusChanged:{},nodeDataChanged:{},triggersChanged:{},layoutChanged:{},layoutRendered:{},historyChanged:{},saverChanged:{},selectedChanged:{},currentNodeChanged:{},currentInputChanged:{},refreshNodePanel:{},viewportZoomed:{},viewportResized:{}}),this._container=t,this._onShowCreater=n,this.validateServer=r,this._graph=this.toIGraph(),this.__graph__=this.splitGetSet(),this._options={...ya,...o},this._state=1===this._options.readonly?"ReadOnly":2===this._options.readonly?"NodeOnly":"Editable",a.setGraph(this),this._hooks=a,this._history=new ua(this);const[s,i]=[e.nodes,e.triggers].map(t=>t.map(t=>{const n=c(e.sources[t.tag]),a={...t,type:n.type,id:fa[n.type]||t.id};return n.propsRender&&(a.props=n.propsRender.in(t.props)),a}));(e={...e,nodes:s,triggers:i}).layout||(e.layout="dagre"),this._graphData=e,this._saveManager=new ha(this,e,e=>{const[t,n]=[e.nodes,e.triggers].map(t=>t.map(t=>{const n=c(e.sources[t.tag]);return n.propsRender?{...t,props:n.propsRender.out(t.props)}:t}));return this._hooks.onSave({...e,nodes:t,triggers:n})}),this.resetCaches(e.nodes,e.triggers,"init");const{dts:l}=this.toInspectCode();r.tsServer.st(l)}fetchLogsList(){return this._hooks.onFetchLogsList()}fetchLogsItem(e){return this._hooks.onFetchLogsItem(e)}getState(){return this._state}getStatus(){return this._nodeErrors?"error":"normal"}getErrors(){return this._nodeErrors}getSelected(){return this._selectedNodes}getSelectedIds(){return this._selectedNodes.map(e=>e.id)}getContainer(){return this._container}setCenterNode(e,t){!e&&this._nodeErrors&&(e=Object.keys(this._nodeErrors)[0],void 0===t&&(t=!0)),e=e||this._startNode.id,t&&this.reselect(e),this._flowLayout.setCenter(e,t)}resetCaches(e,t,n){const a=e.concat(t);if("restore"===n){this._updateNodeDataTimer=void 0,this._validateReferenceTimer=0;const e=this._dataMap,t=this._nodeMap;this._nodeMap=a.filter(t=>t===e[t.id]).reduce((e,n)=>(e[n.id]=t[n.id],e),{})}let o,r,i,l;e.length!==this._graphData.nodes.length&&(o={},r={}),t.length!==this._graphData.triggers.length&&(o={},i={});const c=this._dataMap,d=this._nodeMap;this._dataMap={},this._nodeMap={};const u=this._nodeErrors;if(this._nodeErrors=void 0,a.forEach(e=>{e.type===s.Flow?this._flowNode=e:e.type===s.Start?this._startNode=e:e.type===s.End&&(this._endNode=e);const t=e.id,n=e.meta.configurationErrors||e.meta.referenceErrors;n&&(this._nodeErrors||(this._nodeErrors={}),this._nodeErrors[t]=n),this._dataMap[t]=e,this._nodeMap[t]=d[t]||new ba(t,this),e!==c[t]&&(o||(o={}),o[t]=e,e.type===s.Trigger?(i||(i={}),i[t]=e):(r||(r={}),r[t]=e))}),"update"===n&&o)for(const e in o){const t=o[e],n=c[e];if(n){const a=t.meta,o=n.meta,r=t.props,s=n.props,i=this._nodeMap[e];if(i.rebuildGetSet(),a!==o){a.height===o.height&&a.width===o.width||this._flowLayout.refreshNodeSize(e);["name","summary","remark","mockState","asyncState","referenceErrors","configurationErrors"].some(e=>a[e]!==o[e])&&this.refreshNodeFacade(e),a.outputSchema!==o.outputSchema&&i.clearCache("dts"),a.valueReference!==o.valueReference&&i.clearCache("src"),a.mockState!==o.mockState&&i.clearCache("mock"),!a.mockState!=!o.mockState&&(l||(l={}),l[e]=t)}r!==s&&(i.clearCache("refs"),l||(l={}),l[e]=t)}else l||(l={}),l[e]=t}return{changed:o,actuatorsChanged:r,triggersChanged:i,propsChanged:l,statusChanged:!u!=!this._nodeErrors}}updateNodes(e,t,n={}){const a=e.concat(t),{changed:o,actuatorsChanged:r,triggersChanged:s,propsChanged:i,statusChanged:l}=this.resetCaches(e,t,"update");if(o){if(!n.noHistory){const e=this.toHistoryItem();this._history.push(e)}const c=this._graphData.sources,d={};a.forEach(e=>{d[e.tag]=c[e.tag]});const u={...this._graphData};u.sources=d,r&&(u.nodes=e),s&&(u.triggers=t),this._graphData=u,this.dispatch("nodeDataChanged",{changed:o}),this._saveManager.setData(this._graphData),this.rebuildGetSet(),this.dispatch("dataChanged",this._graphData),l&&this.dispatch("statusChanged",this.getStatus()),n.validate&&(this.validateReference(),i&&this.commitValidateConfiguration(i))}}restoreHistory(e){const{graphData:t,layoutData:n,viewport:a,selected:o}=e,r=this._graphData.layout!==t.layout,s=this._graphData.triggers!==t.triggers,{statusChanged:i}=this.resetCaches(t.nodes,t.triggers,"restore");this._graphData=t;const{dts:l}=this.toInspectCode();this.validateServer.tsServer.st(l),s&&this.dispatch("triggersChanged",t.triggers),r?this.dispatch("layoutChanged",{layout:t.layout,layoutData:n,viewport:a}):this._flowLayout.setData(n,a),this._saveManager.setData(this._graphData),this.rebuildGetSet(),this.dispatch("dataChanged",this._graphData),i&&this.dispatch("statusChanged",this.getStatus()),this.historySelect(o||"")}commitValidateReference(){const{dts:e,ts:t,flag:n}=this.toInspectCode();this.validateServer.tsServer.cd(e,t,n).then(e=>{let t=!1;const[n,a]=[this._graphData.nodes,this._graphData.triggers].map(n=>n.map(n=>n.meta.referenceErrors!==e[n.id]?(t=!0,{...n,meta:{...n.meta,referenceErrors:e[n.id]}}):n));t&&this.updateNodes(n,a,{noHistory:!0})})}commitValidateConfiguration(e){let t=!1;const n=this._nodeMap,a=this._graph,[o,r]=[this._graphData.nodes,this._graphData.triggers].map(o=>o.map(o=>{const r=o.id;if(e[r]){const e=n[r],s=this.getNodeConfigById(r),i=o.meta.mockState?void 0:s.validate?.({nodeData:o,node:e,graph:a})||void 0;if(o.meta.configurationErrors!==i)return t=!0,{...o,meta:{...o.meta,configurationErrors:i}}}return o}));t&&setTimeout(()=>this.updateNodes(o,r,{noHistory:!0}),g)}commitNodeData(e,t,n){const a=this._dataMap[e],o=da(a.meta,t),r=da(a.props,n);if(!o&&!r)return{newData:a,needValidate:!1};const s={...a};let i=!1;if(r&&(s.props={...s.props,...n},i=!0),o){s.meta={...s.meta,...t};const e=t?.outputSchema;e&&(e.name=s.id),i||("outputSchema"in t||"returnSchema"in t||"valueReference"in t||"mockState"in t)&&(i=!0)}return{newData:s,needValidate:i}}_batchUpdate=()=>{const e=this._updateNodeDataTimer.nodes;this._updateNodeDataTimer=void 0;let t=!1;const[n,a]=[this._graphData.nodes,this._graphData.triggers].map(n=>n.map(n=>{const a=e[n.id];if(a){const{newData:e,needValidate:o}=this.commitNodeData(n.id,a.meta,a.props);return o&&(t=!0),e}return n}));this.updateNodes(n,a,{validate:t});for(const t in e){const n=this._dataMap[t],a=e[t].callback;a&&n&&a.forEach(e=>{e(n)})}};updateNodeData(e,t,n,a){this._updateNodeDataTimer||(this._updateNodeDataTimer={timer:setTimeout(this._batchUpdate,g),nodes:{}});const o=this._updateNodeDataTimer.nodes;o[e]||(o[e]={});const r=o[e];t&&(r.meta||(r.meta={}),Object.assign(r.meta,t)),n&&(r.props||(r.props={}),Object.assign(r.props,n)),a&&(r.callback||(r.callback=new Set),r.callback.add(a))}_batchUpdateError=()=>{const e=this._updateNodeErrorTimer.nodes;this._updateNodeErrorTimer=void 0;const[t,n]=[this._graphData.nodes,this._graphData.triggers].map(t=>t.map(t=>{const n=e[t.id];return!n||n.configurationErrors===t.meta.configurationErrors&&n.referenceErrors===t.meta.referenceErrors?t:{...t,meta:{...t.meta,...n}}}));this.updateNodes(t,n,{noHistory:!0})};updateNodeError(e,t,n="configurationErrors"){this._updateNodeErrorTimer||(this._updateNodeErrorTimer={timer:setTimeout(this._batchUpdateError,g),nodes:{}});const a=this._updateNodeErrorTimer.nodes;a[e]||(a[e]={});a[e][n]=t}validateReference(){this._validateReferenceTimer&&clearTimeout(this._validateReferenceTimer),this._validateReferenceTimer=setTimeout(()=>{this._validateReferenceTimer=0,this._updateNodeDataTimer?this.validateReference():this.commitValidateReference()},y)}setLayout(e){if(this._graphData.layout!==e){const t=this.toHistoryItem();this._history.push(t);const{nodes:n,sources:a,triggers:o,extend:r}=this._graphData;this._graphData={nodes:n,sources:a,layout:e,triggers:o,extend:r},this.dispatch("layoutChanged",{layout:e}),this._saveManager.setData(this._graphData),this.rebuildGetSet(),this.dispatch("dataChanged",this._graphData)}}setReturnSchema(e,t){this.updateNodeData(this._flowNode.id,{outputSchema:e},void 0,t),this._graphData.nodes.forEach(e=>{e.type!==s.End&&e.type!==s.Return||this.updateNodeError(e.id,o.returnSchemaChanged,"configurationErrors")})}setInputSchema(e,t){this.updateNodeData(this._startNode.id,{outputSchema:e},void 0,t),this._graphData.triggers.forEach(e=>{this.updateNodeError(e.id,o.inputSchemaChanged,"configurationErrors")})}setLastLogs(e){this._lastLogs=e}getTriggers(){return this._graphData.triggers}get_NodeById(e){return this._nodeMap[e]}getNodeById(e){return this._nodeMap[e]?.getINode()}getNodeDataById(e){return this._dataMap[e]}getNodeConfigById(e){const t=this._dataMap[e]||{};return c(this._graphData.sources[t.tag])}getNodeConfigByTag(e){return c(this._graphData.sources[e])}getNodeSourceById(e){const t=this._dataMap[e]||{},n=this._graphData.sources[t.tag],a=c(n);let[o,r]=n.split("@").filter(Boolean);return n.startsWith("@")&&(o=`@${o}`),r||(r="*"),{name:o,formalVersion:r,actualVersion:a.version}}getVariableSchema(e){const{variable:t}=$n.matchVariable(e),n=this._currentNode?.runtimeVariableMaps[t.replace(/!$/,"")];if(n)return En.filterArraySpecific(n)}getInputSchema(){return this._startNode.meta.outputSchema}getReturnSchema(){return this._flowNode.meta.outputSchema}getSaverState(){return this._saveManager.getState()}getLastLogs(){return this._lastLogs}getNodeDomById(e){return document.getElementById(`bf_nd_${e}`)}getZoom(){return this.getViewport().zoom}zoomIn(){const e=this.getZoom(),t=Math.min(ca(e+.2,1),1);e!==t&&(this._flowLayout.zoomTo(t),this.dispatch("viewportZoomed",t))}zoomOut(){const e=this.getZoom(),t=Math.max(ca(e-.2,1),.2);e!==t&&(this._flowLayout.zoomTo(t),this.dispatch("viewportZoomed",t))}zoomFit(){const e=this.getZoom(),t=ca(this._flowLayout.zoomFit(),1);e!==t&&this.dispatch("viewportZoomed",t)}undo(){this._history.undo()}redo(){this._history.redo()}eachChildrenData(e,t){ma(this._dataMap,e,t)}uploadNodeData(e){const t=this._dataMap[e];if(!t)throw a(n.nodeNotExist,{node:e});return this._hooks.onUploadNodeData(t)}downloadNodeData(e){const t=this._dataMap[e];if(!t)throw a(n.nodeNotExist,{node:e});return this._hooks.onDownloadNodeData(this._graphData.sources[t.tag]).then(e=>{})}splitGetSet(){const e=this._graph,t={},n={};return Object.keys(e).forEach(a=>{/^(get|is|has)[A-Z]/.test(a)?t[a]=e[a]:n[a]=e[a]}),delete t.getNodeById,[t,n]}rebuildGetSet(){this.__graph__[0]=this.splitGetSet()[0]}toIGraph(){return{addListener:this.addListener.bind(this),getState:this.getState.bind(this),getStatus:this.getStatus.bind(this),getErrors:this.getErrors.bind(this),setLayout:this.setLayout.bind(this),setInputSchema:this.setInputSchema.bind(this),setReturnSchema:this.setReturnSchema.bind(this),setCenterNode:this.setCenterNode.bind(this),save:this.save.bind(this),testRun:this.testRun.bind(this),getGraphData:this.getGraphData.bind(this),getTriggers:this.getTriggers.bind(this),getNodeById:this.getNodeById.bind(this),getNodeDataById:this.getNodeDataById.bind(this),getNodeConfigByTag:this.getNodeConfigByTag.bind(this),getNodeDomById:this.getNodeDomById.bind(this),getNodeConfigById:this.getNodeConfigById.bind(this),getNodeSourceById:this.getNodeSourceById.bind(this),getVariableSchema:this.getVariableSchema.bind(this),getInputSchema:this.getInputSchema.bind(this),getReturnSchema:this.getReturnSchema.bind(this),getContainer:this.getContainer.bind(this),getLayout:this.getLayout.bind(this),getSelectedIds:this.getSelectedIds.bind(this),getSaverState:this.getSaverState.bind(this),getLastLogs:this.getLastLogs.bind(this),getZoom:this.getZoom.bind(this),zoomIn:this.zoomIn.bind(this),zoomOut:this.zoomOut.bind(this),zoomFit:this.zoomFit.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this),uploadNodeData:this.uploadNodeData.bind(this),downloadNodeData:this.downloadNodeData.bind(this),deleteNodes:this.deleteNodes.bind(this),deleteTrigger:this.deleteTrigger.bind(this),moveNodes:this.moveNodes.bind(this),applyNode:this.applyNode.bind(this),applyTrigger:this.applyTrigger.bind(this),toClipboard:this.toClipboard.bind(this),pasteFromClipboard:this.pasteFromClipboard.bind(this),dispose:this.dispose.bind(this),select:this.select.bind(this),reselect:this.reselect.bind(this),refreshCurrentNode:this.refreshCurrentNode.bind(this)}}onResized=en(()=>{this.dispatch("viewportResized",this._container)});onLayoutRendered=en(e=>{this.dispatch("layoutRendered",e)});refreshNodeFacade(e){const t=this._dataMap[e];t.type===s.Trigger?this._triggerLayout.refreshNodeUI(t):this._flowLayout.refreshNodeUI(e)}getGraphData(){return this._graphData}getNodeDataMaps(){return{...this._dataMap}}getIGraph(){return this._graph}getTGraph(){return this.__graph__}getLayout(){return this._graphData.layout}getViewport(){return this._flowLayout.getViewport()}setFlowLayout(e){this._flowLayout=e}setTriggerLayout(e){this._triggerLayout=e}isInited(){return Boolean(this._flowLayout)}hasBusy(){return Boolean(this._validateReferenceTimer||this._updateNodeDataTimer)}foldNode=(e,t)=>{const n=this._dataMap[e];n&&m.isContainer(n.type)&&(t||(t=!n.folded),this.updateNodes(this._graphData.nodes.map(n=>n.id===e?{...n,folded:t}:n),this._graphData.triggers),this._flowLayout.foldNode(e,t))};showCreator(e){this._onShowCreater(e)}save(){return this._saveManager.save()}async testRun(e,t,n){return await this.save(),this._hooks.onTestRun(e,t,n)}toHistoryItem(){return{graphData:this._graphData,layoutData:this._flowLayout.getData(),viewport:this.getViewport(),selected:this._currentNode?.nodeId}}dispose(){this._unlinks.forEach(e=>{e()})}}let ba=class extends Jt{_node;__node__;_dts=void 0;_refs=void 0;_mock=void 0;_src=void 0;id;graph;constructor(e,t){super({selected:{},unselected:{},showMenu:{}}),this.id=e,this.graph=t,this._node=this.toINode(),this.__node__=this.splitGetSet()}toINode(){return{getId:this.getId.bind(this),getData:this.getData.bind(this),getType:this.getType.bind(this),getTag:this.getTag.bind(this),getSize:this.getSize.bind(this),getConfig:this.getConfig.bind(this),getStatus:this.getStatus.bind(this),getName:this.getName.bind(this),getSummary:this.getSummary.bind(this),getRemark:this.getRemark.bind(this),getDom:this.getDom.bind(this),getSource:this.getSource.bind(this),getChildrenIds:this.getChildrenIds.bind(this),getChildrenLength:this.getChildrenLength.bind(this),getParentId:this.getParentId.bind(this),getErrors:this.getErrors.bind(this),hasError:this.hasError.bind(this),setMockState:this.setMockState.bind(this),setAsyncState:this.setAsyncState.bind(this),isTrigger:this.isTrigger.bind(this),isContainer:this.isContainer.bind(this),isRoute:this.isRoute.bind(this),isFork:this.isFork.bind(this),isFolded:this.isFolded.bind(this),isDefaultBranch:this.isDefaultBranch.bind(this),resetId:this.resetId.bind(this),updateProps:this.updateProps.bind(this),updateMeta:this.updateMeta.bind(this),updateOutputSchema:this.updateOutputSchema.bind(this),updateErrors:this.updateErrors.bind(this),fold:this.fold.bind(this),showMenu:this.showMenu.bind(this),refreshUI:this.refreshUI.bind(this),remove:this.remove.bind(this)}}splitGetSet(){const e=this._node,t={},n={};return Object.keys(e).forEach(a=>{/^(get|is|has)[A-Z]/.test(a)?t[a]=e[a]:n[a]=e[a]}),[t,n]}rebuildGetSet(){this.__node__[0]=this.splitGetSet()[0]}refreshUI(){this.graph.dispatch("refreshNodePanel",this.id)}setMockState(e){if(!m.mockAble(this.getType()))return n.nodeCannotBeDisable;this.updateMeta({mockState:e||void 0})}setAsyncState(e){this.updateMeta({mockState:e||void 0})}getId(){return this.id}getINode(){return this._node}getTNode(){return this.__node__}getGraph(){return this.graph.getIGraph()}getData(){return this.graph.getNodeDataById(this.id)}getConfig(){return this.graph.getNodeConfigById(this.id)}getName(){return this.getData().meta.name||this.id}getSummary(){return this.getData().meta.summary||""}getRemark(){return this.getData().meta.remark||""}getSize(){const{width:e,height:t}=this.getData().meta;return{width:e,height:t}}getType(){return this.getData().type}getTag(){return this.getData().tag}getChildrenIds(){return this.getData().childrenIds}getChildren(){return this.getChildrenIds().map(e=>this.graph.get_NodeById(e))}getChildrenLength(){return this.getData().childrenIds.length}getParentId(){return this.getData().parentId}getParent(){const e=this.getParentId();return e?this.graph.get_NodeById(e):null}getSource(){return this.graph.getNodeSourceById(this.id)}getErrors(){const e=this.getData();return{referenceErrors:e.meta.referenceErrors,configurationErrors:e.meta.configurationErrors}}getStatus(){return this.hasError()?"error":"normal"}getDom(){return this.graph.getNodeDomById(this.id)}isFirst(){const e=this.getParentId();if(e){return this.graph.getNodeDataById(e).childrenIds[0]===this.id}return!0}isLast(){const e=this.getParentId();if(e){const t=this.graph.getNodeDataById(e).childrenIds;return t[t.length-1]===this.id}return!0}isTrigger(){return this.getData().type===s.Trigger}isContainer(){return m.isContainer(this.getType())}isRoute(){return m.isRoute(this.getType())}isFork(){return m.isFork(this.getType())}isDefaultBranch(){return this.getData().type===s.Branch&&this.isLast()}isFolded(){return Boolean(this.getData().folded)}hasError(){const e=this.getData();return Boolean(e.meta.referenceErrors||e.meta.configurationErrors)}getMockState(){return this.getData().meta.mockState}fold(e){this.graph.foldNode(this.id,e)}updateProps(e,t){this.graph.updateNodeData(this.id,void 0,e,t)}updateMeta(e,t){this.graph.updateNodeData(this.id,e,void 0,t)}updateOutputSchema(e,t){this.updateMeta({outputSchema:e},t)}updateErrors(e,t="configurationErrors"){this.graph.updateNodeError(this.id,e,t)}resetId(e){return this.graph.resetNodeId(this.id,e)}remove(){this.graph.deleteNodes([this.id])}showMenu(){this.dispatch("showMenu",void 0)}validateConfiguration(){const e=this.getConfig(),t=this.getData(),n=t.meta.mockState?void 0:e.validate?.({nodeData:t,node:this,graph:this.getGraph()})||void 0;return this.updateErrors(n,"configurationErrors"),n}getDTS(){if(void 0===this._dts){const e=this.getData(),t=e.meta.outputSchema;if(t){if(!nn.find(t,e=>!!e.direct)){const e=ea.schemaToDTS([{...t,name:this.id}]),n={};this._dts={types:e.join("\n"),varMap:n};const a=En.toSchemaModelTreeWithJsObject({...t,name:this.id},"");nn.each(a,e=>{n[e.id]=e})}}else this._dts={types:`type ${e.id} = undefined;`,varMap:{}}}return this._dts}getSRC(){if(void 0===this._src){this._src="";const e=this.getData().meta.valueReference;e&&(this._src=ea.schemaValueToSRC(e))}return this._src}getRefs(){if(void 0===this._refs){this._refs=[];const e=this.getData().props;e&&Object.keys(e).length>0&&(this._refs=ea.propsToInspector(e))}return this._refs}getMock(){if(void 0===this._mock){this._mock=[];const e=this.getData().meta.mockState;e&&"object"==typeof e&&(this._mock=ea.propsToInspector({mock:e}))}return this._mock}clearCache(e){this[`_${e}`]=void 0}};function Ea(e,t,n){e.forEach(e=>{const a=n[e];t[e]=!0,a.childrenIds.length&&Ea(a.childrenIds,t,n)})}class Na extends va{constructor(e,t,n,a,o,r){let s;super(e,t,n,a,o,r);const i=e=>{s=e};t.addEventListener("mousedown",i,!1),this._unlinks.push(()=>t.removeEventListener("mousedown",i,!1));const l=sn.domRoles,c={[l.FlowNode]:!0,[l.GraphContiner]:!0,[l.SuperInput]:!0,[l.SuperInputVariables]:!0},d=e=>{if(!s||s.clientX===e.clientX&&s.clientY===e.clientY){s=void 0;const n=e.target,a=sn.closestTarget(n,e=>c[e.dataset.baseflowRole||""],t);if(a){const t=a.dataset.baseflowRole;if(t===l.FlowNode){const t=a.dataset.baseflowNode||"";return e.metaKey?this.select(t):this.reselect(t),void this.setCurrentSuperInput(void 0)}if(t===l.GraphContiner)return this.setCurrentSuperInput(void 0),void this.reselect("");if(t===l.SuperInput||t===l.SuperInputVariables)return}this.setCurrentSuperInput(void 0)}else s=void 0};t.addEventListener("click",d,!1),this._unlinks.push(()=>t.removeEventListener("click",d,!1))}setCurrentSuperInput(e){const t=this._currentInput;t!==e&&(this._currentInput=e,t&&t.setActive(!1),e&&e.setActive(!0),this.dispatch("currentInputChanged",e))}getCurrentSuperInput(){return this._currentInput}createNodeId(e,t={}){const n=e.match(/[a-z$][\w$]*$/i),a=n?n[0]:"node";return function(e,t){let n=1,a=t+n;for(;e[a];)n++,a=t+n;return a}({...this._dataMap,...t},a)}verifyNewNodeId(e){return/^[a-z$][\w$]*$/i.test(e)?this._dataMap[e]?a(n.nodeHasExist,{node:e}):"":n.nodeIdFormat}parseDeleteIds(e){const t={};Ea(e,t,this._dataMap);const n={},a={};return this._graphData.nodes.forEach(e=>{t[e.id]&&(t[e.parentId]||(n[e.parentId]||(n[e.parentId]={}),a[e.id]=!0,n[e.parentId][e.id]=!0))}),{delMap:t,delRealMap:a,delChildrenMap:n}}reselect(e){const t=this._selectedNodes,n=(e?Array.isArray(e)?e:[e]:[]).map(e=>this._nodeMap[e]).filter(Boolean),a=la(n),o=la(this._selectedNodes);n.length===t.length&&n.every(e=>o[e.id])||(this._hooks.onBeforeReselect(n),this._selectedNodes.forEach(e=>{!a[e.id]&&e.dispatch("unselected",e)}),n.forEach(e=>{!o[e.id]&&e.dispatch("selected",e)}),this.setSelectedNodes(n))}select(e){const t=this._nodeMap[e],n=this._dataMap[e];if(!t)return;if(n.type===s.Trigger)return void this.reselect(e);const a=this._selectedNodes;if(a[0]?.getType()===s.Trigger)return void this.reselect(e);this._hooks.onBeforeSelect(t);a.find(e=>e.id===t.id)?(t.dispatch("unselected",t),this.setSelectedNodes(a.filter(e=>e.id!==t.id))):(t.dispatch("selected",t),this.setSelectedNodes([...a,t]))}historySelect(e){const t=this._nodeMap[e];if(t){const n=this._currentNode;n?.nodeId!==t.id?(this._selectedNodes=[t],this.dispatch("selectedChanged",[e]),this._currentNode={node:t,nodeId:e,runtimeOutputs:{id:e},runtimeVariableMaps:{}},this.refreshCurrentNode(),this.dispatch("currentNodeChanged",{node:t,nodeId:t.id})):this.dispatch("nodeDataChanged",{changed:{[e]:t.getData()},inHistory:!0})}else this._selectedNodes.length&&(this._selectedNodes=[],this.dispatch("selectedChanged",[]),this._currentNode=void 0,this.validateServer.tsServer.sv(""),this.dispatch("currentNodeChanged",void 0))}setSelectedNodes(e){this._selectedNodes=e,this.dispatch("selectedChanged",this._selectedNodes.map(e=>e.id));const t=this._currentNode,n=1===e.length?e[0]:void 0;t?.nodeId!==n?.id&&(n?(this._currentNode={node:n,nodeId:n.id,runtimeOutputs:{id:n.id},runtimeVariableMaps:{}},this.refreshCurrentNode(),this.dispatch("currentNodeChanged",{node:n,nodeId:n.id})):(this._currentNode=void 0,this.validateServer.tsServer.sv(""),this.dispatch("currentNodeChanged",void 0)))}getCurrentNode(){return this._currentNode}refreshCurrentNode(){const e=this._currentNode?.node;if(e){const t=this.getRuntimeOutputs(e),n={};an.eachDeviceAndOutput(t,(e,{isDevice:t,parent:a})=>{if(!t){const t=e;n[t.id]=t,t.direct&&En.patchSchemaDirect(t,n,a?.id,!0)}});const a=ea.deviceToVariable(t);this._currentNode={node:e,nodeId:e.id,runtimeOutputs:t,runtimeVariableMaps:n},this.validateServer.tsServer.sv(a)}}getRuntimeOutputs(e){const t=e.getData();if(t.type===s.Trigger){const e=this._flowNode,n=this._startNode;return{id:e.id,data:s.Flow,children:[{id:t.id,data:t.type,outputSchema:t.meta.outputSchema?En.toSchemaModelTreeWithJsObject({...t.meta.outputSchema,name:t.id,folded:!0},"",!0):void 0},{id:n.id,data:n.type}]}}let n={id:t.id,data:t.type},a=e.getParent();for(;a;){const t=a.getData(),o=t.childrenIds,r=a.isRoute()?[]:o.slice(0,o.indexOf(e.getId())),s={id:t.id,data:t.type,outputSchema:!t.meta.outputSchema||t.meta.asyncState||t.meta.mockState&&!0===t.meta.mockState?void 0:En.toSchemaModelTreeWithJsObject({...t.meta.outputSchema,name:t.id,folded:!0},"",!0),children:r.map(e=>{const t=this.get_NodeById(e).getData();return{id:t.id,data:t.type,outputSchema:!t.meta.outputSchema||t.meta.asyncState||t.meta.mockState&&!0===t.meta.mockState?void 0:En.toSchemaModelTreeWithJsObject({...t.meta.outputSchema,name:t.id,folded:!0},"",!0)}})};s.children.push(n),n=s,a=(e=a).getParent()}return n}toInspectCode(){const e=[],{nodes:t}=ia(this._graphData.nodes),n=t.children,a=n.shift();this._graphData.triggers.forEach(e=>{n.unshift({id:e.id})}),n.unshift(a);const o=[],r=this._nodeMap,i=this._dataMap,l={};nn.recurse(t,(t,{level:n,hasChildren:a})=>{const c="  ".repeat(n),d=r[t.id],u=i[t.id];if(o.push(`${ea.NodeFlag}${t.id}`),u.type!==s.Trigger){const e=d.getSRC();e&&o.push(e);const t=u.meta.mockState?d.getMock():d.getRefs();t.length&&(o.push(`${c}{`),o.push(`  ${c}${t.join(`\n  ${c}`)}`),o.push(`${c}}`))}if(u.meta.asyncState)e.push(`type ${u.id} = undefined;`);else{const t=d.getDTS();if(t)e.push(t.types),Object.assign(l,t.varMap);else{const t=En.toSchemaModelTreeWithJsObject({...u.meta.outputSchema,name:u.id},"");nn.each(t,(e,{parent:t})=>{l[e.id]=e,e.direct&&En.patchSchemaDirect(e,l,t?.id)});const n=ea.schemaToDTS([t]);e.push(n.join("\n"))}}if(o.push(`${c}${u.type===s.Variable?"let":"const"} ${t.id}: ${ea.NodeNamespace}.${t.id} = null as any;`),u.type===s.Trigger&&!u.meta.mockState){const e=d.getSRC();e&&o.push(e);const t=d.getRefs();t.length&&(o.push(`${c}{`),o.push(`  ${c}${t.join(`\n  ${c}`)}`),o.push(`${c}}`))}a&&o.push(`${c}{`)},(e,{level:t,hasChildren:n})=>{const a="  ".repeat(t);n&&o.push(`${a}}`)});const c=`declare namespace ${ea.NodeNamespace} {\n${e.join("\n")}\n}`;return o.splice(3,0,...o.slice(0,2)),{dts:c,ts:o.slice(3,-1).join("\n"),flag:ea.NodeFlag}}deleteNodes(e){const{delMap:t,delRealMap:n,delChildrenMap:a}=this.parseDeleteIds(e);this._hooks.onBeforeDeleteNodes(t,n,a),this._selectedNodes.length&&this._selectedNodes.some(e=>t[e.id])&&this.reselect("");const o=this._graphData.nodes.filter(e=>!t[e.id]).map(e=>{const t=a[e.id];return t?{...e,childrenIds:e.childrenIds.filter(e=>!t[e])}:e});this.updateNodes(o,this._graphData.triggers,{validate:!0}),this._flowLayout.deleteNodes(t,a)}deleteTrigger(e){this._hooks.onBeforeDeleteTrigger(e),this._selectedNodes.length&&this._selectedNodes.some(t=>t.id===e)&&this.reselect(""),this.updateNodes(this._graphData.nodes,this._graphData.triggers.filter(t=>t.id!==e)),this._triggerLayout.setNodes(this._graphData.triggers)}resetNodeId(e,t){if("start"===e||"end"===e||"flow"===e)return n.idCannotBeModify;const o=this._dataMap[e];if(!o)return a(n.nodeNotExist,{node:e});const r=this.verifyNewNodeId(t);if(r)return r;if(this.reselect(""),o.type===s.Trigger){const n=this._graphData.triggers.map(n=>n.id===e?{...n,id:t}:n);return void this.updateNodes(this._graphData.nodes,n,{validate:!0})}const i=o.parentId,l=o.childrenIds.reduce((e,t)=>(e[t]=!0,e),{}),c=this._graphData.nodes.map(n=>n.id===e?{...n,id:t}:n.id===i?{...n,childrenIds:n.childrenIds.map(n=>n===e?t:n)}:l[n.id]?{...n,parentId:t}:n);this.updateNodes(c,this._graphData.triggers,{validate:!0}),this._flowLayout.resetNodeId(e,t)}moveNodes(e,t,n){const{delMap:a,delRealMap:o,delChildrenMap:r}=this.parseDeleteIds(n);this._hooks.onBeforeMoveNodes(e,t,a,o,r),this.reselect("");const s=this.get_NodeById(e),i="inside"===t?s.getId():s.getParentId(),l={},c=this._graphData.nodes.map(n=>{let a=n;if(o[n.id])a={...a,parentId:i};else{const s=r[n.id];if(s&&(a={...a,childrenIds:a.childrenIds.filter(e=>!s[e])},l[a.id]=a.childrenIds),n.id===i){const n="inside"===t?0:a.childrenIds.indexOf(e)+1;a={...a,childrenIds:[...a.childrenIds]},a.childrenIds.splice(n,0,...Object.keys(o)),l[a.id]=a.childrenIds}}return a});this.updateNodes(c,this._graphData.triggers,{validate:!0}),this._flowLayout.moveNodes(l)}applyTrigger(e,t){return u(t,this._graphData.sources,this._hooks.onImportNode.bind(this._hooks)).then(({sources:t,replaced:n})=>{const[a]=e;this._hooks.onBeforeApplyTrigger(a),this._graphData.sources={...this._graphData.sources,...t};const o=a.tag,r=this.getNodeConfigByTag(o),s={...a,id:this.createNodeId(a.tag),tag:o,type:r.type,parentId:"",childrenIds:[]},i=r.defaultData(s,this),l={...s,meta:{...i.meta,...s.meta},props:{...i.props,...s.props}};l.meta.outputSchema&&(l.meta.outputSchema={...l.meta.outputSchema,name:l.id});const c=this._graphData.triggers;return this.updateNodes(this._graphData.nodes,c.concat([l]),{validate:!0}),this._triggerLayout.setNodes(this._graphData.triggers),setTimeout(()=>this.reselect(l.id),g+50),n})}applyNode(e,t,n,a){return u(a,this._graphData.sources,this._hooks.onImportNode.bind(this._hooks)).then(({sources:a,replaced:o})=>{this._graphData.sources={...this._graphData.sources,...a},this._hooks.onBeforeApplyNodes(e,t,n);const r={},s=n.reduce((e,t)=>{const n=t.id;if(n)if(this._dataMap[n]){const a=this.createNodeId(t.tag,r);r[a]=!0,e[n]=a}else e[n]=n;return e},{}),i=[],l=this.get_NodeById(e),c="inside"===t?l:l.getParent(),d=c.getId(),u="inside"===t?0:c.getChildrenIds().indexOf(e)+1,h=n.map(e=>{const t=e.tag,n=this.getNodeConfigByTag(t),a={...e,id:s[e.id||""]||this.createNodeId(t),tag:t,type:n.type,parentId:s[e.parentId||""]||"",childrenIds:(e.childrenIds||[]).map(e=>s[e]).filter(Boolean)},o=n.defaultData(a,this),r={...a,meta:{...o.meta,...a.meta},props:{...o.props,...a.props}};return r.meta.outputSchema&&(r.meta.outputSchema={...r.meta.outputSchema,name:r.id}),r.parentId||(r.parentId=d,i.push(r.id)),r}),m=this._graphData.nodes.map(e=>{if(e.id===d){const t={...e,childrenIds:[...e.childrenIds]};return t.childrenIds.splice(u,0,...i),t}return e}).concat(h);return this.updateNodes(m,this._graphData.triggers,{validate:!0}),this._flowLayout.addNodes(h,c.getData()),1===h.length&&setTimeout(()=>this.reselect(h[0].id),g+50),o})}toClipboard(e,t){const{delMap:a,delRealMap:o}=this.parseDeleteIds(t),r={action:e,namespace:"baseflow",items:"cut"===e?Object.keys(o):Object.keys(a).map(e=>this.getNodeDataById(e))},s=JSON.stringify(r);return ra.clipboard.write(s).then(()=>ra.message.success(n.alreadyToClipboard)),s}async pasteFromClipboard(e,t){const a=await ra.clipboard.read(),o=a?JSON.parse(a):null;if(!o||"baseflow"!==o.namespace)throw new Error(n.clipboardIsEmpty);return"copy"===o.action?this.applyNode(e,t,o.items,o.sources):("cut"===o.action&&this.moveNodes(e,t,o.items),Promise.resolve({}))}}const Ca=Hn.createSchemaValueByModel,wa="ArrowRight",Sa="ArrowLeft",xa="ArrowDown",Ra="Align",Ma="Export",_a="Empty",Ia="Import",ka="Close",La="CloseFilled",Ta="Edit",Da="Delete",Aa="DownCircle",$a="Cut",Oa="Copy",Pa="CheckCircle",za="CloseCircle",Va="Switch",Ba="Undo",ja="Redo",Fa="BoldPlus",Ha="CloudUpload",Za="CloudDownload",Ya="Stop",Xa="Increase",Ua="decrease",Ga="Plus",qa="Minus",Ka="Fit",Qa="Code",Wa="Dagre",Ja="Run",eo="AddNext",to="AddSub",no="Pause",ao="PlusNext",oo="PlusSub",ro="PlusCircle",so="MinusCircle",io="Loop",lo="Down",co="Debug",uo="Help",ho="History",mo="Info",po="Options",go="Versions",fo="XML",yo="JSON";var vo=t.memo(function({className:e,name:t,button:n,role:a,...o}){return React.createElement("span",{role:"img","data-baseflow-role":a,className:sn.classNames("ͼbaseflow-sr-icon",e,{"ͼbaseflow-sr-btn":n}),...o},React.createElement("svg",{"aria-hidden":"true",width:"1em",height:"1em"},React.createElement("use",{href:`#@baseflow-icon-${t}`})))});const bo={name:eo,box:"0 0 500 500",content:'<path d="M 430 319.997 C 430 419.406 349.409 500 250.003 500 C 150.591 500 70 419.406 70 319.997 C 70 227.353 140.001 151.049 230 141.099 L 230 60 L 85 60 L 85 0 L 415 0 L 415 60 L 270 60 L 270 141.098 C 359.996 151.047 430 227.351 430 319.997 Z M 140.497 343.956 L 226.046 343.956 L 226.046 429.5 L 273.958 429.5 L 273.958 343.956 L 359.508 343.956 L 359.508 296.046 L 273.958 296.046 L 273.958 210.495 L 226.046 210.495 L 226.046 296.046 L 140.497 296.046 Z"></path>'},Eo={name:to,box:"0 0 500 500",content:'<path d="M 0.078 0 L 330 0.456 L 329.922 60.456 L 40 60.055 L 40 311.553 L 140.195 311.553 C 144.605 216.066 223.42 140 320.002 140 C 419.409 140 500 220.59 500 319.998 C 500 419.408 419.409 500 320.002 500 C 231.354 500 157.675 435.918 142.757 351.553 L 20 351.553 C 8.954 351.553 0 342.599 0 331.553 L 0 42.56 L 0.023 42.56 Z M 210.495 343.956 L 296.045 343.956 L 296.045 429.501 L 343.958 429.501 L 343.958 343.956 L 429.507 343.956 L 429.507 296.046 L 343.958 296.046 L 343.958 210.494 L 296.045 210.494 L 296.045 296.046 L 210.495 296.046 Z"></path>'},No={name:Ra,box:"64 64 896 896",content:'<path d="M264 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm496 424c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496zm144 140H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-424H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"></path>'},Co={name:xa,box:"0 0 1024 1024",content:'<path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"></path>'},wo={name:Sa,box:"0 0 1024 1024",content:'<path d="M689 165.1L308.2 493.5c-10.9 9.4-10.9 27.5 0 37L689 858.9c14.2 12.2 35 1.2 35-18.5V183.6c0-19.7-20.8-30.7-35-18.5z"></path>'},So={name:wa,box:"-100 0 1024 1024",content:'<path d="M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z" />'},xo={name:Fa,box:"0 0 1024 1024",content:'<path d="M576 192 448 192 448 448 192 448 192 576 448 576 448 832 576 832 576 576 832 576 832 448 576 448Z"></path>'},Ro={name:Pa,box:"64 64 896 896",content:'<path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"></path><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path>'},Mo={name:ka,box:"64 64 896 896",content:'<path d="M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"></path>'},_o={name:za,box:"64 64 896 896",content:'<path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"></path>'},Io={name:La,box:"64 64 896 896",content:'<path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"></path>'},ko={name:Za,box:"0 0 230 230",content:'<g transform="matrix(1, 0, 0, 1, -270.3800, -1.1368)">\n  <path d="M 386.998 219.18 C 386.175 220.23 384.585 220.23 383.764 219.18 L 355.014 182.806 C 354.041 181.565 354.777 179.736 356.339 179.515 C 356.435 179.501 356.533 179.494 356.631 179.495 L 375.601 179.495 L 375.601 109.272 C 375.601 108.143 376.524 107.219 377.655 107.219 L 393.056 107.219 C 394.185 107.219 395.11 108.143 395.11 109.272 L 395.11 179.469 L 414.131 179.469 C 415.85 179.469 416.801 181.446 415.748 182.78 L 386.998 219.18 Z"/>\n  <path d="M 462.235 77.318 C 450.479 46.308 420.523 24.258 385.432 24.258 C 350.342 24.258 320.385 46.283 308.628 77.292 C 286.629 83.067 270.38 103.115 270.38 126.937 C 270.38 155.302 293.355 178.276 321.694 178.276 L 331.987 178.276 C 333.117 178.276 334.041 177.352 334.041 176.223 L 334.041 160.821 C 334.041 159.692 333.117 158.767 331.987 158.767 L 321.694 158.767 C 313.043 158.767 304.906 155.327 298.848 149.09 C 292.816 142.878 289.607 134.509 289.889 125.833 C 290.121 119.056 292.43 112.69 296.615 107.326 C 300.902 101.858 306.908 97.879 313.582 96.108 L 323.311 93.566 L 326.88 84.171 C 329.087 78.319 332.167 72.85 336.044 67.896 C 339.87 62.987 344.403 58.669 349.494 55.088 C 360.045 47.669 372.469 43.742 385.432 43.742 C 398.396 43.742 410.82 47.669 421.37 55.088 C 426.478 58.681 430.996 62.994 434.82 67.896 C 438.696 72.85 441.776 78.344 443.984 84.171 L 447.527 93.54 L 457.229 96.108 C 471.143 99.855 480.872 112.51 480.872 126.937 C 480.872 135.434 477.56 143.443 471.553 149.449 C 465.603 155.434 457.506 158.789 449.067 158.767 L 438.773 158.767 C 437.644 158.767 436.719 159.692 436.719 160.821 L 436.719 176.223 C 436.719 177.352 437.644 178.276 438.773 178.276 L 449.067 178.276 C 477.406 178.276 500.38 155.302 500.38 126.937 C 500.38 103.141 484.182 83.119 462.235 77.318 Z"/>\n  </g>'},Lo={name:Ha,box:"64 64 896 896",content:'<path d="M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"></path><path d="M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"></path>'},To={name:Qa,box:"183 243 103.68 93.433",content:'<path d="M 186.044 280.381 C 184.896 280.381 183.958 279.443 183.958 278.295 L 183.958 245.865 C 183.958 244.717 184.896 243.778 186.044 243.778 L 241.817 243.778 C 242.965 243.778 243.904 244.717 243.904 245.865 L 243.904 278.295 C 243.904 279.443 242.965 280.381 241.817 280.381 L 186.044 280.381 Z M 193.347 270.991 L 234.514 270.991 L 234.514 253.168 L 193.347 253.168 L 193.347 270.991 Z M 254.337 271.252 C 254.337 270.679 254.807 270.209 255.381 270.209 L 286.594 270.209 C 287.168 270.209 287.637 270.679 287.637 271.252 L 287.637 278.556 C 287.637 279.129 287.168 279.599 286.594 279.599 L 255.381 279.599 C 254.807 279.599 254.337 279.129 254.337 278.556 L 254.337 271.252 Z M 254.337 252.907 L 254.337 245.604 C 254.337 245.03 254.807 244.561 255.381 244.561 L 286.594 244.561 C 287.168 244.561 287.637 245.03 287.637 245.604 L 287.637 252.907 C 287.637 253.481 287.168 253.951 286.594 253.951 L 255.381 253.951 C 254.807 253.951 254.337 253.481 254.337 252.907 Z M 186.045 337.211 C 184.897 337.211 183.959 336.273 183.959 335.125 L 183.959 302.695 C 183.959 301.547 184.897 300.608 186.045 300.608 L 241.818 300.608 C 242.966 300.608 243.905 301.547 243.905 302.695 L 243.905 335.125 C 243.905 336.273 242.966 337.211 241.818 337.211 L 186.045 337.211 Z M 193.348 327.821 L 234.515 327.821 L 234.515 309.998 L 193.348 309.998 L 193.348 327.821 Z M 254.338 328.082 C 254.338 327.509 254.808 327.039 255.382 327.039 L 286.595 327.039 C 287.169 327.039 287.638 327.509 287.638 328.082 L 287.638 335.386 C 287.638 335.959 287.169 336.429 286.595 336.429 L 255.382 336.429 C 254.808 336.429 254.338 335.959 254.338 335.386 L 254.338 328.082 Z M 254.338 309.737 L 254.338 302.434 C 254.338 301.86 254.808 301.391 255.382 301.391 L 286.595 301.391 C 287.169 301.391 287.638 301.86 287.638 302.434 L 287.638 309.737 C 287.638 310.311 287.169 310.781 286.595 310.781 L 255.382 310.781 C 254.808 310.781 254.338 310.311 254.338 309.737 Z"></path>'},Do={name:Oa,box:"207.054 191.403 178.89 227.674",content:'<path d="M 377.814 203.6 L 350.364 203.6 L 350.364 193.436 C 350.364 192.318 349.454 191.403 348.334 191.403 L 334.104 191.403 C 332.984 191.403 332.074 192.318 332.074 193.436 L 332.074 203.6 L 293.444 203.6 L 293.444 193.436 C 293.444 192.318 292.534 191.403 291.414 191.403 L 277.184 191.403 C 276.064 191.403 275.154 192.318 275.154 193.436 L 275.154 203.6 L 247.714 203.6 C 243.214 203.6 239.584 207.234 239.584 211.731 L 239.584 242.224 L 215.184 242.224 C 210.684 242.224 207.054 245.857 207.054 250.355 L 207.054 410.946 C 207.054 415.443 210.684 419.077 215.184 419.077 L 341.284 419.077 C 345.784 419.077 349.414 415.443 349.414 410.946 L 349.414 386.552 L 377.814 386.552 C 382.304 386.552 385.944 382.918 385.944 378.421 L 385.944 211.731 C 385.944 207.234 382.304 203.6 377.814 203.6 Z M 331.124 400.782 L 225.354 400.782 L 225.354 260.519 L 276.744 260.519 L 276.744 304.732 C 276.744 310.347 281.294 314.896 286.904 314.896 L 331.124 314.896 L 331.124 400.782 Z M 331.124 298.634 L 293.004 298.634 L 293.004 260.519 L 293.054 260.519 L 331.124 298.583 L 331.124 298.634 Z M 367.644 368.257 L 349.414 368.257 L 349.414 291.011 L 300.624 242.224 L 257.874 242.224 L 257.874 221.895 L 275.154 221.895 L 293.444 221.895 L 332.074 221.895 L 350.364 221.895 L 367.644 221.895 L 367.644 368.257 Z" />'},Ao={name:$a,box:"64 64 896 896",content:'<path d="M567.1 512l318.5-319.3c5-5 1.5-13.7-5.6-13.7h-90.5c-2.1 0-4.2.8-5.6 2.3l-273.3 274-90.2-90.5c12.5-22.1 19.7-47.6 19.7-74.8 0-83.9-68.1-152-152-152s-152 68.1-152 152 68.1 152 152 152c27.7 0 53.6-7.4 75.9-20.3l90 90.3-90.1 90.3A151.04 151.04 0 00288 582c-83.9 0-152 68.1-152 152s68.1 152 152 152 152-68.1 152-152c0-27.2-7.2-52.7-19.7-74.8l90.2-90.5 273.3 274c1.5 1.5 3.5 2.3 5.6 2.3H880c7.1 0 10.7-8.6 5.6-13.7L567.1 512zM288 370c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80zm0 444c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"></path>'},$o={name:Wa,box:"64 64 896 896",content:'<path d="M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"></path>'},Oo={name:co,box:"64 64 896 896",content:'<path d="M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1a184.31 184.31 0 00-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9a184.31 184.31 0 00-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z"></path><path d="M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8a63 63 0 01-63 63H232a63 63 0 01-63-63c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5.2 13 .7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7a273 273 0 0022.7 49c24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2a281.38 281.38 0 00123.2-149.5A120 120 0 01836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7.4-6.4.7-12.8.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3C584 874.3 548.8 884 512 884s-72-9.7-102.9-27.8c-30.3-17.7-55.6-43-73.3-73.3A202.75 202.75 0 01308 680V412h408v268z"></path>'},Po={name:Ua,box:"64 64 896 896",content:'<path d="M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"></path>'},zo={name:Da,box:"199.548 216.473 128.723 134.085",content:'<path d="M 238.433 240.607 L 289.386 240.607 L 289.386 228.54 L 290.727 228.54 C 289.989 228.54 289.386 227.939 289.386 227.198 L 289.386 228.54 L 238.433 228.54 L 238.433 227.198 C 238.433 227.939 237.83 228.54 237.092 228.54 L 238.433 228.54 L 238.433 240.607 Z M 301.453 240.607 L 322.907 240.607 C 325.874 240.607 328.271 243.006 328.271 245.97 L 328.271 251.333 C 328.271 252.073 327.667 252.675 326.93 252.675 L 316.806 252.675 L 312.666 340.334 C 312.398 346.066 307.688 350.558 301.956 350.558 L 225.862 350.558 C 220.147 350.558 215.421 346.05 215.152 340.334 L 211.012 252.675 L 200.889 252.675 C 200.152 252.675 199.548 252.073 199.548 251.333 L 199.548 245.97 C 199.548 243.006 201.945 240.607 204.912 240.607 L 226.365 240.607 L 226.365 227.198 C 226.365 221.284 231.176 216.473 237.092 216.473 L 290.727 216.473 C 296.643 216.473 301.453 221.284 301.453 227.198 L 301.453 240.607 Z M 304.722 252.675 L 223.097 252.675 L 227.153 338.49 L 257.505 338.49 L 257.505 281.736 L 270.314 281.736 L 270.314 338.49 L 300.666 338.49 L 304.722 252.675 Z" />'},Vo={name:lo,box:"0 0 1024 1024",content:'<path d="M512 559.1552l398.1824-389.31456a47.2832 47.2832 0 0 1 68.38272 2.38592 51.5584 51.5584 0 0 1-2.7648 71.40352l-426.1376 410.24c-21.69344 20.74624-56.90368 20.74624-78.62272 0-1.09568-1.04448-142.70976-137.55392-424.85248-409.52832a51.88096 51.88096 0 0 1-2.69312-71.90016 47.80544 47.80544 0 0 1 69.0176-2.4064l399.488 389.12z"></path>'},Bo={name:Aa,box:"64 64 896 896",content:'<path d="M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"></path><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path>'},jo={name:Ta,box:"2 0 18 20",content:'<path d="M10.8427581,3.29049799 C11.201201,2.93447931 11.7623576,2.90549653 12.1537974,3.20466412 L12.247906,3.28629312 L16.8505452,7.80340428 C17.217684,8.16372079 17.2475577,8.73689045 16.938996,9.13182034 L16.8548041,9.22661316 L7.3073426,18.709502 C7.15122797,18.8645608 6.94928875,18.962923 6.73351075,18.9914032 L6.60263918,19 L2,19 C1.48716416,19 1.06449284,18.6139598 1.00672773,18.1166211 L1,18 L1,13.4828888 C1,13.2608951 1.07381291,13.0465477 1.20779568,12.8726263 L1.29529659,12.7733868 L10.8427581,3.29049799 Z M11.552,5.405 L3,13.898 L3,17 L6.189,17 L14.726,8.521 L11.552,5.405 Z M14.6835225,0.476509026 L14.7774278,0.560038383 L19.4786615,5.29545958 C19.8677684,5.68739611 19.8654745,6.32055694 19.473538,6.70966386 C19.1117504,7.06883949 18.5444226,7.09451387 18.1532391,6.78806977 L18.0593337,6.70454042 L13.3581001,1.96911922 C12.9689932,1.57718269 12.971287,0.944021865 13.3632235,0.554914937 C13.7250111,0.195739311 14.2923389,0.170064935 14.6835225,0.476509026 Z" />'},Fo={name:_a,box:"0 0 1024 1024",content:'<path d="M615.565239 262.567068H800.894178L604.662935 65.334008v186.272427c0 5.482875 5.450129 10.960633 10.902304 10.960633z m-1.090845 333.101517H253.629c-13.080923 0-23.984251-10.955516-23.984251-24.102954 0-13.152555 10.904351-24.109094 23.984251-24.109095H629.735983c11.993149 0 20.716834 8.763594 22.895453 19.722181 34.886555-20.820188 75.223239-32.868595 118.826316-32.868595 10.904351 0 21.804608 1.093914 31.616068 2.192945V309.685201H615.565239c-31.614022 0-57.778938-26.301016-57.778938-58.077743V63.142086H111.906208c-26.164916 0-46.876634 20.818141-46.876634 47.11711v756.058529c0 26.292829 20.711717 47.113017 46.876634 47.113017h470.953141a236.410338 236.410338 0 0 1-46.87561-141.349285c0-70.123081 30.523177-133.678582 78.490655-176.412872zM253.629 406.105205H629.735983c13.08604 0 23.985274 10.960633 23.985274 24.109094s-10.899234 24.108071-23.985274 24.10807H253.629c-13.080923 0-23.984251-10.959609-23.984251-24.10807s10.903328-24.109094 23.984251-24.109094zM770.368954 583.615061c-103.567797 0-188.598402 84.372619-188.598402 189.564403 0 104.093776 83.941807 189.56031 188.598402 189.56031 104.656595-1.094938 188.599426-85.467557 188.599425-190.656271 0-104.095823-83.941807-188.468442-188.599425-188.468442z m0 306.806641c-13.0799 0-23.984251-10.955516-23.984251-24.102954 0-13.153578 10.904351-24.108071 23.984251-24.108071 13.080923 0 23.985274 10.95347 23.985274 24.108071 0.001023 14.239306-10.904351 24.102954-23.985274 24.102954z m0-71.223135c-13.0799 0-23.984251-129.294738-23.984251-141.348262 0-12.056594 10.904351-24.111141 23.984251-24.11114 13.080923 0 23.985274 10.960633 23.985274 24.11114 0.001023 13.146415-10.904351 141.348262-23.985274 141.348262z"></path>'},Ho={name:Ma,box:"0 0 1024 1024",content:'<path d="M904 632c30.912 0 56 25.088 56 56v216a56 56 0 0 1-56 56H120A56 56 0 0 1 64 904V688a56 56 0 0 1 112 0v160h672v-160c0-30.912 25.088-56 56-56zM512.192 64c14.336 0 28.672 5.44 39.68 16.384l237.44 237.568a56 56 0 1 1-79.168 79.168l-142.144-142.08v401.728a56 56 0 0 1-112 0V255.36L314.24 397.12A56 56 0 0 1 234.88 317.952l221.248-221.184 16.384-16.384A55.808 55.808 0 0 1 512.192 64z"></path>'},Zo={name:Ka,box:"95.628 190.849 169.872 132.891",content:'<path d="M 158.073 293.017 L 122.351 257.294 L 158.073 221.571 L 158.073 248.363 L 203.055 248.363 L 203.055 221.571 L 238.777 257.294 L 203.055 293.017 L 203.055 266.225 L 158.073 266.225 L 158.073 293.017 Z M 95.628 323.74 L 95.628 190.849 L 113.489 190.849 L 113.489 323.74 L 95.628 323.74 Z M 247.639 323.74 L 247.639 190.849 L 265.5 190.849 L 265.5 323.74 L 247.639 323.74 Z" />'},Yo={name:uo,box:"64 64 896 896",content:'<path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path><path d="M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"></path>'},Xo={name:ho,box:"64 64 896 896",content:'<path d="M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"></path>'},Uo={name:Ia,box:"-50 0 1150 1100",content:'<path d="M1035.498324 624.689133a60.590605 60.590605 0 0 0-63.620135 60.590604v181.771814a28.477584 28.477584 0 0 1-28.477584 28.477584h-787.67786a28.477584 28.477584 0 0 1-28.477584-28.477584v-181.771814a63.620135 63.620135 0 0 0-127.240269 0v181.771814a155.717854 155.717854 0 0 0 158.141478 156.929666h787.677859a155.717854 155.717854 0 0 0 155.717854-155.717854v-181.771813a60.590605 60.590605 0 0 0-66.043759-61.802417z"></path>\n        <path d="M209.042477 127.24027h173.28913A105.427652 105.427652 0 0 1 487.153352 232.062015v264.175036L360.518989 384.144433a60.590605 60.590605 0 0 0-79.979598 90.885907l193.889934 172.077317a116.939867 116.939867 0 0 0 155.111948 0l192.072217-172.077317a60.590605 60.590605 0 0 0-81.191411-90.280001L614.393622 501.0843V232.062015A232.667921 232.667921 0 0 0 382.331607 0H209.042477a63.620135 63.620135 0 0 0 0 127.24027z"></path>'},Go={name:Xa,box:"64 64 896 896",content:'<path d="M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"></path>'},qo={name:mo,box:"64 64 896 896",content:'<path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path><path d="M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"></path>'},Ko={name:yo,box:"0 0 323.83 237.259",content:'<path d="M 0 133.403 L 0 103.56 C 6.566 102.96 11.64 102.66 14.625 100.57 C 17.609 99.68 20.293 96.7 22.68 93.41 C 25.067 89.83 26.559 85.95 27.754 80.28 C 28.352 76.4 29.246 69.84 29.246 60.29 C 29.246 44.17 29.844 33.13 31.633 26.56 C 33.126 20.59 36.11 14.92 39.692 11.34 C 43.571 7.76 49.84 4.78 57.301 2.39 C 62.372 1.49 70.43 0 82.07 0 L 89.233 0 L 89.233 29.25 C 79.684 29.25 73.117 29.84 70.731 31.34 C 68.344 32.23 66.254 33.73 64.164 36.41 C 62.672 38.5 62.075 42.08 62.075 46.86 C 62.075 51.93 61.477 62.08 60.582 76.1 C 59.985 84.76 59.09 91.32 57.598 95.8 C 55.508 100.87 53.122 104.75 50.437 108.33 C 48.047 111.32 43.274 114.9 37.902 118.48 C 42.973 121.46 47.453 124.45 50.437 128.031 C 53.419 131.612 56.106 136.686 57.898 141.461 C 59.985 147.131 60.88 153.995 60.88 162.948 C 61.477 176.378 61.477 185.033 61.477 189.211 C 61.477 194.881 62.075 198.164 63.567 200.85 C 65.059 203.237 67.446 204.431 70.133 205.923 C 72.52 206.819 79.086 208.012 88.636 208.012 L 88.636 237.259 L 81.176 237.259 C 69.536 237.259 59.985 236.663 54.614 234.872 C 48.047 232.783 42.973 229.798 38.5 225.919 C 34.023 222.039 31.336 216.966 29.547 210.698 C 28.052 204.73 27.457 195.18 27.457 182.048 C 27.457 166.828 26.86 156.98 25.367 152.801 C 23.278 146.236 20.293 141.162 16.414 138.178 C 14.027 135.194 7.758 133.403 0 133.403 Z M 323.83 133.403 C 317.264 134 312.191 134.298 309.207 136.387 C 306.222 137.283 303.536 140.267 301.149 143.55 C 298.761 147.131 297.269 151.011 296.075 156.681 C 295.478 160.561 294.583 167.126 294.583 176.676 C 294.583 192.792 293.986 203.834 292.196 210.4 C 290.703 216.966 287.719 222.039 284.138 225.62 C 280.258 229.202 273.991 232.186 266.53 234.573 C 261.456 235.469 253.399 236.961 241.76 236.961 L 234.597 236.961 L 234.597 207.714 C 244.147 207.714 249.817 207.117 253.1 205.625 C 256.085 204.73 258.174 202.641 259.666 200.552 C 261.158 198.462 261.755 194.881 261.755 190.106 C 261.755 185.331 262.352 175.483 263.247 161.456 C 263.844 152.801 265.336 145.937 267.127 141.461 C 269.216 135.79 271.603 131.911 274.588 128.33 C 277.572 124.748 281.75 121.76 286.525 118.78 C 278.467 113.71 273.394 110.12 271.006 106.84 C 267.127 101.17 263.844 94.31 262.949 86.85 C 261.456 80.88 260.86 68.34 260.86 49.24 C 260.86 43.27 260.263 39.1 258.771 36.71 C 257.278 34.62 255.786 33.13 253.1 31.64 C 250.713 30.74 244.147 29.55 234 29.55 L 234 0.3 L 241.163 0.3 C 252.802 0.3 262.352 0.9 267.724 2.69 C 274.289 4.78 279.363 7.76 283.839 11.64 C 288.316 15.52 291.002 20.59 292.792 26.86 C 294.285 32.83 295.18 42.38 295.18 55.51 C 295.18 70.73 295.777 80.28 297.269 84.76 C 299.358 91.32 302.342 96.4 306.222 98.19 C 310.102 101.17 316.369 102.07 323.83 103.26 L 323.83 133.403 Z M 140.206 108.868 C 147.727 129.921 130.204 147.214 109.112 139.392 C 104.859 137.822 100.095 133.027 98.523 128.81 C 90.703 107.718 107.99 90.233 129.043 97.71 C 133.571 99.322 138.559 104.307 140.206 108.868 Z M 225.294 108.447 C 233.202 129.691 215.603 147.254 194.35 139.392 C 190.096 137.822 185.344 133.027 183.772 128.81 C 175.865 107.566 193.476 90.004 214.717 97.865 C 218.97 99.436 223.723 104.19 225.294 108.447 Z" />'},Qo={name:io,box:"0 0 1024 1024",content:'<path d="M546.8 601l-0.6 116c97.8-16.4 172.6-102 172.6-205 0-31.8-7.2-62-20-89-5.6-11.6-12-22.6-19.6-33l94.2-87c2.2 2.6 4.2 5.4 6.2 8 41.8 56 66.4 125.6 66.4 201 0 2.4 0 5 0 7.4-3 143-95.2 264-222.8 309.2-24.6 8.6-50.4 14.6-77 17.4l-0.2 114-152.4-134L341.2 780l88.8-77.4L546.8 601z" p-id="2358"></path><path d="M178 504.6c3.2-144.2 96.6-266 225.8-310.4 23.4-8 48-13.6 73.6-16.2l0.2-114 152.2 133.8 52.4 46.2-88.6 77.2-116.8 101.8 0.4-115.8c-97.6 16.6-172 102.2-172 204.8 0 32 7.2 62.2 20.2 89.4 5.4 11.6 12 22.4 19.4 32.6l-94 87.2c-2.6-3.2-5.2-6.6-7.6-10C202.2 655.4 178 586.6 178 512 178 509.6 178 507 178 504.6z"></path>'},Wo={name:qa,box:"0 0 1024 1024",content:'<path d="M64 576h896V448H64z"></path>'},Jo={name:so,box:"64 64 896 896",content:'<path d="M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"></path><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path>'},er={name:po,box:"0 0 20 20",content:'<path d="M4,8 C5.1045695,8 6,8.8954305 6,10 C6,11.1045695 5.1045695,12 4,12 C2.8954305,12 2,11.1045695 2,10 C2,8.8954305 2.8954305,8 4,8 Z M10,8 C11.1045695,8 12,8.8954305 12,10 C12,11.1045695 11.1045695,12 10,12 C8.8954305,12 8,11.1045695 8,10 C8,8.8954305 8.8954305,8 10,8 Z M16,8 C17.1045695,8 18,8.8954305 18,10 C18,11.1045695 17.1045695,12 16,12 C14.8954305,12 14,11.1045695 14,10 C14,8.8954305 14.8954305,8 16,8 Z" />'},tr={name:no,box:"64 64 896 896",content:'<path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"></path>'},nr={name:Ga,box:"0 0 1024 1024",content:'<path d="M576 64H448v384H64v128h384v384h128V576h384V448H576z"></path>'},ar={name:ro,box:"64 64 896 896",content:'<path d="M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"></path><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path>'},or={name:ao,box:"45.809 204.634 139.187 139.187",content:'<g><rect x="45.809" y="204.634" width="139.187" height="139.187" style="fill: rgba(0, 0, 0, 0);" /><path d="M 129.783 227.155 C 129.783 233.207 126.045 238.386 120.751 240.508 L 120.751 257.522 C 139.903 260.131 154.662 276.552 154.662 296.421 C 154.662 318.103 137.084 335.68 115.402 335.68 C 93.72 335.68 76.143 318.103 76.143 296.421 C 76.143 276.541 90.918 260.113 110.086 257.518 L 110.086 240.52 C 104.776 238.406 101.023 233.219 101.023 227.155 C 101.023 219.213 107.461 212.775 115.403 212.775 C 123.345 212.775 129.783 219.213 129.783 227.155 Z M 110.692 291.463 L 93.373 291.463 L 93.373 301.381 L 110.692 301.381 L 110.692 318.395 L 120.109 318.395 L 120.109 301.381 L 137.431 301.381 L 137.431 291.463 L 120.109 291.463 L 120.109 274.447 L 110.692 274.447 L 110.692 291.463 Z" /></g>'},rr={name:oo,box:"223.545 204.634 139.187 139.187",content:'<g><rect x="223.545" y="204.634" width="139.187" height="139.187" style="fill: rgba(0, 0, 0, 0);"/><path d="M 271.538 232.479 L 271.538 286.999 C 271.538 289.299 273.39 291.149 275.686 291.149 L 283.889 291.149 C 286.397 271.885 302.87 257.008 322.818 257.008 C 344.5 257.008 362.077 274.585 362.077 296.268 C 362.077 317.95 344.5 335.527 322.818 335.527 C 303.019 335.527 286.644 320.872 283.947 301.819 L 275.686 301.819 C 267.509 301.819 260.872 295.179 260.872 286.999 L 260.872 232.479 L 251.606 232.479 C 249.502 237.699 244.391 241.369 238.421 241.369 C 230.569 241.369 224.199 234.999 224.199 227.149 C 224.199 219.299 230.569 212.929 238.421 212.929 C 244.218 212.929 249.435 216.439 251.606 221.819 L 321.492 221.819 C 322.144 221.819 322.677 222.349 322.677 222.999 L 322.677 231.299 C 322.677 231.949 322.144 232.479 321.492 232.479 L 271.538 232.479 Z M 318.119 291.32 L 300.839 291.32 L 300.839 301.214 L 318.119 301.214 L 318.119 318.191 L 327.514 318.191 L 327.514 301.214 L 344.796 301.214 L 344.796 291.32 L 327.514 291.32 L 327.514 274.344 L 318.119 274.344 L 318.119 291.32 Z" /></g>'},sr={name:ja,box:"0 0 1024 1024",content:'<path d="M0.00032 576a510.72 510.72 0 0 0 173.344 384l84.672-96A383.136 383.136 0 0 1 128.00032 576C128.00032 363.936 299.93632 192 512.00032 192c106.048 0 202.048 42.976 271.52 112.48L640.00032 448h384V64l-149.984 149.984A510.272 510.272 0 0 0 512.00032 64C229.21632 64 0.00032 293.216 0.00032 576z"></path>'},ir={name:Ja,box:"0 0 24 24",content:'<path d="M8 18.3915V5.60846L18.2264 12L8 18.3915ZM6 3.80421V20.1957C6 20.9812 6.86395 21.46 7.53 21.0437L20.6432 12.848C21.2699 12.4563 21.2699 11.5436 20.6432 11.152L7.53 2.95621C6.86395 2.53993 6 3.01878 6 3.80421Z"></path>'},lr={name:Ya,box:"64 64 896 896",content:'<path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"></path>'},cr={name:Va,box:"60 80 335 322",content:'<path d="M 385.053 296.328 L 313.542 387.029 C 311.615 389.173 308.295 390.767 305.465 390.938 L 274.753 390.938 C 272.284 390.588 269.428 388.856 268.549 387.027 C 267.67 385.199 268.092 381.895 269.336 379.764 L 325.993 307.912 L 76.849 307.912 C 75.2 307.758 73.035 306.946 71.981 305.893 C 70.926 304.841 70.111 302.675 69.956 301.023 L 69.956 275.607 C 70.111 273.955 70.926 271.789 71.981 270.737 C 73.035 269.684 75.2 268.872 76.849 268.718 L 371.631 268.718 C 378.347 269.06 384.517 273.221 386.995 278.325 C 389.473 283.43 388.922 290.853 385.054 296.328 Z M 388.728 175.637 L 388.728 201.053 C 388.574 202.703 387.761 204.868 386.708 205.921 C 385.655 206.974 383.49 207.788 381.84 207.942 L 87.01 207.942 C 80.316 207.598 74.157 203.436 71.686 198.332 C 69.216 193.228 69.767 185.808 73.636 180.333 L 145.145 89.629 C 147.073 87.488 150.391 85.894 153.222 85.723 L 183.933 85.723 C 186.402 86.073 189.258 87.805 190.137 89.634 C 191.016 91.462 190.593 94.766 189.35 96.897 L 132.693 168.749 L 381.84 168.749 C 383.49 168.903 385.655 169.716 386.708 170.769 C 387.761 171.822 388.574 173.987 388.728 175.637 Z" />'},dr={name:R.Any,box:"64 64 896 896",content:'<path d="M264 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm496 424c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496zm144 140H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-424H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"></path>'},ur={name:R.Array,box:"0 80 470 300",content:'<path d="M 146.307 239.485 L 159.609 198.424 C 190.259 209.219 212.525 218.568 226.405 226.472 C 222.742 191.579 220.814 167.579 220.621 154.471 L 262.55 154.471 C 261.971 173.555 259.754 197.46 255.899 226.183 C 275.755 216.159 298.502 206.905 324.141 198.424 L 337.442 239.485 C 312.96 247.581 288.96 252.978 265.442 255.677 C 277.201 265.895 293.778 284.112 315.177 310.328 L 280.478 334.907 C 269.296 319.678 256.091 298.955 240.863 272.738 C 226.597 299.919 214.067 320.642 203.272 334.907 L 169.151 310.328 C 191.513 282.761 207.513 264.544 217.152 255.677 C 192.283 250.857 168.669 245.46 146.307 239.485 Z M 23.162 402.827 L 23.162 89.135 L 118.114 89.135 L 118.114 112.291 L 71.481 112.291 L 71.481 379.67 L 118.114 379.67 L 118.114 402.827 L 23.162 402.827 Z M 460.588 402.159 L 365.636 402.159 L 365.636 379.002 L 412.268 379.002 L 412.268 111.623 L 365.636 111.623 L 365.636 88.467 L 460.588 88.467 L 460.588 402.159 Z" />'},hr={name:R.Bool,box:"0 -1 20 20",content:'<path d="M14.5,4.59302522 C17.5375661,4.59302522 20,7.0554591 20,10.0930252 C20,13.1305913 17.5375661,15.5930252 14.5,15.5930252 C12.6400269,15.5930252 10.9956939,14.6697601 10.0002965,13.2565253 C9.00430607,14.6697601 7.3599731,15.5930252 5.5,15.5930252 C2.46243388,15.5930252 0,13.1305913 0,10.0930252 C0,7.0554591 2.46243388,4.59302522 5.5,4.59302522 C7.3599731,4.59302522 9.00430607,5.51629032 9.99970353,6.92952513 C10.9956939,5.51629032 12.6400269,4.59302522 14.5,4.59302522 Z M5.5,6.59302522 C3.56700338,6.59302522 2,8.1600286 2,10.0930252 C2,12.0260218 3.56700338,13.5930252 5.5,13.5930252 C7.43299662,13.5930252 9,12.0260218 9,10.0930252 C9,8.1600286 7.43299662,6.59302522 5.5,6.59302522 Z M16.1099312,8.05749132 L13.8022389,10.4574913 L12.6483927,9.25749132 L11.8791619,10.0574913 L13.8022389,12.0574913 L16.8791619,8.85749132 L16.1099312,8.05749132 Z M6.66446609,8.05749132 L7.46446609,8.85749132 L6.26446609,10.0574913 L7.46446609,11.2574913 L6.66446609,12.0574913 L5.46446609,10.8574913 L4.26446609,12.0574913 L3.46446609,11.2574913 L4.66446609,10.0574913 L3.46446609,8.85749132 L4.26446609,8.05749132 L5.46446609,9.25749132 L6.66446609,8.05749132 Z" />'},mr={name:R.Date,box:"0 0 20 20",content:'<path d="M13,2 C13.5522847,2 14,2.44771525 14,3 L17,3 C18.1045695,3 19,3.8954305 19,5 L19,16 C19,17.1045695 18.1045695,18 17,18 L3,18 C1.8954305,18 1,17.1045695 1,16 L1,5 C1,3.8954305 1.8954305,3 3,3 L6,3 C6,2.44771525 6.44771525,2 7,2 C7.55228475,2 8,2.44771525 8,3 L12,3 C12,2.44771525 12.4477153,2 13,2 Z M17,9 L3,9 L3,16 L17,16 L17,9 Z M6,13 C6.55228475,13 7,13.4477153 7,14 C7,14.5522847 6.55228475,15 6,15 C5.44771525,15 5,14.5522847 5,14 C5,13.4477153 5.44771525,13 6,13 Z M10,13 C10.5522847,13 11,13.4477153 11,14 C11,14.5522847 10.5522847,15 10,15 C9.44771525,15 9,14.5522847 9,14 C9,13.4477153 9.44771525,13 10,13 Z M14,13 C14.5522847,13 15,13.4477153 15,14 C15,14.5522847 14.5522847,15 14,15 C13.4477153,15 13,14.5522847 13,14 C13,13.4477153 13.4477153,13 14,13 Z M6,10 C6.55228475,10 7,10.4477153 7,11 C7,11.5522847 6.55228475,12 6,12 C5.44771525,12 5,11.5522847 5,11 C5,10.4477153 5.44771525,10 6,10 Z M10,10 C10.5522847,10 11,10.4477153 11,11 C11,11.5522847 10.5522847,12 10,12 C9.44771525,12 9,11.5522847 9,11 C9,10.4477153 9.44771525,10 10,10 Z M14,10 C14.5522847,10 15,10.4477153 15,11 C15,11.5522847 14.5522847,12 14,12 C13.4477153,12 13,11.5522847 13,11 C13,10.4477153 13.4477153,10 14,10 Z M6,5 L3,5 L3,7 L17,7 L17,5 L14,5 C14,5.55228475 13.5522847,6 13,6 C12.4477153,6 12,5.55228475 12,5 L8,5 C8,5.55228475 7.55228475,6 7,6 C6.44771525,6 6,5.55228475 6,5 Z" />'},pr={name:R.DateTime,box:"0 0 20 20",content:'<path xmlns="http://www.w3.org/2000/svg" d="M13,2 C13.5522847,2 14,2.44771525 14,3 L17,3 C18.1045695,3 19,3.8954305 19,5 L19.0008411,9.6834702 C19.632174,10.6335237 20,11.7738067 20,13 C20,16.3137085 17.3137085,19 14,19 C12.7738067,19 11.6335237,18.632174 10.6834702,18.0008411 L3,18 C1.8954305,18 1,17.1045695 1,16 L1,5 C1,3.8954305 1.8954305,3 3,3 L6,3 C6,2.44771525 6.44771525,2 7,2 C7.55228475,2 8,2.44771525 8,3 L12,3 C12,2.44771525 12.4477153,2 13,2 Z M14,9 C11.790861,9 10,10.790861 10,13 C10,15.209139 11.790861,17 14,17 C16.209139,17 18,15.209139 18,13 C18,10.790861 16.209139,9 14,9 Z M9.52766929,9.0001315 L3,9 L3,16 L8.80325037,16.000963 C8.29239547,15.1182253 8,14.093259 8,13 C8,11.5593949 8.50770848,10.2373715 9.35395605,9.20309916 L9.52766929,9.0001315 Z M14,10 C14.5522847,10 15,10.4477153 15,11 L15,12.47 L16.470203,13.3745556 C16.8961053,13.6363239 17.058206,14.1671476 16.8676427,14.616159 L16.7990381,14.75 C16.551053,15.1795228 16.0249969,15.348408 15.5795487,15.1605478 L15.4470893,15.0924003 L13.5389825,13.9196388 C13.4794306,13.883037 13.4250363,13.8411748 13.3760426,13.7950116 L13.3066327,13.7226607 C13.1182557,13.5400593 13,13.2838397 13,13 L13,11 C13,10.4477153 13.4477153,10 14,10 Z M6,5 L3,5 L3,7 L14,7 C15.093259,7 16.1182253,7.29239547 17.000963,7.80325037 L17,5 L14,5 C14,5.55228475 13.5522847,6 13,6 C12.4477153,6 12,5.55228475 12,5 L8,5 C8,5.55228475 7.55228475,6 7,6 C6.44771525,6 6,5.55228475 6,5 Z" />'},gr={name:R.File,box:"0 0 174.6638 215.24",content:'<path d="M 164.446 215.226 L 10.201 215.226 C 4.561 215.36 -0.069 210.78 0.001 205.133 L 0.001 10.104 C 0.001 4.381 4.411 0.01 10.201 0.01 L 95.497 0.01 C 96.479 -0.034 97.46 0.067 98.406 0.313 C 100.891 0.915 102.972 2.378 104.331 4.39 L 171.589 70.665 C 173.417 72.474 174.426 74.756 174.617 77.056 C 174.648 77.389 174.664 77.727 174.664 78.07 L 174.664 205.146 C 174.664 210.524 170.252 215.24 164.46 215.24 L 164.446 215.226 Z M 106.041 67.976 L 140.004 67.976 L 106.041 34.351 L 106.041 67.976 Z M 20.391 195.053 L 154.284 195.053 L 154.284 88.15 L 95.821 88.15 C 90.181 88.275 85.561 83.698 85.631 78.056 L 85.631 20.182 L 20.381 20.182 L 20.381 195.039 L 20.391 195.053 Z" />'},fr={name:R.Map,box:"0 0 500 500",content:'<path d="M 0.311 248.111 L 72.314 406.373 L 127.585 406.373 L 55.239 248.111 L 127.585 93.626 L 72.314 93.626 L 0.311 248.111 Z" />\n  <path d="M 427.684 93.626 L 372.413 93.626 L 444.76 248.111 L 372.413 406.373 L 427.684 406.373 L 499.688 248.111 L 427.684 93.626 Z" />\n  <path d="M 156.34 243.402 L 169.642 202.341 C 200.292 213.136 222.558 222.485 236.438 230.389 C 232.775 195.496 230.847 171.496 230.654 158.388 L 272.583 158.388 C 272.004 177.472 269.787 201.377 265.932 230.1 C 285.788 220.076 308.535 210.822 334.174 202.341 L 347.475 243.402 C 322.993 251.498 298.993 256.895 275.475 259.594 C 287.234 269.812 303.811 288.029 325.21 314.245 L 290.511 338.824 C 279.329 323.595 266.124 302.872 250.896 276.655 C 236.63 303.836 224.1 324.559 213.305 338.824 L 179.184 314.245 C 201.546 286.678 217.546 268.461 227.185 259.594 C 202.316 254.774 178.702 249.377 156.34 243.402 Z" />'},yr={name:R.Number,box:"0 0 57.543 42.536",content:'<g><path d="M 1.433 28.672 L 1.433 23.755 L 6.533 23.755 L 6.533 7.224 L 2.111 7.224 L 2.111 3.063 C 4.693 2.495 6.371 1.739 8.05 0.529 L 12.278 0.529 L 12.278 23.755 L 16.603 23.755 L 16.603 28.672 L 1.433 28.672 Z M 19.928 28.672 L 19.928 24.815 C 25.931 18.422 29.966 13.314 29.966 9.229 C 29.966 6.657 28.739 5.258 26.835 5.258 C 25.189 5.258 23.898 6.543 22.768 7.981 L 19.637 4.35 C 21.993 1.437 24.188 0 27.61 0 C 32.258 0 35.485 3.48 35.485 8.851 C 35.485 13.693 31.935 19.027 28.255 23.377 C 29.412 23.377 35.518 23.377 36.583 23.377 L 36.583 28.672 L 19.928 28.672 Z M 39.004 25.269 L 41.65 21.031 C 43.103 22.657 44.781 23.755 46.653 23.755 C 48.88 23.755 50.333 22.657 50.333 20.54 C 50.333 18.119 49.235 16.681 44.2 16.681 L 44.2 11.953 C 48.299 11.953 49.59 10.477 49.59 8.246 C 49.59 6.316 48.622 5.258 46.847 5.258 C 45.233 5.258 44.006 6.128 42.554 7.603 L 39.649 3.48 C 41.876 1.285 44.265 0 47.105 0 C 52.076 0 55.336 2.723 55.336 7.754 C 55.336 10.553 54.045 12.748 51.462 13.958 L 51.462 14.147 C 54.141 15.093 56.11 17.362 56.11 20.994 C 56.11 26.252 52.011 29.202 47.234 29.202 C 43.425 29.202 40.746 27.651 39.004 25.269 Z M 0 36.573 L 57.543 36.573 L 57.543 42.536 L 0 42.536 L 0 36.573 Z" /></g>'},vr={name:R.Object,box:"20 0 1024 1024",content:'<path d="M 414.165 463.242 C 345.265 438.742 288.765 495.942 314.365 564.942 C 319.465 578.842 334.965 594.442 348.965 599.642 C 417.865 625.242 475.265 568.642 450.665 499.742 C 445.165 484.842 428.965 468.542 414.165 463.242" />\n  <path d="M 795.283 99.791 L 743.883 99.791 C 730.478 99.523 719.402 109.76 719.183 122.618 L 719.183 151.103 C 719.402 163.961 730.478 174.198 743.883 173.93 L 777.483 173.93 C 814.983 173.93 832.683 193.112 832.683 233.299 L 832.683 412.461 C 832.683 455.046 848.983 487.368 880.783 508.852 C 894.367 517.607 894.625 536.688 881.283 545.778 C 849.183 568.03 832.883 599.584 832.883 641.018 L 832.883 820.948 C 832.883 859.312 815.083 879.453 777.583 879.453 L 743.983 879.453 C 730.578 879.186 719.502 889.423 719.283 902.28 L 719.283 930.766 C 719.501 943.662 730.64 953.914 744.083 953.593 L 795.283 953.593 C 838.683 953.593 872.283 939.878 895.983 914.365 C 917.683 890.483 928.483 857.682 928.483 817.399 L 928.483 645.622 C 928.483 619.15 934.383 599.872 946.183 588.075 C 957.083 576.566 974.683 569.564 999.183 566.207 C 1011.124 564.821 1020.171 555.202 1020.383 543.668 L 1020.383 509.907 C 1020.184 498.437 1011.245 488.842 999.383 487.368 C 974.883 483.724 957.283 476.434 946.283 465.5 C 934.483 452.744 928.583 433.562 928.583 407.954 L 928.583 237.04 C 928.583 195.894 917.783 162.996 896.083 139.306 C 872.283 112.739 838.683 99.887 795.283 99.791 Z" />\n  <path d="M 304.883 116.291 L 304.883 157.054 C 304.719 166.43 296.659 173.902 286.883 173.742 L 246.683 173.742 C 209.183 173.742 191.483 192.924 191.483 233.111 L 191.483 412.273 C 191.483 457.831 172.883 491.496 136.483 513.076 C 125.472 519.373 125.255 534.595 136.083 541.178 C 172.683 563.717 191.483 596.711 191.483 640.926 L 191.483 820.951 C 191.483 859.316 209.183 879.457 246.683 879.457 L 286.883 879.457 C 296.783 879.457 304.883 886.842 304.883 896.146 L 304.883 936.908 C 304.719 946.246 296.72 953.703 286.983 953.597 L 228.983 953.597 C 185.583 953.597 151.983 939.881 128.283 914.369 C 106.583 890.487 95.783 857.685 95.783 817.403 L 95.783 645.434 C 95.783 618.962 89.883 599.684 78.083 587.887 C 66.383 575.514 46.983 568.321 19.883 565.444 C 10.962 564.659 4.099 557.539 3.983 548.947 L 3.983 504.348 C 3.983 495.908 10.783 488.811 19.883 487.852 C 46.983 484.686 66.383 477.014 78.083 465.408 C 89.883 452.652 95.783 433.374 95.783 407.862 L 95.783 236.852 C 95.783 195.706 106.583 162.808 128.283 139.118 C 151.983 112.647 185.583 99.795 228.983 99.795 L 286.883 99.795 C 296.626 99.526 304.72 106.944 304.883 116.291" />\n  <path d="M 690.657 463.747 C 621.157 438.047 563.657 495.447 589.457 564.947 C 594.557 578.847 610.157 594.447 624.057 599.647 C 693.557 625.347 751.057 567.847 725.257 498.347 C 720.057 484.447 704.457 468.947 690.557 463.747" />'},br=[{name:R.String,box:"0 0 59.931 33.007",content:'<path d="M 5.434 32.408 L 6.718 25.097 L 13.288 25.097 L 14.572 32.408 L 20.186 32.408 L 13.288 0.599 L 6.898 0.599 L 0 32.408 L 5.434 32.408 Z M 12.273 19.197 L 7.734 19.197 L 8.211 16.503 C 8.779 13.339 9.376 9.62 9.914 6.285 L 10.033 6.285 C 10.63 9.535 11.198 13.339 11.795 16.503 L 12.273 19.197 Z M 30.906 32.408 C 35.743 32.408 39.595 29.501 39.595 23.002 C 39.595 18.77 37.893 16.375 35.654 15.52 L 35.654 15.349 C 37.445 14.365 38.55 11.288 38.55 8.466 C 38.55 2.352 34.877 0.599 30.279 0.599 L 22.515 0.599 L 22.515 32.408 L 30.906 32.408 Z M 30.07 13.212 L 27.86 13.212 L 27.86 6.414 L 30.07 6.414 C 32.309 6.414 33.354 7.354 33.354 9.62 C 33.354 11.8 32.339 13.212 30.07 13.212 Z M 30.518 26.55 L 27.86 26.55 L 27.86 18.855 L 30.518 18.855 C 33.116 18.855 34.4 19.881 34.4 22.489 C 34.4 25.225 33.086 26.55 30.518 26.55 Z M 52.675 33.007 C 55.571 33.007 58.05 31.425 59.931 28.304 L 57.124 23.515 C 56.079 25.14 54.645 26.423 52.884 26.423 C 49.748 26.423 47.718 22.746 47.718 16.418 C 47.718 10.219 50.077 6.542 52.943 6.542 C 54.526 6.542 55.69 7.568 56.795 9.021 L 59.602 4.147 C 58.079 1.924 55.75 0 52.854 0 C 47.21 0 42.253 6.072 42.253 16.674 C 42.253 27.449 47.031 33.007 52.675 33.007 Z"" />'},yr,hr,mr,{name:R.Time,box:"0 0 20 20",content:'<path d="M3.40035701171875,3.40035701171875Q0.66668701171875,6.13402701171875,0.66668701171875,10.00001701171875Q0.66668701171875,13.86598701171875,3.40035701171875,16.59968701171875Q6.13402701171875,19.33338701171875,10.00001701171875,19.33338701171875Q13.86598701171875,19.33338701171875,16.59968701171875,16.59968701171875Q19.33338701171875,13.86598701171875,19.33338701171875,10.00001701171875Q19.33338701171875,6.13402701171875,16.59968701171875,3.40035701171875Q13.86598701171875,0.66668701171875,10.00001701171875,0.66668701171875Q6.13402701171875,0.66668701171875,3.40035701171875,3.40035701171875ZM4.81456701171875,15.18548701171875Q2.66668701171875,13.03758701171875,2.66668701171875,10.00001701171875Q2.66668701171875,6.96245701171875,4.81456701171875,4.81456701171875Q6.96245701171875,2.66668701171875,10.00001701171875,2.66668701171875Q13.03758701171875,2.66668701171875,15.18548701171875,4.81456701171875Q17.33338701171875,6.96245701171875,17.33338701171875,10.00001701171875Q17.33338701171875,13.03758701171875,15.18548701171875,15.18548701171875Q13.03758701171875,17.33338701171875,10.00001701171875,17.33338701171875Q6.96244701171875,17.33338701171875,4.81456701171875,15.18548701171875Z" fill-rule="evenodd" />\n  <path d="M10.90349072265625,5.00046591815625L10.90308072265625,9.103731035156251L14.58337072265625,9.10372103515625Q14.67201072265625,9.10372103515625,14.75895072265625,9.12101103515625Q14.84589072265625,9.13831103515625,14.927790722656251,9.172231035156251Q15.009680722656249,9.20615103515625,15.083390722656251,9.25540103515625Q15.15709072265625,9.304651035156251,15.21977072265625,9.367331035156251Q15.28245072265625,9.43001103515625,15.331700722656251,9.50371103515625Q15.38094072265625,9.57741103515625,15.41486072265625,9.65931103515625Q15.44879072265625,9.74120103515625,15.466080722656251,9.82814103515625Q15.48337072265625,9.91508103515625,15.48337072265625,10.00372103515625Q15.48337072265625,10.09236103515625,15.466080722656251,10.17930103515625Q15.44879072265625,10.26624103515625,15.41486072265625,10.34814103515625Q15.38094072265625,10.43003103515625,15.331700722656251,10.50373103515625Q15.28245072265625,10.57744103515625,15.21977072265625,10.64012103515625Q15.15709072265625,10.70280103515625,15.083390722656251,10.75204103515625Q15.009680722656249,10.80129103515625,14.927790722656251,10.835211035156249Q14.84589072265625,10.86913103515625,14.75895072265625,10.88643103515625Q14.67202072265625,10.90372103515625,14.58337072265625,10.90372103515625L14.582450722656251,10.90372103515625L10.00299072265625,10.90373103515625Q9.82396972265625,10.90373103515625,9.65857572265625,10.83522103515625Q9.49318272265625,10.76671103515625,9.36659572265625,10.64012103515625Q9.24000772265625,10.513541035156251,9.17149972265625,10.34814103515625Q9.10299072265625,10.182751035156251,9.10299072265625,10.00373103515625L9.10349072265625,5.000061035155353L9.10349072265625,4.99997112195625Q9.10349972265625,4.91133453515625,9.12079872265625,4.82440303515625Q9.13809872265625,4.73747103515625,9.17202472265625,4.65558403515625Q9.205950722656251,4.57369703515625,9.25519872265625,4.5000010351562505Q9.30444772265625,4.42630603515625,9.36712672265625,4.36363303515625Q9.42980472265625,4.30096103515625,9.50350572265625,4.25172003515625Q9.57720572265625,4.20247903515625,9.65909672265625,4.16856103515625Q9.74098672265625,4.13464303515625,9.82792072265625,4.11735203515625Q9.91485402265625,4.10006103515625,10.00349062665625,4.10006103515625Q10.09213292265625,4.10006103515625,10.17907172265625,4.11735403515625Q10.26601072265625,4.13464803515625,10.34790572265625,4.16857003515625Q10.42980072265625,4.20249103515625,10.50350372265625,4.25173903515625Q10.57720672265625,4.30098503515625,10.63988672265625,4.3636650351562505Q10.70256572265625,4.42634503515625,10.75181272265625,4.50004803515625Q10.80105972265625,4.57375103515625,10.83498172265625,4.65564603515625Q10.86890372265625,4.73754103515625,10.88619772265625,4.82448003515625Q10.90349072265625,4.91141883515625,10.90349072265625,5.00006103515625L10.90349072265625,5.00015094835625L10.90349072265625,5.00046591815625Z" fill-rule="evenodd" />'},pr,vr,ur,fr,gr,dr,So,wo,Co,No,Ho,Fo,Uo,Mo,Io,Lo,ko,_o,zo,Oo,Ao,Do,Ro,cr,lr,Qo,nr,xo,jo,Zo,ir,{name:Ba,box:"0 0 1024 1024",content:'<path d="M512 64A510.272 510.272 0 0 0 149.984 213.984L0.032 64v384h384L240.512 304.48A382.784 382.784 0 0 1 512.032 192c212.064 0 384 171.936 384 384 0 114.688-50.304 217.632-130.016 288l84.672 96a510.72 510.72 0 0 0 173.344-384c0-282.784-229.216-512-512-512z"></path>'},sr,$o,To,bo,Eo,Vo,Bo,Go,Wo,Po,Yo,Xo,qo,er,or,rr,ar,tr,Jo,{name:go,box:"64 64 896 896",content:'<path d="M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"></path><path d="M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"></path>'},Ko,{name:fo,box:"0 0 1163 1024",content:'<path d="M631.490909 0l109.454546 22.763636L532.145455 1024l-109.454546-22.763636L631.490909 0m374.109091 512l-200.436364-204.218182V146.763636L1163.636364 512l-358.472728 364.654545V715.636364l200.436364-203.636364M0 512l358.472727-365.236364v161.018182L158.036364 512l200.436363 203.636364v161.018181L0 512z" p-id="8050"></path>'}].map(e=>`  <symbol viewBox="${e.box}" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" id="@baseflow-icon-${e.name}">${e.content}</symbol>`);br.unshift('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="0" height="0">'),br.push("</svg>");const Er=br.join("\n"),Nr=t.createContext("");const Cr=t.createContext({});const wr=Cr.Provider;function Sr(e){const n=t.useRef(e);n.current=t.useMemo(()=>e,[e]);const a=t.useRef(void 0);return a.current||(a.current=function(...e){return n.current.apply(this,e)}),a.current}var xr=t.memo(({value:e})=>React.createElement("div",null,e));var Rr=t.memo(({options:e,value:t,onChange:n,className:a})=>{const o=Sr(e=>{e!==t&&n?.(e)});return React.createElement("div",{className:sn.classNames("ͼbaseflow-LinkTab",a)},e.map(e=>React.createElement("span",{className:e.value===t?"on":"",key:e.value,onClick:()=>o(e.value)},e.label)))});var Mr=t.memo(function({payload:e,onClose:n}){const[a,o]=t.useState(!0);return t.useEffect(()=>{o(!1)},[]),React.createElement(React.Fragment,null,e.mask&&React.createElement("div",{className:"ͼbaseflow-Modal__mask",onClick:n}),React.createElement("div",{className:sn.classNames("ͼbaseflow-Modal__window",{enter:a})},e.content))});var _r=t.memo(({payload:e,onClose:n})=>{const a=t.useRef(void 0),o=t.useRef(void 0),r=t.useRef(0),s=Sr(()=>{e&&!r.current&&(r.current=setTimeout(()=>{n(),r.current=0},300))}),i=Sr(()=>{e&&(clearTimeout(r.current),r.current=0,n())}),l=Sr(()=>{r.current&&(clearTimeout(r.current),r.current=0)});return t.useEffect(()=>{o.current&&o.current.removeEventListener("mouseleave",s,!1);const t=e.target;return o.current=t,t&&(r.current&&(clearTimeout(r.current),r.current=0),function(e,t,n={}){const a=e.getBoundingClientRect(),o=t.getBoundingClientRect(),r={left:a.left,top:a.bottom+8},s=window.innerHeight-o.height;r.top>s&&(r.top=s);const i=window.innerWidth-o.width;r.left>i&&(r.left=i),Object.assign(t.style,{left:`${r.left}px`,top:`${r.top}px`,marginTop:n.top||void 0,marginLeft:n.left||void 0})}(t,a.current,e.offset),t.addEventListener("mouseleave",s,!1)),()=>{t.removeEventListener("mouseleave",s,!1)}},[s,e]),t.useEffect(()=>{const e=e=>{const t=e.target;a.current?.contains(t)||i()};return document.addEventListener("mousedown",e,!0),()=>{document.removeEventListener("mousedown",e,!0)}},[]),React.createElement("div",{className:sn.classNames("ͼbaseflow-Popup"),onMouseOver:l,onMouseLeave:s,ref:a},e.content)});var Ir=t.memo(({payload:e,onClose:n})=>{const a=t.useRef(void 0),o=t.useRef(void 0),r=t.useRef(0),s=Sr(()=>{e&&!r.current&&(r.current=setTimeout(()=>{n(),r.current=0},300))}),i=Sr(()=>{r.current&&(clearTimeout(r.current),r.current=0)});return t.useEffect(()=>{o.current&&o.current.removeEventListener("mouseleave",s,!1);const t=e.target;return o.current=t,t&&(r.current&&(clearTimeout(r.current),r.current=0),function(e,t){const n=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o={left:n.left,top:n.bottom+8},r=window.innerHeight-a.height;o.top>r&&(o.top=r);const s=window.innerWidth-a.width;o.left>s&&(o.left=s),Object.assign(t.style,{left:`${o.left}px`,top:`${o.top}px`})}(t,a.current),t.addEventListener("mouseleave",s,!1)),()=>{t.removeEventListener("mouseleave",s,!1)}},[s,e.target]),React.createElement("div",{className:sn.classNames("ͼbaseflow-Tooltip"),ref:a},React.createElement("div",{className:"content",onMouseEnter:i,onMouseLeave:s},e.content))});var kr=t.memo(()=>{const[e,n]=t.useState(null),[a,o]=t.useState(null),[r,s]=t.useState(null),i=Sr(()=>{"closeAble"===e?.mask&&n(null)}),l=t.useCallback(()=>{s(null)},[]),c=t.useCallback(()=>{o(null)},[]);return t.useMemo(()=>{Tr({popup:s,tooltip:o,modal:n})},[]),React.createElement("div",{style:{position:"fixed",zIndex:1001}},a?React.createElement(Ir,{payload:a,onClose:c}):null,e?React.createElement(Mr,{payload:e,onClose:i}):null,r?React.createElement(_r,{payload:r,onClose:l}):null,React.createElement("div",{style:{display:"none"},dangerouslySetInnerHTML:{__html:Er}}))});const Lr={Button:function({className:e,style:t,htmlType:n,children:a}){return React.createElement("button",{className:e,style:t,type:n},a)},Select:function({value:e,options:t,onChange:n,className:a,block:o}){return React.createElement("select",{className:sn.classNames(a,{"ͼbaseflow-sr-inputBlock":o}),value:e,onChange:e=>{n?.(e.target.value)}},t.map(e=>React.createElement("option",{key:e.value},e.label)))},Input:function({value:e,onChange:t,className:n,block:a,placeholder:o}){return React.createElement("input",{className:sn.classNames(n,{"ͼbaseflow-sr-inputBlock":a}),value:e,placeholder:o,onChange:e=>{t?.(e.target.value)}})},TextArea:function({className:e,style:t,rows:n,value:a,noTrim:o,block:r,onChange:s,onBlur:i}){return React.createElement("textarea",{className:sn.classNames(e,{"ͼbaseflow-sr-inputBlock":r}),style:t,value:a,rows:n,onBlur:i,onChange:e=>s?.(o?e.target.value:e.target.value.trim())})},Switch:function({value:e,onChange:t,className:n}){return React.createElement("input",{className:n,type:"checkbox",checked:!!e,onChange:e=>{t?.(e.target.checked)}})},DatePicker:function({value:e,onChange:t,className:n,placeholder:a}){return React.createElement("input",{className:n,type:"date",value:e,placeholder:a,onChange:e=>{t?.(e.target.value)}})},TimePicker:function({value:e,onChange:t,className:n,placeholder:a}){return React.createElement("input",{className:n,type:"time",value:e,placeholder:a,onChange:e=>{t?.(e.target.value)}})},Segmented:Rr,DescMD:xr,Spin:function(){return React.createElement("span",null,"Loading...")},popup:()=>{},modal:()=>{},tooltip:()=>{}};function Tr(e){Object.assign(Lr,e)}class Dr extends Jt{constructor(){super({variableClick:{},expressionClick:{},valueChanged:{}})}}const Ar={[I.Expression](e,t){if(e){if(t===I.Variable)return e;if(t===I.Template)return Zn.toJSTpl(e)}return e},[I.Template](e,t){if(e){if(t===I.Variable)return Zn.wrapVariable(e);if(t===I.Expression)return""}return e},[I.Variable](e,t){if(e){if(t===I.Expression)return"";if(t===I.Template)return Zn.extractVariable(e)?.[0]||""}return e}};function $r(e,t,n,a,o){let r,s;if(e=e.trim(),n.mode!==t?"simple"===t?(r=I.Variable,s=""):(r=I.Expression,s=Zn.getSingleVariable(e),s||(s=Zn.toJSTpl(e))):"simple"===t?e?(s=Zn.getSingleVariable(e),s?r=I.Variable:(r=I.Template,s=e)):(r=I.Variable,s=""):(r=I.Expression,s=e),a&&a!==r&&(s=Ar[a](s,r),r=a),"mapping"===o){if(r===I.Template&&/\D/.test(s)||r===I.Expression)s="",r=I.Variable;else if(r===I.Variable){const{fun:e}=$n.matchVariable(s);e&&e!==_n._number&&e!==_n._path&&(s="",r=I.Variable)}}else if("variable"===o)if(r===I.Template||r===I.Expression)s="",r=I.Variable;else if(r===I.Variable){const{fun:e}=$n.matchVariable(s);e&&e!==_n._path&&(s="",r=I.Variable)}return{source:r,text:s}}var Or=t.memo(e=>{const n=t.useRef(null),{onChange:a,onClickExpression:o,text:r}=e;return t.useEffect(()=>{const e=n.current;e.style.height="auto",e.style.height=`${e.scrollHeight}px`},[r]),React.createElement(React.Fragment,null,React.createElement("textarea",{ref:n,className:"codePre",rows:1,readOnly:!0,value:r,placeholder:`${ln.complexValue}...`,onClick:e=>o(r)}),React.createElement(vo,{button:!0,name:La,className:"codeClear",onClick:e=>{e.stopPropagation(),a("")}}))});function Pr(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;").replace(new RegExp(`(${Zn.REG})`,"g"),`<${Zn.VarTag} contentEditable="false" class="ͼbaseflow-TplEditor__var"><i class="act"></i>$2</${Zn.VarTag}>`)}function zr(e,t){const n=window.getSelection();if(n){n.removeAllRanges();const{args:a}=e;if(a[0].parentNode&&a[2].parentNode){const e=document.createRange();e.setStart(a[0],a[1]),e.setEnd(a[2],a[3]),e.deleteContents(),e.insertNode(t),e.setStartAfter(t),e.collapse(!0),n.addRange(e)}}}const Vr={valueToHtml:Pr,htmlToValue:function e(t){let n="",a=Array.from(t.childNodes);return a[a.length-1]&&"BR"===a[a.length-1].nodeName&&a.length>1&&(a=a.splice(0,a.length-1)),a.forEach(t=>{if("#text"===t.nodeName)n+=t.nodeValue;else if("BR"===t.nodeName)n+="\n";else if("P"===t.nodeName)n+=`\n${e(t)}`;else if(t.nodeName===Zn.VarTag)n+=Zn.wrapVariable(t.textContent);else if("DIV"===t.nodeName){const a=Array.from(t.childNodes);1===a.length&&"BR"===a[0].nodeName||t.previousSibling&&"BR"===t.previousSibling.nodeName?n+=e(t):n+=`\n${e(t)}`}else n+=e(t)}),n.replace(/\u00A0/g," ").trim()},onKeyDown:function(e){if("Enter"===e.key){const t=window.getSelection();if(t&&t.rangeCount){const n=t.getRangeAt(0),a=document.createElement("br");zr({args:[n.startContainer,n.startOffset,n.endContainer,n.endOffset]},a),e.preventDefault()}}},insertVariable:function(e,t){const n=document.createElement(Zn.VarTag);n.contentEditable="false",n.className="ͼbaseflow-TplEditor__var",n.innerHTML=`<i class="act"></i>${t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s/g,"&nbsp;")}`,zr(e,n)},onPaste:function(e){e.stopPropagation(),e.preventDefault();const t=e.clipboardData?.getData("text/plain");if(t){const e=Pr(t),n=window.getSelection();if(n&&n.rangeCount){n.getRangeAt(0).deleteContents()}document.execCommand("insertHTML",!1,e)}}};var Br=t.memo(({path:e,args:n,onChange:a})=>{const o=t.useRef(null),r=t.useMemo(()=>{const t=e.split("[0]");if(1===t.length)return React.createElement("div",{className:"ͼbaseflow-TplEditor__Path"},e);const a=t.length-1,o=[];return t.forEach((e,t)=>{o.push(React.createElement("span",{key:`s${t}`},e)),t<a&&o.push(React.createElement("span",{key:`i${t}`},React.createElement("input",{defaultValue:n[t]?.replace(/^'/,"").replace(/'$/,"").replace(/\\'/g,"'")||"0"})))}),o},[e,n]),s=t.useCallback(()=>Lr.popup(null),[]),i=Sr(()=>{const e=o.current.getElementsByTagName("input"),t=Array.from(e).map(e=>e.value.trim()||"0").map(e=>/\D/.test(e)?`'${e.replace(/'/g,"\\'")}'`:e);a(t)});return React.createElement("div",{className:"ͼbaseflow-TplEditor__Path",ref:o},r,React.createElement("div",{className:"con"},React.createElement(Lr.Button,{size:"small",onClick:s},ln.ButtonCancel),React.createElement(Lr.Button,{size:"small",type:"primary",onClick:i},ln.ButtonSubmit)))});var jr=t.memo(({tag:e,target:n,sourceType:a,onSubmit:o})=>{const{text:r,fun:s,variable:i,args:l,isAssert:c}=t.useMemo(()=>$n.matchVariable(e.textContent||""),[e.textContent]),d=Sr(()=>{const t=i.endsWith("!")?i.slice(0,-1):`${i}!`;e.childNodes[1].textContent=r.replace(i,t),Lr.popup(null),o()}),u=Sr(t=>{e.childNodes[1].textContent=t.some(e=>"0"!==e)?`${_n._path}(${i},${t.join(",")})`:i,Lr.popup(null),o()}),h=Sr(t=>{const a=e.childNodes[1];t===_n._path?Lr.popup({content:React.createElement(Br,{path:i,args:l,onChange:u}),target:n}):(a.textContent=s===t?i:`${t}(${i})`,Lr.popup(null),o())});return React.createElement("div",{className:"ͼbaseflow-TplEditor__Menu"},"variable"!==a&&React.createElement("div",{className:"assert"},React.createElement(Lr.Switch,{size:"small",value:c,onChange:d}),React.createElement("label",null,ln.nullAssert)),React.createElement("div",{className:"funs"},React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._path,disabled:!i.includes("[0]")}),onClick:()=>i.includes("[0]")&&h(_n._path)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.setPath),React.createElement("label",null)),"variable"!==a&&React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._number}),onClick:()=>h(_n._number)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.convertTo),React.createElement("label",null,"(Number)")),!a&&React.createElement(React.Fragment,null,React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._string}),onClick:()=>h(_n._string)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.convertTo),React.createElement("label",null,"(String)")),React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._boolean}),onClick:()=>h(_n._boolean)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.convertTo),React.createElement("label",null,"(Boolean)")),React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._date}),onClick:()=>h(_n._date)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.convertTo),React.createElement("label",null,"(Date)")),React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._time}),onClick:()=>h(_n._time)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.convertTo),React.createElement("label",null,"(Time)")),React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._datetime}),onClick:()=>h(_n._datetime)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.convertTo),React.createElement("label",null,"(DateTime)")),React.createElement("div",{className:sn.classNames("ͼbaseflow-TplEditor__Fun",{on:s===_n._any}),onClick:()=>h(_n._any)},React.createElement(vo,{name:uo}),React.createElement("span",null,ln.convertTo),React.createElement("label",null,"(Any)")))))});function Fr(e,t){return Array.prototype.indexOf.call(e,t)}const Hr=t.forwardRef(({value:e="",onChange:n,onBlur:a,onFocus:o,onClickVariable:r,placeholder:s,sourceType:i},l)=>{const c=t.useRef(null),d=t.useRef({value:"",html:"",currentHtml:"",currentEmpty:!0}),u=t.useRef(null),[h,m]=t.useState(0);t.useMemo(()=>{Object.assign(d.current,{value:e,html:Vr.valueToHtml(e),currentEmpty:!e})},[e]);const p=Sr(()=>{const e=!c.current.textContent;e!==d.current.currentEmpty&&(d.current.currentEmpty=e,m(h+1))}),g=Sr(()=>{const t=Vr.htmlToValue(c.current);e!==t&&(d.current.currentHtml=c.current.innerHTML,d.current.currentEmpty=!e,c.current.innerHTML=d.current.html,m(h+1),n?.(t))}),f=Sr(e=>{a?.(e),g()}),y=Sr(e=>{if("I"===e.target.nodeName){const t=e.target.parentNode,n=React.createElement(jr,{sourceType:i,tag:t,target:e.target,onSubmit:g});Lr.popup({content:n,target:e.target}),e.stopPropagation()}let{variable:t}=$n.matchVariable(e.target.nodeName===Zn.VarTag?e.target.textContent:"");t=t.replace(/!$/,""),t&&r?.(t)}),v=Sr(e=>{if(!u.current){const e=c.current.childNodes;u.current={start:{index:-1,offset:e.length},end:{index:-1,offset:e.length}}}const{start:t,end:n}=u.current,a=c.current.childNodes;try{Vr.insertVariable({args:[a[t.index]||c.current,t.offset,a[n.index]||c.current,n.offset]},e)}catch(e){u.current=null}setTimeout(g)}),b=Sr(()=>{const e=window.getSelection();if(e?.rangeCount){const t=e.getRangeAt(0),{startContainer:n,endContainer:a,startOffset:o,endOffset:r}=t;if(c.current.contains(n)&&c.current.contains(a)&&n.parentNode?.nodeName!==Zn.VarTag&&a.parentNode?.nodeName!==Zn.VarTag){const e=c.current.childNodes;return void(u.current={start:{index:Fr(e,n),offset:o},end:{index:Fr(e,a),offset:r}})}}u.current=null});return t.useImperativeHandle(l,()=>({insertVariable:v}),[v]),t.useEffect(()=>{if(c.current.innerHTML=d.current.html,c.current.innerHTML!==d.current.currentHtml&&(u.current=null),document.activeElement===c.current&&u.current){const{start:e,end:t}=u.current,n=c.current.childNodes,a=[n[e.index]||c.current,e.offset,n[t.index]||c.current,t.offset],o=window.getSelection();if(o){o.removeAllRanges();try{const e=document.createRange();e.setStart(a[0],a[1]),e.setEnd(a[2],a[3]),e.collapse(!0),o.addRange(e)}catch(e){u.current=null}}}},[e]),React.createElement("div",{className:"ͼbaseflow-TplEditor"},React.createElement("div",{ref:c,className:"input",contentEditable:!0,onKeyDown:Vr.onKeyDown,onInput:p,onBlur:f,onFocus:o,onPaste:Vr.onPaste,onSelect:b,onClick:y}),d.current.currentEmpty?React.createElement("div",{className:"placeholder"},s||ln.requiredPrompt):null)});var Zr=t.memo(Hr);var Yr=t.memo(({value:e,onChange:n,options:a})=>{const o=t.useMemo(()=>{if(e)try{return JSON.parse(e)}catch(e){console.error(e)}},[e]),r=Sr(e=>{n?.(e?.length?JSON.stringify(e):"")});return React.createElement(Lr.Select,{multiple:!0,valueNotBeEmpty:!0,variant:"borderless",block:!0,className:"nativeInput",placeholder:ln.selectPrompt,value:o,onChange:r,options:a})});const Xr=[{value:"true",label:"true"},{value:"false",label:"false"}];function Ur(e){const t=new Date(e);return Number.isNaN(t.getTime())}const Gr={[R.Bool]:(e,t)=>e&&"true"!==e&&"false"!==e?null:React.createElement(Lr.Select,{valueNotBeEmpty:!0,variant:"borderless",block:!0,className:"nativeInput",placeholder:ln.selectPrompt,options:Xr,...t}),[R.Date]:(e,t)=>e&&Ur(e)?null:React.createElement(Lr.DatePicker,{variant:"borderless",block:!0,className:"nativeInput",placeholder:ln.selectPrompt,...t}),[R.Time]:(e,t)=>e&&function(e){const t=new Date(`1979-01-01 ${e}`);return Number.isNaN(t.getTime())}(e)?null:React.createElement(Lr.TimePicker,{variant:"borderless",block:!0,className:"nativeInput",placeholder:ln.selectPrompt,...t}),[R.DateTime]:(e,t)=>e&&Ur(e)?null:React.createElement(Lr.DatePicker,{variant:"borderless",block:!0,showTime:!0,className:"nativeInput",placeholder:ln.selectPrompt,...t}),[R.String]:(e,t)=>t?(t=t.map(e=>e.label?e:{...e,label:e.value}),React.createElement(Lr.Select,{valueNotBeEmpty:!0,variant:"borderless",block:!0,className:"nativeInput",placeholder:ln.selectPrompt,options:t})):null,[R.Array]:(e,t)=>t?(t=t.map(e=>e.label?e:{...e,label:e.value}),React.createElement(Yr,{options:t})):null};const qr=t.forwardRef((e,n)=>{const{value:a,onChange:o,onClickVariable:r,dataType:s,nativeRenderOptions:i,placeholder:l,sourceType:c}=e,[d,u]=t.useState(!0),h=e.nativeRender||function(e,t){return e===R.String||e===R.Number?t?Gr[R.String]:void 0:e===R.Array?t?Gr[R.Array]:void 0:Gr[e]}(s,i),m=t.useRef(null),p=t.useMemo(()=>{const e=h?h(a,i):null;return e?t.cloneElement(e,{value:a,onChange:o}):null},[h,o,i,a]),g=Sr(e=>{e.stopPropagation(),u(!d),d||p||o("")});t.useMemo(()=>{u(!a||Boolean(p))},[p,a]);const f=Sr(e=>{m.current?m.current.insertVariable(e):o(Zn.wrapVariable(e))});return t.useImperativeHandle(n,()=>({insertVariable:f}),[f]),React.createElement(React.Fragment,null,d&&p?p:React.createElement(Zr,{ref:m,value:a,onChange:o,onClickVariable:r,placeholder:l,sourceType:c}),React.createElement("div",{className:"ͼbaseflow-SuperInput__rightBar"},React.createElement(vo,{name:La,onClick:e=>{e.stopPropagation(),o("")}}),h&&React.createElement(vo,{name:Va,onClick:g,onMouseEnter:e=>Lr.tooltip({content:"选取 / 输入",target:e.target})})))});var Kr=t.memo(qr);const Qr=t.forwardRef((e,n)=>{const a=t.useContext(Cr),[o]=t.useState(oa.createUID()),r=t.useRef(null),s=t.useRef(""),{style:i,variant:l,nativeRender:c,optional:d,nativeRenderOptions:u,onChange:h,sourceType:m,error:p,hideError:g,dataTypeEditable:f,context:y="",runtime:v="expression",dataType:b=R.String}=e,E=e.variableFilter,N="script"===v?I.Expression:e.dataSource,C="mapping"===m?e.placeholder||ln.loopContextPrompt:e.placeholder,w="mapping"===m||e.hideIcon,[S,x]=t.useState(!1),[M]=t.useState(new Dr),[k,L]=t.useState(""),T=Sr(e=>{k!==e&&L(e)}),D=t.useMemo(()=>{if(e.height)return{minHeight:e.height}},[e.height]),A=t.useMemo(()=>sn.classNames("ͼbaseflow-SuperInput",e.className,l,{active:S,hideIcon:w,hasError:!g&&(p||k)}),[e.className,w,p,k,g,l,S]),$=t.useRef(void 0);t.useMemo(()=>{$.current=b},[b]);const O=t.useMemo(()=>function(e,t){const n=t||e?.source||I.Variable;let a=e?.text||"",o="";return e?.text?(t&&e.source!==t&&(a=Ar[t](e.text,e.source)),o=n===I.Variable&&a?Zn.wrapVariable(a):a):o="",{source:n,text:a,mode:n===I.Expression?"complex":"simple",code:o}}(e.value,N),[e.value,N]),P=Sr(t=>{if(O.mode!==t){const{source:n,text:a}=$r(O.code,t,O,N,m);if(n!==e.value?.source||a!==e.value?.text){const e={type:b,optional:d,source:n,text:a};h?.(e)}}}),z=Sr(t=>{if(O.code!==t){const{source:n,text:a}=$r(t,O.mode,O,N,m);if(n!==e.value?.source||a!==e.value?.text){const e={type:b,optional:d,source:n,text:a};f&&n===I.Variable&&$.current&&(e.type=$.current),h?.(e)}}}),V=Sr(e=>{h?.({type:b,optional:d,source:O.source,text:e})}),B=t.useCallback((e,t)=>{$.current=t,r.current?.insertVariable(e)},[]),j=Sr(()=>O.mode),F=Sr(()=>b),H=Sr(()=>y),Z=Sr(()=>v),Y=Sr(()=>E),X=Sr(()=>e.value),U=t.useCallback(()=>s.current,[]),G=Sr(()=>e.brand),q=t.useCallback(e=>{e||(s.current=""),x(e)},[]),[K]=t.useState({setMode:P,getMode:j,setText:V,insertVariable:B,getDataType:F,getContext:H,getValue:X,getHighlight:U,getBrand:G,getRuntime:Z,setActive:q,getVariableFilter:Y,addListener:M.addListener.bind(M)});t.useImperativeHandle(n,()=>K,[K]);const Q=Sr(()=>{S||a.setActivedSuperInput(K)}),W=Sr(()=>{if(!d&&!O.text)return void T(ln.requiredPrompt);const e=ea.superInputToInspector({type:b,optional:d,source:O.source,text:O.text},y,"mapping"===m);e?a.validateSuperInput(`${o}`,e,T):T("")}),J=Sr(e=>{s.current=e,M.dispatch("variableClick",{variable:e,target:K})}),ee=Sr(e=>{M.dispatch("expressionClick",{expression:e,target:K})}),te=Sr(e=>{Lr.popup(null);const t=e.target,n=t.dataset.type||t.parentElement?.dataset.type;n&&h?.({type:n,optional:d,source:O.source,text:O.text})}),ne=t.useMemo(()=>React.createElement("ul",{className:"ͼbaseflow-SuperInput__dataTypeMenu",onClick:te},_.map(e=>React.createElement("li",{key:e.value,"data-type":e.value},React.createElement(vo,{name:e.value})," ",e.label))),[te]),ae=Sr(e=>{f&&Lr.popup({content:ne,target:e.target,offset:{left:"-15px",top:"2px"}})});return t.useEffect(()=>{W()},[y,e.value]),t.useEffect(()=>()=>{a.getActivedSuperInput()===K&&a.setActivedSuperInput(null)},[]),React.createElement("div",{className:sn.classNames(A,O.mode),"data-error":p||k||void 0,style:i},!N&&!m&&React.createElement("div",{className:"ͼbaseflow-SuperInput__modeSwitch"},React.createElement("span",{className:sn.classNames("item",{on:"simple"===O.mode}),onClick:()=>P("simple")},ln.simpleValue),React.createElement("span",{className:sn.classNames("item",{on:"complex"===O.mode}),onClick:()=>P("complex")},ln.complexValue)),!w&&React.createElement(vo,{className:sn.classNames("dataType",{editable:f}),name:b,onClick:ae}),!g&&(p||k)&&React.createElement("div",{className:"dataError",title:p||k,onClick:e=>{ra.clipboard.write(e.currentTarget.textContent),ra.message.success(ln.copied)}},p||k),React.createElement("div",{className:sn.classNames("ͼbaseflow-SuperInput__input",O.mode),"data-baseflow-role":sn.domRoles.SuperInput,style:D,onClick:Q},"complex"===O.mode?React.createElement(Or,{onChange:z,text:O.code,onClickExpression:ee}):React.createElement(Kr,{ref:r,dataType:b,value:O.code,onChange:z,nativeRender:c,nativeRenderOptions:u,onClickVariable:J,placeholder:C,sourceType:m})))});var Wr=t.memo(Qr);function Jr(e){}function es(e){switch(e){case R.String:return[{label:ln.equalTo,value:"equalTo"},{label:ln.notEqualTo,value:"notEqualTo"},{label:ln.startsWith,value:"startsWith"},{label:ln.endsWith,value:"endsWith"},{label:ln.containsString,value:"containsString"},{label:ln.notContainsString,value:"notContainsString"},{label:ln.containedIn,value:"containedIn"},{label:ln.notContainedIn,value:"notContainedIn"},{label:ln.in,value:"in"},{label:ln.notIn,value:"notIn"}];case R.Number:return[{label:ln.equalTo,value:"equalTo"},{label:ln.notEqualTo,value:"notEqualTo"},{label:ln.greaterThan,value:"greaterThan"},{label:ln.lessThan,value:"lessThan"},{label:ln.greaterOrEqual,value:"greaterOrEqual"},{label:ln.lessOrEqual,value:"lessOrEqual"},{label:ln.in,value:"in"},{label:ln.notIn,value:"notIn"}];case R.Date:case R.Time:case R.DateTime:return[{label:ln.equalTo,value:"equalTo"},{label:ln.notEqualTo,value:"notEqualTo"},{label:ln.laterThan,value:"laterThan"},{label:ln.earlierThan,value:"earlierThan"},{label:ln.laterOrEqual,value:"laterOrEqual"},{label:ln.earlierOrEqual,value:"earlierOrEqual"},{label:ln.in,value:"in"},{label:ln.notIn,value:"notIn"}];case R.Bool:return[{label:ln.equalTo,value:"equalTo"},{label:ln.notEqualTo,value:"notEqualTo"},{label:ln.in,value:"in"},{label:ln.notIn,value:"notIn"}];case R.Array:return[{label:ln.equalTo,value:"equalTo"},{label:ln.notEqualTo,value:"notEqualTo"},{label:ln.containsItem,value:"containsItem"},{label:ln.notContainsItem,value:"notContainsItem"},{label:ln.in,value:"in"},{label:ln.notIn,value:"notIn"}];case R.Map:case R.Object:return[{label:ln.equalTo,value:"equalTo"},{label:ln.notEqualTo,value:"notEqualTo"},{label:ln.containsItem,value:"containsItem"},{label:ln.notContainsItem,value:"notContainsItem"},{label:ln.hasKey,value:"hasKey"},{label:ln.notHasKey,value:"notHasKey"},{label:ln.in,value:"in"},{label:ln.notIn,value:"notIn"}]}return[{label:ln.equalTo,value:"equalTo"},{label:ln.notEqualTo,value:"notEqualTo"},{label:ln.in,value:"in"},{label:ln.notIn,value:"notIn"}]}var ts=t.memo(({value:e,onChange:t})=>{const n=Sr(()=>{t("and"===e?"or":"and")});return React.createElement("div",{className:"ͼbaseflow-ConditionSelector__Relation",onClick:n},React.createElement(vo,{name:xa}),React.createElement("span",null,e.toUpperCase()))});const ns={type:R.String,source:I.Variable,text:""};var as=t.memo(e=>{const n=t.useRef(1),a=t.useRef({});t.useMemo(()=>{if(e.value!==a.current.value){a.current.value=e.value;const t=JSON.parse(JSON.stringify(e.value));a.current._value=t,a.current.__value=t,t.groups.forEach(e=>{e.items.forEach(e=>{e.operatorOptions||(e.operatorOptions=es(e.source.type))})})}else a.current._value=a.current.__value},[e.value]);const o=Sr(t=>{const n=e.onChange;if(t){const e={...t,groups:t.groups.map(({relation:e,items:t})=>({relation:e,items:t.map(({source:e,target:t,operator:n})=>({source:e,target:t,operator:n}))}))};a.current.value=e,a.current.__value=t,n(e)}else n(void 0)}),r=a.current._value,s=Sr(e=>{o({...r,relation:e})}),i=(e,t,n)=>{o({...r,groups:r.groups.map((a,o)=>o===e?{...a,items:a.items.map((e,a)=>{if(a===t){const t={...e,operator:n},a=function(e,t){return"in"===t||"notIn"===t?R.Array:"hasKey"===t||"notHasKey"===t?R.String:"containsItem"===t||"notContainsItem"===t?R.Any:e}(e.source.type,n);return e.target.type!==a&&(t.target={...ns,type:a}),t}return e})}:a)})};return React.createElement("div",{className:"ͼbaseflow-ConditionSelector__conditionForm"},r.groups.map((e,t)=>(e.key||(e.key=n.current++),React.createElement("div",{key:e.key,className:"group"},e.items.map((a,s)=>(a.key||(a.key=n.current++),React.createElement("div",{key:a.key,className:"ͼbaseflow-ConditionSelector__conditionItem"},React.createElement("div",{className:"hd"},React.createElement("div",{className:"title"},0===s?"WHEN":React.createElement(ts,{value:e.relation,onChange:e=>((e,t)=>{o({...r,groups:r.groups.map((n,a)=>a===e?{...n,relation:t}:n)})})(t,e)})),React.createElement(Wr,{dataTypeEditable:!0,dataType:a.source.type,value:a.source,onChange:e=>((e,t,n)=>{o({...r,groups:r.groups.map((a,o)=>o===e?{...a,items:a.items.map((e,a)=>{if(a===t){const t={...e,source:n};return e.source.type!==n.type&&Object.assign(t,{operator:"equalTo",target:{...ns},operatorOptions:es(n.type)}),t}return e})}:a)})})(t,s,e)}),React.createElement(vo,{className:"action",name:so,onClick:()=>((e,t)=>{const n=r.groups[e].items.filter((e,n)=>n!==t);if(n.length)return void o({...r,groups:r.groups.map((t,a)=>a===e?{...t,items:n}:t)});const a=r.groups.filter((t,n)=>n!==e);a.length?o({...r,groups:a}):o(void 0)})(t,s)})),React.createElement("div",{className:"bd"},React.createElement(Lr.Select,{className:"operator",value:a.operator,options:a.operatorOptions,onChange:e=>i(t,s,e)}),React.createElement(Wr,{dataType:a.target.type,value:a.target,onChange:e=>((e,t,n)=>{o({...r,groups:r.groups.map((a,o)=>o===e?{...a,items:a.items.map((e,a)=>a===t?{...e,target:n}:e)}:a)})})(t,s,e)}),React.createElement(vo,{className:"action",name:ro,onClick:()=>((e,t)=>{o({...r,groups:r.groups.map((n,a)=>a===e?{...n,items:[...n.items.slice(0,t+1),{source:{...ns},operator:"equalTo",target:{...ns},operatorOptions:es(ns.type)},...n.items.slice(t+1)]}:n)})})(t,s)}))))),React.createElement("div",{className:"ͼbaseflow-ConditionSelector__groupActions"},React.createElement("div",{className:"btn",onClick:()=>{o({...r,groups:[...r.groups,{relation:"and",items:[{source:{...ns},operator:"equalTo",target:{...ns},operatorOptions:es(ns.type)}]}]})}},React.createElement(vo,{name:ro}),React.createElement("span",null,ln.addGroup)),React.createElement("div",{className:"btn",onClick:()=>(e=>{const t=r.groups.filter((t,n)=>e!==n);o(t.length?{...r,groups:t}:void 0)})(t)},React.createElement(vo,{name:so}),React.createElement("span",null,ln.delGroup)),r.groups.length>1&&t<r.groups.length-1&&React.createElement("div",{className:"group-relation"},React.createElement(ts,{value:r.relation,onChange:s})))))))});const os={type:R.String,source:I.Variable,text:""},rs={relation:"or",groups:[{relation:"and",items:[{source:{...os},operator:"equalTo",target:{...os}}]}]};var ss=t.memo(({value:e,onChange:n})=>{const a=t.useMemo(()=>{if("string"==typeof e){return{type:R.String,text:e,source:I.Expression}}},[e]),o=Sr(e=>{n?.(e.text)}),r=Sr(e=>{n?.(e?"":rs)});return void 0===e?React.createElement("div",{className:"ͼbaseflow-ConditionSelector"},React.createElement(Lr.Button,{type:"link",size:"small",onClick:()=>n?.(rs),icon:React.createElement(vo,{name:ro})},ln.createCondition)):React.createElement("div",{className:"ͼbaseflow-ConditionSelector"},React.createElement("div",{className:"mode-switch"},React.createElement("div",{className:"title"},ln.condition),React.createElement(Lr.Switch,{checkedChildren:ln.scriptsMode,unCheckedChildren:ln.scriptsMode,value:"string"==typeof e,onChange:r})),"string"==typeof e?React.createElement("div",{className:"ͼbaseflow-ConditionSelector__conditionScripts"},React.createElement("div",{className:"label"},ln.conditionScripts),React.createElement("div",{className:"input"},React.createElement(Wr,{height:100,hideIcon:!0,runtime:"script",brand:"variable",dataType:R.Any,value:a,onChange:o}))):React.createElement(as,{value:e,onChange:n||Jr}))});const is=e=>!!e&&e instanceof Date,ls=e=>"object"==typeof e&&null!==e,cs=e=>!!e&&e instanceof Object&&"function"==typeof e;function ds(e,t){return void 0===t&&(t=!1),!e||t?`"${e}"`:e}function us(e){let{field:n,value:a,data:o,lastElement:r,openBracket:s,closeBracket:i,level:l,style:c,shouldExpandNode:d,clickToExpandNode:u,outerRef:h,beforeExpandChange:m}=e;const p=t.useRef(!1),[g,f]=t.useState(()=>d(l,a,n)),y=t.useRef(null);t.useEffect(()=>{p.current?f(d(l,a,n)):p.current=!0},[d]);const v=t.useId();if(0===o.length)return function(e){let{field:n,openBracket:a,closeBracket:o,lastElement:r,style:s}=e;return t.createElement("div",{className:s.basicChildStyle,role:"treeitem","aria-selected":void 0},(n||""===n)&&t.createElement("span",{className:s.label},ds(n,s.quotesForFieldNames),":"),t.createElement("span",{className:s.punctuation},a),t.createElement("span",{className:s.punctuation},o),!r&&t.createElement("span",{className:s.punctuation},","))}({field:n,openBracket:s,closeBracket:i,lastElement:r,style:c});const b=g?c.collapseIcon:c.expandIcon,E=g?c.ariaLables.collapseJson:c.ariaLables.expandJson,N=l+1,C=o.length-1,w=e=>{g===e||m&&!m({level:l,value:a,field:n,newExpandValue:e})||f(e)},S=e=>{if("ArrowRight"===e.key||"ArrowLeft"===e.key)e.preventDefault(),w("ArrowRight"===e.key);else if("ArrowUp"===e.key||"ArrowDown"===e.key){e.preventDefault();const t="ArrowUp"===e.key?-1:1;if(!h.current)return;const n=h.current.querySelectorAll("[role=button]");let a=-1;for(let e=0;e<n.length;e++)if(0===n[e].tabIndex){a=e;break}if(a<0)return;const o=(a+t+n.length)%n.length;n[a].tabIndex=-1,n[o].tabIndex=0,n[o].focus()}},x=()=>{var e;w(!g);const t=y.current;if(!t)return;const n=null===(e=h.current)||void 0===e?void 0:e.querySelector('[role=button][tabindex="0"]');n&&(n.tabIndex=-1),t.tabIndex=0,t.focus()};return t.createElement("div",{className:c.basicChildStyle,role:"treeitem","aria-expanded":g,"aria-selected":void 0},t.createElement("span",{className:b,onClick:x,onKeyDown:S,role:"button","aria-label":E,"aria-expanded":g,"aria-controls":g?v:void 0,ref:y,tabIndex:0===l?0:-1}),(n||""===n)&&(u?t.createElement("span",{className:c.clickableLabel,onClick:x,onKeyDown:S},ds(n,c.quotesForFieldNames),":"):t.createElement("span",{className:c.label},ds(n,c.quotesForFieldNames),":")),t.createElement("span",{className:c.punctuation},s),g?t.createElement("ul",{id:v,role:"group",className:c.childFieldsContainer},o.map((e,n)=>t.createElement(gs,{key:e[0]||n,field:e[0],value:e[1],style:c,lastElement:n===C,level:N,shouldExpandNode:d,clickToExpandNode:u,beforeExpandChange:m,outerRef:h}))):t.createElement("span",{className:c.collapsedContent,onClick:x,onKeyDown:S}),t.createElement("span",{className:c.punctuation},i),!r&&t.createElement("span",{className:c.punctuation},","))}function hs(e){let{field:t,value:n,style:a,lastElement:o,shouldExpandNode:r,clickToExpandNode:s,level:i,outerRef:l,beforeExpandChange:c}=e;return us({field:t,value:n,lastElement:o||!1,level:i,openBracket:"{",closeBracket:"}",style:a,shouldExpandNode:r,clickToExpandNode:s,data:Object.keys(n).map(e=>[e,n[e]]),outerRef:l,beforeExpandChange:c})}function ms(e){let{field:t,value:n,style:a,lastElement:o,level:r,shouldExpandNode:s,clickToExpandNode:i,outerRef:l,beforeExpandChange:c}=e;return us({field:t,value:n,lastElement:o||!1,level:r,openBracket:"[",closeBracket:"]",style:a,shouldExpandNode:s,clickToExpandNode:i,data:n.map(e=>[void 0,e]),outerRef:l,beforeExpandChange:c})}function ps(e){let n,{field:a,value:o,style:r,lastElement:s}=e,i=r.otherValue;var l;return null===o?(n="null",i=r.nullValue):void 0===o?(n="undefined",i=r.undefinedValue):"string"==typeof(l=o)||l instanceof String?(n=function(e,t,n){return n?JSON.stringify(e):t?`"${e}"`:e}(o,!r.noQuotesForStringValues,r.stringifyStringValues),i=r.stringValue):(e=>"boolean"==typeof e||e instanceof Boolean)(o)?(n=o?"true":"false",i=r.booleanValue):(e=>"number"==typeof e||e instanceof Number)(o)?(n=o.toString(),i=r.numberValue):(e=>"bigint"==typeof e||e instanceof BigInt)(o)?(n=`${o.toString()}n`,i=r.numberValue):n=is(o)?o.toISOString():cs(o)?"function() { }":o.toString(),t.createElement("div",{className:r.basicChildStyle,role:"treeitem","aria-selected":void 0},(a||""===a)&&t.createElement("span",{className:r.label},ds(a,r.quotesForFieldNames),":"),t.createElement("span",{className:i},n),!s&&t.createElement("span",{className:r.punctuation},","))}function gs(e){const n=e.value;return a=n,Array.isArray(a)?t.createElement(ms,Object.assign({},e)):!ls(n)||is(n)||cs(n)?t.createElement(ps,Object.assign({},e)):t.createElement(hs,Object.assign({},e));var a}const fs={container:"_2IvMF _GzYRV",basicChildStyle:"_2bkNM",childFieldsContainer:"_1BXBN",label:"_1MGIk",clickableLabel:"_2YKJg _1MGIk _1MFti",nullValue:"_2T6PJ",undefinedValue:"_1Gho6",stringValue:"_vGjyY",booleanValue:"_3zQKs",numberValue:"_1bQdo",otherValue:"_1xvuR",punctuation:"_3uHL6 _3eOF8",collapseIcon:"_oLqym _f10Tu _1MFti _1LId0",expandIcon:"_2AXVT _f10Tu _1MFti _1UmXx",collapsedContent:"_2KJWg _1pNG9 _1MFti",noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:{collapseJson:"collapse JSON",expandJson:"expand JSON"},stringifyStringValues:!1},ys=()=>!0,vs=e=>{let{data:n,style:a=fs,shouldExpandNode:o=ys,clickToExpandNode:r=!1,beforeExpandChange:s,compactTopLevel:i,...l}=e;const c=t.useRef(null);return t.createElement("div",Object.assign({"aria-label":"JSON view"},l,{className:a.container,ref:c,role:"tree"}),i&&ls(n)?Object.entries(n).map(e=>{let[n,i]=e;return t.createElement(gs,{key:n,field:n,value:i,style:{...fs,...a},lastElement:!0,level:1,shouldExpandNode:o,clickToExpandNode:r,beforeExpandChange:s,outerRef:c})}):t.createElement(gs,{value:n,style:{...fs,...a},lastElement:!0,level:0,shouldExpandNode:o,clickToExpandNode:r,outerRef:c,beforeExpandChange:s}))};var bs=t.memo(({data:e,shouldExpandNode:n})=>{const a=t.useMemo(()=>({...fs,quotesForFieldNames:!0}),[]);return React.createElement("div",{className:"ͼbaseflow-JsonView"},React.createElement(vs,{data:e,shouldExpandNode:n,clickToExpandNode:!0,style:a}))});var Es=t.memo(({value:e,onChange:n,...a})=>{const[o,r]=t.useState(e);t.useMemo(()=>{r(e)},[e]);const s=Sr(()=>{const t=(o||"").trim();(e||"").trim()!==t&&n?.(t)});return React.createElement(Lr.Input,{value:o,onChange:r,onBlur:s,...a})});var Ns=t.memo(({value:e,onChange:n,labelPlaceholder:a="label",valuePlaceholder:o="value",hideLabel:r,className:s,variant:i})=>{const l=t.useRef(0),c=t.useRef(new Map),d=Sr(()=>{const t={value:"",label:r?void 0:""};n?.(e?[...e,t]:[t])}),u=Sr(t=>{n?.(e.filter((e,n)=>n!==t||(c.current.delete(e),!1)))}),h=Sr((t,a)=>{const o=e.map((e,n)=>n===a?(c.current.delete(e),{...e,value:t}):e);n?.(o)}),m=Sr((t,a)=>{const o=e.map((e,n)=>n===a?(c.current.delete(e),{...e,label:t}):e);n?.(o)});return React.createElement("div",{className:sn.classNames("ͼbaseflow-KeyValues",s,i)},e?.length?e.map((e,t)=>{let n=c.current.get(e);return n||(n=++l.current,c.current.set(e,n)),React.createElement("div",{className:"item",key:n},React.createElement(Es,{className:sn.classNames("input",{"input-error":!e.value}),variant:"filled",placeholder:o,value:e.value,onChange:e=>h(e||"",t)}),!r&&React.createElement(Es,{className:"input",variant:"filled",placeholder:a,value:e.label,onChange:e=>m(e||"",t)}),React.createElement(vo,{name:so,onClick:()=>u(t)}))}):null,React.createElement("div",{className:sn.classNames("create",{more:e?.length})},React.createElement(vo,{name:ro,onClick:d})))});var Cs=t.memo(({onClose:e,item:n})=>{const[a,o]=t.useState(En.schemaModelToXml(n)),[r,s]=t.useState(""),i=Sr(()=>{const e=En.xmlToSchemaModel(a),t=En.schemaModelToJson(e);s(t)}),l=Sr(e=>{ra.clipboard.write(e).then(()=>ra.message.success(ln.alreadyToClipboard))});return React.createElement("div",{className:sn.classNames("ͼbaseflow-sr-modal head-split ͼbaseflow-SchemaExport")},React.createElement(vo,{className:"close",button:!0,name:ka,onClick:e}),React.createElement("div",{className:"hd"},React.createElement(vo,{className:"icon",name:Ma}),React.createElement("div",{className:"title"},ln.export)),React.createElement("div",{className:"bd"},React.createElement("div",{className:"ͼbaseflow-SchemaExport__col"},React.createElement("div",{className:"hd"},React.createElement("span",{className:"title"},`${ln.jsonValue}:`),React.createElement("span",{className:"link",onClick:()=>l(r)},React.createElement(vo,{name:Oa}),ln.copy)),React.createElement(Lr.TextArea,{className:"input",variant:"filled",rows:10,block:!0,value:r,onChange:s})),React.createElement("div",{className:"ͼbaseflow-SchemaExport__con"},React.createElement(Lr.Button,{size:"small",icon:React.createElement(vo,{name:Sa}),onClick:i},ln.generate)),React.createElement("div",{className:"ͼbaseflow-SchemaExport__col"},React.createElement("div",{className:"hd"},React.createElement("span",{className:"title"},`${ln.schemaModel}:`),React.createElement("span",{className:"link",onClick:()=>l(a)},React.createElement(vo,{name:Oa}),ln.copy)),React.createElement(Lr.TextArea,{className:"input",variant:"filled",rows:10,block:!0,value:a,onChange:o}))),React.createElement("div",{className:"ft"},ln.exportSchemaTips))});const ws=t.memo(function({namespace:e,looseLeaf:n,node:a,parent:o,index:r,isFirst:s,isLast:i,parentLevel:l,parentPath:c,parentIds:d,parentIsEnd:u,parentIsFinish:h,attributeRender:m,context:p,contextValueRender:g,nodeRender:f,folderRender:y}){const v={node:a,parent:o,index:r,level:l+1,path:a.name&&c?`${c}${$}${a.name}`:a.name||"",ids:a.id&&d?`${d}${$}${a.id}`:a.id||"",isFirst:s,isLast:i,isBegin:s&&0===l,isEnd:i&&u,isFinish:i&&h,isLeaf:n?!a.children:!(a.children&&a.children.length),folded:Boolean(a.folded),disabled:Boolean(a.disabled),contextValue:p?t.useContext(p):void 0},b=m?m(v):void 0,E=g?g(v):void 0,N=!v.isLeaf&&"all"!==a.disabled,C=N&&a.children.map((t,o)=>React.createElement(ws,{key:t.id||(t.name&&v.path?`${v.path}${$}${t.name}`:t.name||""),namespace:e,looseLeaf:n,context:p,contextValueRender:g,attributeRender:m,folderRender:y,nodeRender:f,node:t,parent:a,index:o,isFirst:0===o,isLast:o===a.children.length-1,parentLevel:v.level,parentPath:v.path,parentIds:v.ids,parentIsEnd:v.isLast,parentIsFinish:v.isFinish}));return React.createElement("div",{...b,className:sn.classNames("ͼbaseflow-SimpleTree__item",e&&`ͼbaseflow-${e}`,b?.className)},React.createElement("div",{className:sn.classNames("ͼbaseflow-SimpleTree__node",e&&`ͼbaseflow-${e}`,{"ͼbaseflow-root":!o})},f(v)),React.createElement("div",{className:sn.classNames("ͼbaseflow-SimpleTree__folder",e&&`ͼbaseflow-${e}`,{"ͼbaseflow-root":!o,"ͼbaseflow-folded":v.folded,"ͼbaseflow-leaf":v.isLeaf})},y(v)),N&&React.createElement("div",{className:sn.classNames("ͼbaseflow-SimpleTree__children",e&&`ͼbaseflow-${e}`,"ͼbaseflow-level"+v.level%2,{"ͼbaseflow-folded":v.folded,"ͼbaseflow-root":!o})},p&&void 0!==E?React.createElement(p.Provider,{value:E},C):C))});var Ss=t.memo(function(e){const n=e.source,{style:a,namespace:o,looseLeaf:r=!1,context:s,contextValueRender:i,attributeRender:l,nodeRender:c,folderRender:d}=e;if(e.renderRoot)return React.createElement("div",{className:sn.classNames("ͼbaseflow-SimpleTree",o&&`ͼbaseflow-${o}`),style:a},React.createElement(ws,{key:n.id||n.name,namespace:o,looseLeaf:r,context:s,contextValueRender:i,attributeRender:l,folderRender:d,nodeRender:c,node:n,parent:void 0,index:0,parentLevel:0,parentPath:"",parentIds:"",isFirst:!0,isLast:!0,parentIsEnd:!0,parentIsFinish:!0}));const u=e.source?.children;if(!u||!u.length)return null;const h=n.disabled,m={level:0,path:n.name||"",ids:n.id||"",isLast:!0,isFinish:!0,folded:Boolean(n.folded),disabled:Boolean(n.disabled),contextValue:s?t.useContext(s):void 0};return React.createElement("div",{className:sn.classNames("ͼbaseflow-SimpleTree",o&&`ͼbaseflow-${o}`),style:a},"all"!==h&&u.map((e,t)=>React.createElement(ws,{key:e.id||(e.name&&m.path?`${m.path}${$}${e.name}`:e.name||""),namespace:o,looseLeaf:r,context:s,contextValueRender:i,attributeRender:l,folderRender:d,nodeRender:c,node:e,parent:n,index:t,isFirst:0===t,isLast:t===u.length-1,parentLevel:m.level,parentPath:m.path,parentIds:m.ids,parentIsEnd:m.isLast,parentIsFinish:m.isFinish})))});const xs=({className:e,children:t})=>React.createElement("ul",{className:sn.classNames("ͼbaseflow-FormLayout",e)},t);var Rs=t.memo(({value:e,onChange:n,error:a})=>{const[o,r]=t.useState(""),[s,i]=t.useState(e),[l,c]=t.useState(""),[d,u]=t.useState(a);t.useMemo(()=>{u(a)},[a]);const h=Sr(()=>{let e;o||c(ln.jsonValueTips);try{e=En.jsonToSchemaModel(o)}catch(e){console.error(e)}if(e){c(""),u("");const t=En.schemaModelToXml(e);i(t),n?.(t)}else c(ln.jsonValueTips)}),m=Sr(()=>{n?.(s)}),p=Sr(()=>{let e=o.trim();if(e)try{const t=JSON.parse(e);e=JSON.stringify(t,null,4),r(e),c("")}catch(e){console.error(e),u(ln.jsonValueTips)}}),g=Sr(()=>{const e=s.trim();if(e)try{const t=En.formatXml(e);i(t),u("")}catch(e){console.error(e),u(ln.schemaValueTips)}});return React.createElement("div",{className:"ͼbaseflow-SchemaModelForm-SchemaImport"},React.createElement("div",{className:"bd"},React.createElement("div",{className:"ͼbaseflow-SchemaModelForm-SchemaImport__col"},React.createElement("div",{className:"hd"},React.createElement("span",{className:"title"},`${ln.jsonValue}:`),React.createElement("span",{className:"error"},l),React.createElement("span",{className:"format",onClick:p},React.createElement(vo,{name:io}),ln.format)),React.createElement(Lr.TextArea,{className:"input",variant:"filled",rows:10,block:!0,value:o,onChange:r})),React.createElement("div",{className:"ͼbaseflow-SchemaModelForm-SchemaImport__con"},React.createElement(Lr.Button,{size:"small",iconPosition:"end",icon:React.createElement(vo,{name:wa}),onClick:h},ln.infer)),React.createElement("div",{className:"ͼbaseflow-SchemaModelForm-SchemaImport__col"},React.createElement("div",{className:"hd"},React.createElement("span",{className:"title"},`${ln.schemaModel}:`),React.createElement("span",{className:"error"},d),React.createElement("span",{className:"format",onClick:g},React.createElement(vo,{name:io}),ln.format)),React.createElement(Lr.TextArea,{className:"input",variant:"filled",rows:10,block:!0,value:s,onChange:i,onBlur:m}))),React.createElement("div",{className:"ft"},ln.importSchemaTips.split("\n").map(e=>React.createElement("div",{key:e},e))))});const Ms=[{label:ln.createdFromManual,value:"manual"},{label:ln.createdFromDSL,value:"import"}];var _s=t.memo(({onCancel:e,onSubmit:n,item:a,place:o,target:r,targetPath:s,parent:i,nameExists:l,editableFilter:c})=>{const d=i?.type===R.Array||i?.type===R.Map,u=c?.(a,i),h=Boolean(!u||void 0===u.name||u.name)&&!d&&Boolean(i),m=Boolean(!u||void 0===u.type||u.type),{typeOptions:p,typeMap:g}=t.useMemo(()=>{let e=_;const t=u?.type;return!1===t?e=[{value:a.type||R.String,label:M[a.type||R.String]}]:Array.isArray(t)&&(e=t.map(e=>({label:M[e],value:e}))),{typeOptions:e,typeMap:e.reduce((e,t)=>(e[t.value]=!0,e),{})}},[u?.type,a.type]),{subTypeOptions:f,subTypeMap:y}=t.useMemo(()=>{let e=_;const t=u?.subType;return!1===t?e=[{value:a.subType||R.String,label:M[a.subType||R.String]}]:Array.isArray(t)&&(e=t.map(e=>({label:M[e],value:e}))),{subTypeOptions:e,subTypeMap:e.reduce((e,t)=>(e[t.value]=!0,e),{})}},[u?.subType,a.subType]),v=t.useMemo(()=>{const e=u?.name;let t;return!1===e?t=e=>{if(e!==a.name)return cn(ln.nameRestricted,{name:e})}:"function"==typeof e&&(t=e),t},[u?.name,a.name]),[b,E]=t.useState("manual"),[N,C]=t.useState(""),[w,S]=t.useState(""),x=Sr(e=>{"import"===e&&(N||C(En.schemaModelToXml(a))),E(e)}),I=Sr(e=>e?h||e===a.name?e!==a.name&&l[e]?cn(ln.nameIsRepeat,{name:e}):void 0:cn(ln.nameRestricted,{name:e}):ln.nameIsRequired),[k,T]=t.useState(()=>({type:a.type,name:a.name,label:a.label,tips:a.tips,optional:a.optional,enums:a.enums,subType:a.subType,nameError:""}));t.useMemo(()=>{T({type:a.type,name:a.name,label:a.label,tips:a.tips,optional:a.optional,enums:a.enums,subType:a.subType,nameError:""})},[a]);const D=Sr(e=>{T({...k,enums:e?.length?e:void 0})}),A=Sr(e=>{T({...k,optional:e||void 0})}),$=Sr(e=>{T({...k,tips:e||void 0})}),O=Sr(e=>{T({...k,label:e||void 0})}),P=Sr(e=>{const t=e||"";T({...k,name:t,nameError:I(t)||v?.(t)||""})}),z=Sr(e=>{T({...k,type:e,subType:e===R.Array||e===R.Map?a.subType||R.String:void 0})}),V=Sr(e=>{T({...k,subType:e})}),B=Sr(e=>{if(!e.trim())return ln.schemaValueTips;let t,n;try{t=En.xmlToSchemaModel(e)}catch(e){n=e}if(!t)return"string"==typeof n?n:ln.schemaValueTips;const a=I(t.name)||v?.(t.name)||"";if(a)return a;if(!g[t.type])return cn(ln.typeRestricted,{type:M[t.type]});const o=t.type===R.Array||t.type===R.Map?t.children[0].type:void 0;return o&&!y[o]?cn(ln.typeRestricted,{type:M[o]}):t}),j=Sr(()=>{let e;if("import"===b){const t=B(N);"string"==typeof t?S(t):e=t}else{const{type:t,name:n,label:a,tips:s,optional:i,subType:l}=k;let c=k.enums;const d=I(n)||v?.(n)||"";if(d!==k.nameError&&T({...k,nameError:d}),!(d||(e={type:t,name:n,label:a,tips:s,optional:i},"replace"===o&&(r.type!==t||t!==R.Object&&(t!==R.Array&&t!==R.Map||r.children?.[0].type!==l)||(e.children=r.children)),c&&(c=c.filter(e=>e.value),c.length||(c=void 0),e.enums=c),t!==R.Array&&t!==R.Map||e.children))){const t={type:l||R.String,name:L};e.children=[t],t.type!==R.Array&&t.type!==R.Map||(t.children=[{type:R.String,name:L}])}}e&&n(e,o,s)});return React.createElement("div",{className:"ͼbaseflow-SchemaModelForm-Editor ͼbaseflow-sr-modal head-split"},React.createElement("div",{className:"hd"},React.createElement(vo,{name:"replace"===o?Ta:"sub"===o?to:eo}),React.createElement("span",null,"replace"===o?ln.update:"sub"===o?ln.insertChild:ln.insertNext,r?React.createElement("label",{className:"tips"},`(${r.name})`):null)),React.createElement("div",{className:"bd"},!1!==u?.import&&React.createElement("div",{className:"ͼbaseflow-SchemaModelForm-Editor__tab"},React.createElement(Lr.Segmented,{className:"tab",value:b,options:Ms,onChange:x})),"import"===b?React.createElement(Rs,{value:N,onChange:C,error:w}):React.createElement(xs,{className:"ͼbaseflow-SchemaModelForm-Editor__form"},h&&React.createElement("li",null,React.createElement("span",{className:"item-label required"},ln.name),React.createElement("span",{className:"item-content"},React.createElement(Es,{value:k.name,className:"ͼbaseflow-input"+(k.nameError?" ͼbaseflow-error":""),placeholder:"name",onChange:P,block:!0}),!!k.nameError&&React.createElement("span",{className:"item-error"},k.nameError))),m&&React.createElement("li",null,React.createElement("span",{className:"item-label required"},ln.type),React.createElement("span",{className:"item-content"},React.createElement(Lr.Select,{value:k.type,options:p,block:!0,placeholder:"type",onChange:z}))),(k.type===R.String||k.type===R.Number)&&React.createElement("li",null,React.createElement("span",{className:"item-label"},ln.useEnum),React.createElement("span",{className:"item-content"},React.createElement(Ns,{value:k.enums,onChange:D}))),(k.type===R.Array||k.type===R.Map)&&React.createElement("li",null,React.createElement("span",{className:"item-label required"},ln.subType),React.createElement("span",{className:"item-content"},React.createElement(Lr.Select,{value:k.subType,options:f,placeholder:"item type",block:!0,onChange:V}))),React.createElement("li",null,React.createElement("span",{className:"item-label"},ln.label),React.createElement("span",{className:"item-content"},React.createElement(Es,{value:k.label,block:!0,placeholder:"label",onChange:O}))),React.createElement("li",null,React.createElement("span",{className:"item-label"},ln.tips),React.createElement("span",{className:"item-content"},React.createElement(Es,{value:k.tips,block:!0,placeholder:"tips",onChange:$}))),React.createElement("li",null,React.createElement("span",{className:"item-label"},ln.optional),React.createElement("span",{className:"item-content"},React.createElement(Lr.Switch,{value:k.optional,className:"ͼbaseflow-checkbox",onChange:A}))))),React.createElement("div",{className:"ft"},React.createElement(Lr.Button,{className:"ͼbaseflow-form-button",onClick:e},ln.ButtonCancel),React.createElement(Lr.Button,{className:"ͼbaseflow-form-submit",type:"primary",onClick:j},ln.ButtonSubmit)))});const Is={name:"",type:R.String};var ks=t.memo(({className:e,node:n,parent:a,nodePath:o,labelRender:r,toolsFilter:s,onDelItem:i,onEditItem:l,onExportItem:c})=>{const d=a&&(a.type===R.Array||a.type===R.Map),u=s?.(n,a),h=t.useMemo(()=>En.toSchemaTitle(n,a,r),[r,n,a]),m={addNext:!(!a||d)&&{key:"addNext",btn:React.createElement(vo,{name:eo,key:"addNext",button:!0,title:ln.insertNext,onClick:()=>l(Is,"next",n,o,a)})},addSub:n.type===R.Object&&{key:"addChild",btn:React.createElement(vo,{name:to,key:"addChild",button:!0,title:ln.insertChild,onClick:()=>l(Is,"sub",n,o,n)})},edit:{key:"edit",btn:React.createElement(vo,{name:Ta,key:"edit",button:!0,title:ln.edit,onClick:()=>l(n,"replace",n,o,a)})},delete:!d&&{key:"delete",btn:React.createElement(vo,{name:Da,key:"delete",button:!0,title:ln.delete,onClick:()=>i(o)})},export:{key:"export",btn:React.createElement(vo,{name:Ma,key:"export",button:!0,title:ln.export,onClick:()=>c(n)})}};let p=[m.addNext,m.addSub,m.edit,m.delete,m.export];return p=u?p.filter(e=>e&&!1!==u[e.key]):p.filter(Boolean),React.createElement("div",{className:sn.classNames("ͼbaseflow-SchemaModelForm__item",e)},React.createElement(vo,{className:"item-icon",name:n.type}),React.createElement("span",{className:sn.classNames("item-title",{tips:h.tips}),title:h.tips||h.title},h.title),n.optional&&React.createElement("span",{className:"item-optional ͼbaseflow-sr-optional"}),React.createElement("span",{className:"item-tools"},p.map(e=>e.btn)))});const Ls={name:"data",type:R.Object};var Ts=t.memo(e=>{const n=void 0===e.renderRoot,a=e.defaultValue||Ls,o=t.useRef(null),r=Sr(e=>{Lr.modal(e?{content:e,mask:"closeAble"}:null),o.current=e}),s=Sr(()=>{r(null)}),{onChange:i,labelRender:l,toolsFilter:c,editableFilter:d}=e,[u,h]=t.useState(e.value||a);t.useMemo(()=>{h(e.value||a)},[a,e.value]);const m=Sr(e=>{u!==e&&i?.(e)}),p=Sr(e=>{if(e===u.name)return void m(void 0);let t,n;const a=nn.produce(u,(a,o)=>{if(o.path===e)return t=a,n=o.parent,!0},()=>{const e=n.children;e.splice(e.indexOf(t),1)});m(a)}),g=Sr((e,t,n)=>{if(r(null),n===u.name&&"replace"===t)return void m(e);const a=nn.produce(u,(a,o)=>{if(o.path===n){if("next"===t||"replace"===t){const n=o.parent.children;"next"===t?n.splice(n.indexOf(a)+1,0,e):n.splice(n.indexOf(a),1,e)}else a.children?a.children.unshift(e):a.children=[e];return!0}});m(a)}),f=Sr((e,t,n,a,o)=>{const i=o?.children,l=(i||[]).reduce((e,t)=>(e[t.name]=!0,e),{}),c=e.children?.[0];c&&(e={...e,subType:c.type}),r(React.createElement(_s,{item:e,parent:o,target:n,targetPath:a,place:t,nameExists:l,editableFilter:d,onCancel:s,onSubmit:g}))}),y=Sr(e=>{const t=nn.produce(u,(t,n)=>{if(n.path===e)return t.folded=!t.folded,!0});h(t)}),v=Sr(({path:e})=>React.createElement(vo,{name:wa,className:"ͼbaseflow-folder",onClick:()=>y(e)})),b=Sr(e=>{r(React.createElement(Cs,{item:e,onClose:s}))}),E=Sr(({node:e,parent:t,path:n})=>React.createElement(ks,{node:e,nodePath:n,parent:t,onDelItem:p,onEditItem:f,onExportItem:b,labelRender:l,toolsFilter:c}));return t.useEffect(()=>()=>{o.current&&r(null)},[]),React.createElement("div",{className:sn.classNames("ͼbaseflow-SchemaModelForm",e.variant,{showRootTools:e.showRootTools})},e.value?React.createElement(Ss,{namespace:"SchemaModelFormTree",source:u,nodeRender:E,folderRender:v,renderRoot:n}):React.createElement(vo,{className:"empty",name:ro,onClick:()=>m({...a})}))});var Ds=t.memo(({node:e,parent:n,labelRender:a,onSelect:o})=>{const r=t.useMemo(()=>En.toSchemaTitle(e,n,a),[e,n,a]);return React.createElement("div",{className:"ͼbaseflow-SchemaSelector__item"},React.createElement(vo,{name:e.type,className:"item-icon"}),React.createElement("span",{className:sn.classNames("item-title",{tips:r.tips,highlight:e.highlighted,disabled:e.disabled}),title:r.tips||e.id,onClick:()=>o?.(e)},r.title),e.optional&&React.createElement("span",{className:"ͼbaseflow-sr-optional"}))});var As=t.memo(({className:e,schema:t,onSwitch:n,onSelected:a,labelRender:o})=>{const r=Sr(e=>{a?.(e.id,e.type)}),s=Sr(({node:e})=>React.createElement(vo,{button:!0,name:wa,className:"ͼbaseflow-folder",onClick:()=>n?.(e.id)})),i=Sr(({node:e,parent:t})=>React.createElement(Ds,{parent:t,node:e,labelRender:o,onSelect:e.disabled?void 0:r}));return React.createElement("div",{className:sn.classNames("ͼbaseflow-SchemaSelector",e)},React.createElement(Ss,{renderRoot:!0,source:t,nodeRender:i,folderRender:s}))});var $s=t.memo(({node:e,parent:n,labelRender:a})=>{const o=t.useMemo(()=>En.toSchemaTitle(e,n,a),[a,e,n]);return React.createElement("div",{className:"ͼbaseflow-SchemaShow__item"},React.createElement(vo,{name:e.type,className:"item-icon"}),React.createElement("span",{className:sn.classNames("item-title",{tips:o.tips,highlight:e.highlighted,disabled:e.disabled}),title:o.tips||o.title},o.title),e.optional&&React.createElement("span",{className:"ͼbaseflow-sr-optional"}))});var Os=t.memo(({className:e,schema:n,labelRender:a})=>{const[o,r]=t.useState(n);t.useMemo(()=>{r(n)},[n]);const s=Sr(e=>{const t=nn.produce(o,(t,n)=>{if(n.path===e)return t.folded=!t.folded,!0});r(t)}),i=Sr(({path:e})=>React.createElement(vo,{button:!0,name:wa,className:"ͼbaseflow-folder",onClick:()=>s(e)})),l=Sr(({node:e,parent:t})=>React.createElement($s,{labelRender:a,parent:t,node:e}));return React.createElement("div",{className:sn.classNames("ͼbaseflow-SchemaShow",e)},React.createElement(Ss,{renderRoot:!0,source:o,nodeRender:l,folderRender:i}))});var Ps=t.memo(({className:e="",value:n="",title:a,onChange:o})=>{const r=t.useRef(null),[s,i]=t.useState(!1),[l,c]=t.useState(n),d=Sr(()=>{i(!1),n!==l&&(c(n),o?.(l))});return t.useMemo(()=>{c(n)},[n]),t.useEffect(()=>{s&&r.current?.focus()},[s]),React.createElement(React.Fragment,null,s?React.createElement("input",{ref:r,className:sn.classNames("ͼbaseflow-TextEditor__input",e),onBlur:d,onKeyDown:e=>"Enter"===e.key&&r.current.blur(),value:l,onChange:e=>{c(e.target.value.trim())}}):React.createElement("span",{className:"ͼbaseflow-TextEditor__title",title:a},n),React.createElement(vo,{title:ln.edit,name:Ta,className:"ͼbaseflow-TextEditor__editBtn",onClick:()=>i(!s)}))});var zs=t.memo(({dataType:e,mode:t,onChange:n})=>React.createElement(React.Fragment,null,React.createElement("span",{className:sn.classNames("item",{on:"assign"===t}),onClick:()=>{"assign"!==t&&n("assign")}},ln.assign),React.createElement("span",{className:sn.classNames("item",{on:"deconstruct"===t}),onClick:()=>"deconstruct"!==t&&n("deconstruct")},ln.deconstruct),(e===R.Array||e===R.Map)&&React.createElement("span",{className:sn.classNames("item",{on:"mapping"===t}),onClick:()=>"mapping"!==t&&n("mapping")},ln.mapping)));var Vs=t.memo(({className:e,node:n,index:a,schema:o,parent:r,parentSchema:s,labelRender:i,onItemNameChange:l,onItemValueChange:c,onItemModeChange:d,onAddItem:u,onDelItem:h,inputPropsRender:m})=>{const p=o.type,g=o.optional,f=p===R.Object||p===R.Array||p===R.Map,y=p===R.Array||p===R.Map,v=r?r.value.type:void 0,b=r?Hn.getValueMode(r):void 0,E=v===R.Array||v===R.Map,N=Hn.getValueMode(n),C=t.useContext(Nr),w=t.useMemo(()=>En.toSchemaTitle(o,s,i),[i,s,o]),S={addNext:r&&E&&"deconstruct"===b&&React.createElement("div",{className:"item",key:"addNext",title:ln.insertNext,onClick:()=>u(Hn.createSchemaValueTreeByModel(o,void 0,r.id,!0),a+1,r)},React.createElement(vo,{name:eo})),addSub:y&&"deconstruct"===N&&React.createElement("div",{className:"item",key:"addSub",title:ln.insertChild,onClick:()=>u(Hn.createSchemaValueTreeByModel(o.children[0],void 0,n.id,!0),0,n)},React.createElement(vo,{name:to})),delete:r&&E&&"deconstruct"===b&&React.createElement("div",{className:"item",key:"delete",title:ln.delete,onClick:()=>h(a,r)},React.createElement(vo,{name:Da}))},x=Sr(e=>{d(n,e)}),M=Sr(e=>c(n.id,e)),_=Sr(e=>{if(!r)return;if(!e)return void ra.message.error(ln.requiredPrompt);v===R.Array&&(e=`${Number(e)||0}`);const t=r.children||[];for(const n of t)if(n.name===e)return void ra.message.error(cn(ln.hasExist,{item:e}));l(e,n,r)}),I=[S.addNext,S.addSub,S.delete].filter(Boolean),k=t.useMemo(()=>{if(o.enums)return o.enums;if(o.type===R.Array){const e=o.children?.[0];return e?.enums}},[o]),L=m?.(o);return React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__item"},React.createElement("div",{className:sn.classNames("ͼbaseflow-SchemaValueForm__itemHead",e)},React.createElement(vo,{className:"item-icon",name:p}),E&&"deconstruct"===b?React.createElement(Ps,{value:n.name,onChange:_,title:w.tips||w.title}):React.createElement("span",{className:sn.classNames("item-title",{tips:w.tips}),title:w.tips||w.title},w.title),o.optional&&React.createElement("span",{className:"item-optional ͼbaseflow-sr-optional"}),(f||I.length>0)&&React.createElement("div",{className:"item-tools"},React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__itemTools"},f&&React.createElement(zs,{key:"ModeSwitch",dataType:p,mode:N,onChange:x}),I))),"mapping"===N&&React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__itemBody is-mapping"},React.createElement("img",{src:"data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%22192.207%20151.293%2065.95%20145.3553%22%20width%3D%2265.95px%22%20height%3D%22145.355px%22%20fill%3D%22%2379d600%22%3E%20%20%20%20%3Cg%3E%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M%20258.157%20184.268%20C%20258.157%20193.212%20254.343%20201.741%20248.499%20207.585%20C%20242.655%20213.429%20234.126%20217.243%20225.182%20217.243%20C%20216.238%20217.243%20207.709%20213.429%20201.865%20207.585%20C%20196.021%20201.741%20192.207%20193.212%20192.207%20184.268%20C%20192.207%20175.324%20196.021%20166.795%20201.865%20160.951%20C%20207.709%20155.107%20216.238%20151.293%20225.182%20151.293%20C%20234.126%20151.293%20242.655%20155.107%20248.499%20160.951%20C%20254.343%20166.795%20258.157%20175.324%20258.157%20184.268%20Z%20M%20245.317%20164.133%20C%20240.04%20158.857%20233.207%20155.793%20225.182%20155.793%20C%20217.157%20155.793%20210.324%20158.857%20205.047%20164.133%20C%20199.771%20169.41%20196.707%20176.243%20196.707%20184.268%20C%20196.707%20192.293%20199.771%20199.126%20205.047%20204.403%20C%20210.324%20209.679%20217.157%20212.743%20225.182%20212.743%20C%20233.207%20212.743%20240.04%20209.679%20245.317%20204.403%20C%20250.593%20199.126%20253.657%20192.293%20253.657%20184.268%20C%20253.657%20176.243%20250.593%20169.41%20245.317%20164.133%20Z%20M%20225.226%20291.953%20L%20242.179%20275.379%20C%20243%20274.576%20244.326%20274.622%20245.09%20275.48%20C%20245.873%20276.361%20245.821%20277.703%20244.972%20278.52%20L%20226.829%20295.986%20C%20225.906%20296.869%20224.406%20296.869%20223.482%20295.986%20C%20223.436%20295.941%20217.407%20290.129%20205.394%20278.55%20C%20204.54%20277.727%20204.489%20276.375%20205.28%20275.489%20C%20206.051%20274.625%20207.388%20274.578%20208.218%20275.387%20L%20225.226%20291.953%20Z%22%2F%3E%20%20%20%20%20%20%20%20%3Cline%20style%3D%22stroke%3A%20%2379d600%3B%20stroke-width%3A%205%3B%20stroke-dasharray%3A%2010%3B%22%20x1%3D%22224.937%22%20y1%3D%22223.794%22%20x2%3D%22225.427%22%20y2%3D%22281.854%22%2F%3E%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M%20226.676%20190.424%20L%20226.645%20196.582%20L%20227.231%20196.48%20C%20230.127%20195.977%20232.765%20194.436%20234.595%20192.287%20C%20236.424%20190.139%20237.566%20187.259%20237.566%20184.207%20C%20237.566%20182.322%20237.12%20180.476%20236.367%20178.876%20C%20236.036%20178.192%20235.795%20177.782%20235.45%20177.268%20L%20240.143%20172.934%20C%20240.148%20172.942%20240.155%20172.95%20240.162%20172.959%20C%20242.528%20176.11%20243.875%20179.957%20243.875%20184.207%20C%20243.875%20184.345%20243.875%20184.491%20243.875%20184.628%20C%20243.803%20188.654%20242.476%20192.295%20240.255%20195.328%20C%20238.035%20198.36%20235.006%20200.665%20231.407%20201.928%20C%20230.02%20202.415%20228.594%20202.747%20227.096%20202.902%20L%20226.649%20202.948%20L%20226.638%20208.846%20L%20218.709%20201.874%20L%20216.127%20199.608%20L%20220.799%20195.536%20L%20226.676%20190.424%20Z%20M%20206.49%20183.787%20C%20206.569%20179.726%20207.915%20176.057%20210.165%20173.01%20C%20212.415%20169.963%20215.483%20167.657%20219.127%20166.418%20C%20220.446%20165.965%20221.805%20165.657%20223.246%20165.511%20L%20223.694%20165.466%20L%20223.704%20159.567%20L%20231.622%20166.527%20L%20234.204%20168.805%20L%20229.543%20172.866%20L%20223.664%20177.991%20L%20223.685%20171.843%20L%20223.099%20171.946%20C%20220.209%20172.455%20217.579%20173.999%20215.757%20176.146%20C%20213.935%20178.293%20212.799%20181.167%20212.799%20184.207%20C%20212.799%20186.104%20213.244%20187.945%20214.007%20189.557%20C%20214.331%20190.249%20214.578%20190.646%20214.916%20191.147%20L%20210.235%20195.49%20C%20210.204%20195.448%20210.273%20195.546%20210.14%20195.358%20C%20207.818%20192.216%20206.49%20188.411%20206.49%20184.207%20C%20206.49%20184.069%20206.49%20183.923%20206.49%20183.787%20Z%22%2F%3E%20%20%20%20%3C%2Fg%3E%3C%2Fsvg%3E",className:"loop-icon",title:ln.loopContextPrompt}),React.createElement(Wr,{sourceType:"mapping",dataType:p,value:n.value,context:C,onChange:M,...L})),"assign"===N&&React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__itemBody"},React.createElement(Wr,{hideIcon:!0,value:n.value,nativeRenderOptions:k,onChange:M,dataType:p,optional:g,context:C,...L})))});const Bs={name:"mock",type:R.Any};var js=t.memo(({schema:e=Bs,value:n,labelRender:a,onChange:o,inputPropsRender:r,showRootTools:s,variant:i})=>{const[,l]=t.useState(0),c=t.useRef({}),d=Sr(e=>{if(c.current.valueTree!==e){const t=nn.map(e,({name:e,value:t,folded:n})=>({name:e,value:t,folded:n}));c.current.value=t,c.current._valueTree=e,o?.(t)}}),u=Sr(()=>{if(c.current.schema===Bs)void 0!==c.current.value&&o?.(void 0);else{const e=Hn.createSchemaValueTreeByModel(c.current.schemaTree,c.current.valueTree,void 0,!0);d(e)}});t.useMemo(()=>{const t=!c.current.schema,a=c.current.schema!==e,o=c.current.value!==n;if(a){c.current.schema=e;const t=En.toSchemaModelTree(e);c.current.schemaTree=t,c.current.schemaMap=nn.toMap(t)}if(c.current.matchError=e===Bs?"Schema is undefined":void 0,t||o){const t=c.current.schemaTree;if(c.current.value=n,n){const a=e===Bs?"Schema is undefined":Hn.matchSchemaValueByModel(t,n);a?(c.current.matchError=a,c.current.valueTree=Hn.toSchemaValueTree([n],"")[0]):c.current.valueTree=Hn.createSchemaValueTreeByModel(t,n,void 0,!0)}else c.current.valueTree=Hn.createSchemaValueTreeByModel(t,void 0,void 0,!0);c.current._valueTree=c.current.valueTree}else if(a){const e=Hn.createSchemaValueTreeByModel(c.current.schemaTree,c.current.value,void 0,!0);d(e)}else c.current.valueTree=c.current._valueTree},[e,n]);const h=c.current.schemaMap,m=c.current.valueTree,p=Sr(e=>{const t=nn.produce(m,t=>{if(e.id===t.id)return t.folded=!t.folded,!0});c.current.value=t,c.current.valueTree=t,l(Date.now())}),g=Sr((e,t)=>{const n=Hn.setValueMode(e,h[e.schemaId],t),a=nn.produce(m,t=>{if(e.id===t.id)return t.value=n.value,t.children=n.children,!0});d(a)}),f=Sr((e,t)=>{const n=nn.produce(m,n=>{if(e===n.id)return n.value=t,!0});d(n)}),y=Sr((e,t,n)=>{let a=m;if(n.value.type===R.Array){let o=n.children.map(n=>n.id===t.id?{...n,name:e}:n);o.sort((e,t)=>Number(e.name)-Number(t.name));let r=0;for(;o[r]&&o[r]===n.children[r];)r++;o=o.slice(r),o=o.map((e,t)=>({...e,name:`${t+r}`})),o=Hn.toSchemaValueTree(o,n.id),a=nn.produce(m,e=>{if(n.id===e.id)return e.children.splice(r,e.children.length-r,...o),!0})}else{let o={...t,name:e};o=Hn.toSchemaValueTree([o],n.id)[0],a=nn.produce(m,e=>{if(t.id===e.id)return e.id=o.id,e.name=o.name,e.children=o.children,!0})}d(a)}),v=Sr((e,t,n)=>{let a=m;if(n.value.type===R.Array){let o=(n.children||[]).slice(t);o.unshift(e),o=o.map((e,n)=>({...e,name:`${n+t}`})),o=Hn.toSchemaValueTree(o,n.id),a=nn.produce(m,e=>{if(n.id===e.id)return e.children.splice(t,e.children.length-t,...o),!0})}else{const o=(n.children||[]).reduce((e,t)=>(e[t.name]=!0,e),{});let r=[{...e,name:Hn.createNoDuplicateKey(o)}];r=Hn.toSchemaValueTree(r,n.id),a=nn.produce(m,e=>{if(n.id===e.id)return e.children.splice(t,0,r[0]),!0})}d(a)}),b=Sr((e,t)=>{let n=m;if(t.value.type===R.Array){let a=(t.children||[]).slice(e);a.shift(),a.length&&(a=a.map((t,n)=>({...t,name:`${n+e}`})),a=Hn.toSchemaValueTree(a,t.id)),n=nn.produce(m,n=>{if(t.id===n.id)return n.children.splice(e,n.children.length-e,...a),n.children.length||(n.value.source=I.Variable,n.value.text="",n.children=void 0),!0})}else n=nn.produce(m,n=>{if(t.id===n.id)return n.children.splice(e,1),n.children.length||(n.value.source=I.Variable,n.value.text="",n.children=void 0),!0});d(n)}),E=Sr(({node:e})=>React.createElement(vo,{name:wa,className:"ͼbaseflow-folder",onClick:()=>p(e)})),N=Sr(({node:e,parent:t,index:n})=>{const o=h[e.schemaId];if(!o){const t=Hn.getValueMode(e);return React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__item invalid"},React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__itemHead"},React.createElement(vo,{className:"item-icon",name:e.value.type}),React.createElement("span",null,e.name)),"assign"===t&&React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__itemBody"},React.createElement("div",{className:"superInput"},e.value.text)))}return React.createElement(Vs,{className:!t&&s?"showRootTools":"",index:n,node:e,schema:o,parent:t,parentSchema:t?h[t.schemaId]:void 0,labelRender:a,onItemNameChange:y,onItemValueChange:f,onItemModeChange:g,onAddItem:v,onDelItem:b,inputPropsRender:r})}),C=Sr(({node:e,contextValue:t})=>{if("mapping"===Hn.getValueMode(e)){let n=$n.getValidContextRef(e.value);return new RegExp(xn).test(n)&&(n=t&&/\D/.test(t)?n.replace(Cn,`${t}[0]`):""),n}}),w=Sr(({node:e,isLast:t,isLeaf:n})=>{if(t&&n)return{className:"ͼbaseflow-last"}});return c.current.schema!==Bs||c.current.value?React.createElement("div",{className:sn.classNames("ͼbaseflow-SchemaValueForm",i)},c.current.matchError&&React.createElement("div",{className:"ͼbaseflow-SchemaValueForm__matchError"},React.createElement("div",{className:"tools"},React.createElement("div",{className:"tips"},React.createElement("span",null,ln.invalidTips),React.createElement("div",{className:"msg"},c.current.matchError)),React.createElement(Lr.Button,{type:"link",size:"small",icon:React.createElement(vo,{name:io}),onClick:u},ln.fix))),React.createElement(Ss,{namespace:"SchemaValueFormTree",source:m,nodeRender:N,folderRender:E,contextValueRender:C,attributeRender:w,context:Nr,renderRoot:!0})):null});function Fs(e,t,n,a,o){let r=e;if(e.childrenIds.length&&e.childrenIds.forEach(s=>{const i=t[s];if(m.isRoute(e.type)){const t=o({id:"e"+a.n++,source:{id:e.id,port:"out2",type:e.type},target:{id:s,port:"in",type:i.type},routeFork:!0,markerEnd:!0}),r=o({id:"e"+a.n++,source:{id:s,port:"out",type:i.type},target:{id:e.id,port:"in2",type:e.type},routeFork:!0,markerEnd:!1});n.push(t,r)}else{const t=o({id:"e"+a.n++,source:{id:r.id,port:r===e?"out2":"out",type:r.type},target:{id:s,port:"in",type:i.type},routeFork:!1,markerEnd:!0});n.push(t),r=i}Fs(i,t,n,a,o)}),r!==e){const t=o({id:"e"+a.n++,source:{id:r.id,port:"out",type:r.type},target:{id:e.id,port:"in2",type:e.type},routeFork:!1,markerEnd:!1});n.push(t)}}function Hs(e,t,n){const a=[],o=[];return e.forEach(e=>{const r=e.getChildren();if(r){const{width:a,height:o}=e.getOptions(),s=30,i=30,l=o+n;let c,d;const u=n;if(r.length){const{widths:o,heights:s}=Hs(r,t,n);if(m.isRoute(e.getType())){const e=o.reduce((e,t)=>e+t,0)+t*(o.length-1);c=Math.max(a,e),d=Math.max(...s)}else c=Math.max(a,...o),d=s.reduce((e,t)=>e+t,0)+n*(s.length-1)}else c=a,d=-u;e.setWidth(s+c+i),e.setHeight(l+d+u)}a.push(e.getWidth()),o.push(e.getHeight())}),{widths:a,heights:o}}function Zs(e,t,n){const a=e.getWidth(),o=e.getChildren();if(o&&o.length){const{height:r}=e.getOptions(),s=r+n,i=30;if(m.isRoute(e.getType())){let e=i;o.forEach(a=>{a.setPosition({x:e,y:s}),e=e+a.getWidth()+t;const o=a.getChildren();o&&o.length&&Zs(a,t,n)})}else{let e=s;o.forEach(o=>{o.setPosition({x:(a-o.getWidth())/2,y:e}),e=e+o.getHeight()+n;const r=o.getChildren();r&&r.length&&Zs(o,t,n)})}}}function Ys(e){const t=e.getChildren();t&&t.length&&t.forEach(t=>{t.setPosition({x:e.getX()+t.getX(),y:e.getY()+t.getY()});const n=t.getChildren();n&&n.length&&Ys(t)})}class Xs{id;data;size;position;children;constructor(e){this.id=e.id,this.data=e,this.size={width:e.meta.width||250,height:e.meta.height||50},this.position={x:0,y:0},this.children=m.isContainer(this.getType())?[]:void 0}getWidth(){return this.size.width}getHeight(){return this.size.height}setWidth(e){this.size.width=e}setHeight(e){this.size.height=e}getType(){return this.data.type}getOptions(){return{width:this.data.meta.width||250,height:this.data.meta.height||50}}getChildren(){return this.children}addChild(e){this.children?.push(e)}getX(){return this.position.x}getY(){return this.position.y}setPosition(e){this.position=e}}function Us(e,t,n){const a=new Xs(e);return n[e.id]=a,!e.folded&&e.childrenIds.length&&(a.children=e.childrenIds.map(e=>Us(t[e],t,n))),a}function Gs(e){const t={},n={};let a=null;e.forEach(e=>{e.parentId||(a=e),t[e.id]=e});const o=Us(a,t,n);return Hs([o],30,62),Zs(o,30,62),Ys(o),n}const qs=({className:e,header:n,children:a})=>{const[o,r]=t.useState(!1),s=Sr(()=>{r(!o)});return React.createElement("div",{className:sn.classNames("ͼbaseflow-ExpandPanel",e)},React.createElement("div",{className:"hd"},React.createElement(vo,{button:!0,name:wa,className:sn.classNames("icon",{on:o}),onClick:s}),n),React.createElement("div",{className:"bd"},React.createElement("div",{className:sn.classNames("container",o?"noScoller":"scoller")},a)))};var Ks=t.memo(({style:e,namespace:t,nodeRender:n,attributeRender:a,onSwitch:o,source:r})=>{const s=Sr(({node:e,parent:n,folded:a,isLeaf:r,isFirst:s,isLast:i,isEnd:l,isBegin:c,isFinish:d})=>{const u=!!n&&m.isRoute(n.data),h=!!n&&m.isFork(n.data);return React.createElement(React.Fragment,null,!u&&React.createElement("div",{className:`ͼbaseflow-${t}-lineNext`}),(s||u)&&!c&&React.createElement("div",{className:`ͼbaseflow-${t}-lineIn`}),(i||u)&&!d&&React.createElement("div",{className:`ͼbaseflow-${t}-lineOut`},!l&&!h&&React.createElement("span",{className:`ͼbaseflow-${t}-lineOutArrow`})),!r&&React.createElement("div",{className:`ͼbaseflow-${t}-NodeCollapse${a?" ͼbaseflow-folded":""}`,onClick:()=>o(e.id)},React.createElement(vo,{name:Xa}),React.createElement(vo,{name:Ua})))});return React.createElement(Ss,{style:e,namespace:t,nodeRender:n,folderRender:s,attributeRender:a,source:r})});var Qs=t.memo(({className:e,value:n="",onSubmit:a})=>{const o=t.useRef(null),r=t.useCallback(e=>{e.nativeEvent.stopPropagation()},[]),s=t.useCallback(e=>{a(e.target.value.trim())},[a]);return t.useEffect(()=>{o.current?.focus()},[]),React.createElement("input",{className:e,ref:o,onMouseDownCapture:r,onClickCapture:r,defaultValue:n,onBlur:s,onKeyDown:e=>"Enter"===e.key&&o.current.blur()})});var Ws=t.memo(({icon:e,status:t,message:n,mocked:a,...o})=>React.createElement("div",{...o,className:sn.classNames("ͼbaseflow-Flow__NodeIcon",t,{mocked:a}),onMouseEnter:e=>{n?Lr.tooltip({content:n,target:e.target}):a&&Lr.tooltip({content:"disabled!",target:e.target})}},React.createElement("img",{src:e})));const Js="rename",ei="resetId",ti="disable",ni="enable",ai="remove";var oi=t.memo(({node:e,nodeData:t,onSelect:a})=>{const o=e.getSource();return React.createElement("div",{className:"ͼbaseflow-Flow__NodeMenu"},React.createElement("div",null,React.createElement("div",{className:"menu-item",onClick:()=>a(Js)},n.rename),m.reidAble(t.type)&&React.createElement("div",{className:"menu-item",onClick:()=>a(ei)},n.resetId),m.mockAble(t.type)?t.meta.mockState?React.createElement("div",{className:"menu-item",onClick:()=>a(ni)},n.enable):React.createElement("div",{className:"menu-item",onClick:()=>a(ti)},n.disable):null,m.deleteAble(t.type)&&React.createElement("div",{className:"menu-item",onClick:()=>a(ai)},n.delete),React.createElement("div",{className:"menu-item",onMouseEnter:e=>Lr.tooltip({content:`${o.name}@${o.actualVersion}（${o.formalVersion}）`,target:e.target})},`©${n.version}`)))});var ri=t.memo(({className:e,value:n="",onSubmit:a})=>{const o=t.useRef(null),r=t.useCallback(e=>{e.nativeEvent.stopPropagation()},[]);return t.useEffect(()=>{const e=o.current;if(e){e.focus();const t=document.createRange();t.selectNodeContents(e),t.collapse(!1);const n=window.getSelection();n?.removeAllRanges(),n?.addRange(t)}},[]),React.createElement("div",{className:e,ref:o,onMouseDownCapture:r,onClickCapture:r,contentEditable:!0,onBlur:e=>{a(e.target.innerText.trim())}},n?n.split("\n").map(e=>React.createElement("div",{key:e},e)):React.createElement("br",null))});var si=t.memo(({node:e,nodeData:n,graph:a})=>{const o=e.getConfig(),r=t.useRef(null),s=n.meta.name||`${n.tag}-???`,i=n.id,l=n.meta.summary||"",c=n.meta.remark||"",d=Boolean(n.meta.mockState),u=e.getStatus(),h=e.getErrors(),[m,p]=t.useState(!1),[g,f]=t.useState(!1),[y,v]=t.useState(!1),b=t.useCallback(t=>{p(!1),t&&t!==s&&e.updateMeta({name:t})},[s,e]),E=t.useCallback(t=>{f(!1),t!==i&&setTimeout(()=>{const n=e.resetId(t);n&&ra.message.error(n)})},[i,e]),N=t.useCallback(t=>{v(!1),t!==c&&e.updateMeta({remark:t})},[e,c]),C=t.useCallback(t=>{if(t===ai)try{e.remove()}catch(e){throw ra.message.error(e.message||e),e}else if(t===Js)p(!0);else if(t===ei)f(!0);else if(t===ti){const t=e.setMockState(!0);t&&ra.message.error(t)}else t===ni&&e.setMockState(void 0);Lr.popup(null)},[e]),w=Sr(t=>{t.nativeEvent.stopPropagation(),Lr.popup({content:React.createElement(oi,{node:e,nodeData:n,onSelect:C}),target:t.target,offset:{left:"-20px",top:"-8px"}})}),S=t.useCallback(t=>{t.nativeEvent.stopPropagation(),e.updateMeta({remark:""})},[e]);return t.useEffect(()=>{if(a.isInited()){const t=r.current.offsetHeight;t&&t!==n.meta.height&&e.updateMeta({height:t})}},[n.meta.summary,n.meta.remark]),t.useEffect(()=>e.addListener("showMenu",()=>{const e=r.current.querySelector(".node-menu");e&&(a.reselect(""),e.click())})),React.createElement("div",{className:sn.classNames("ͼbaseflow-Flow__NodeItem",u,{mocked:d}),id:`bf_nd_${i}`,ref:r},React.createElement("div",{className:"ͼbaseflow-Flow__NodeHeader"},React.createElement(Ws,{icon:o.icon,status:u,mocked:d,message:h.configurationErrors||h.referenceErrors}),m?React.createElement(Qs,{className:"ͼbaseflow-Flow__NodeName input",value:s,onSubmit:b}):React.createElement("div",{className:"ͼbaseflow-Flow__NodeName"},s),g?React.createElement(Qs,{className:"ͼbaseflow-Flow__NodeId input",value:i,onSubmit:E}):React.createElement("div",{className:"ͼbaseflow-Flow__NodeId"},`ID: ${i}`),!m&&!g&&React.createElement(vo,{className:"node-menu",name:po,onClickCapture:w}),!g&&React.createElement("div",{className:"node-version"},`v${o.version}`)),React.createElement("div",{className:"ͼbaseflow-Flow__NodeFacade"},y?React.createElement(ri,{className:"ͼbaseflow-Flow__NodeSummary input",value:c,onSubmit:N}):React.createElement(React.Fragment,null,React.createElement(vo,{className:"edit-btn",name:Ta,onClickCapture:e=>{e.nativeEvent.stopPropagation(),v(!0)}}),React.createElement(Lr.DescMD,{className:sn.classNames("ͼbaseflow-Flow__NodeSummary",{remarked:c}),value:c||l}),c&&React.createElement(vo,{className:"clear-btn",name:La,onClickCapture:S}))))});var ii=t.memo(({device:e,graph:a})=>{const o=a.get_NodeById(e.id),r=o.getData(),i=o.getSize(),l=t.useRef(void 0),c=o.getType(),d=o.isContainer();return React.createElement("div",{className:"ͼbaseflow-CodeFlow__node"},React.createElement("div",{ref:l,"data-baseflow-role":sn.domRoles.FlowNode,"data-baseflow-node":o.id,className:"ͼbaseflow-Flow__NodeWraper",style:i},React.createElement(si,{node:o,nodeData:r,graph:a})),React.createElement("div",{className:"ͼbaseflow-CodeFlow__actions",style:{height:i.height}},c!==s.End&&c!==s.Return&&c!==s.Break&&!o.isDefaultBranch()&&React.createElement(vo,{name:ao,"data-baseflow":"ͼbaseflow-flow-node-plus","data-action":`behind::${o.id}`,onMouseEnter:e=>Lr.tooltip({content:n.insertNext,target:e.target}),onClick:()=>a.showCreator({sourceNode:o,place:"behind",target:l.current})}),d&&React.createElement(vo,{name:oo,"data-baseflow":"ͼbaseflow-flow-node-plus","data-action":`inside::${o.id}`,onMouseEnter:e=>Lr.tooltip({content:n.insertChild,target:e.target}),onClick:()=>a.showCreator({sourceNode:o,place:"inside",target:l.current})})))});var li=t.memo(({graph:e,initialLayoutData:n,initialViewport:a})=>{const[o,r]=t.useState(n),[s,i]=t.useState(a.zoom),l=t.useRef(null),c=t.useRef(void 0),d=t.useRef(!1),u=Sr(()=>o),h=t.useCallback(e=>{i(e),d.current=!0},[]),m=t.useCallback(e=>{h(e.zoom),l.current.scrollLeft=e.x,l.current.scrollTop=e.y},[h]),p=Sr(()=>{const e=l.current;return{zoom:s,x:e.scrollLeft,y:e.scrollTop}}),g=t.useCallback((e,t)=>{r(e),t&&m(t),d.current=!0},[m]),f=Sr(()=>{const e=o.nodes,t=c.current?.ids||{};c.current=void 0;const n=nn.produce(e,e=>{t[e.id]&&(e.key=(e.key||0)+1)});e!==n&&g({...o,nodes:n})}),y=Sr((e,t)=>{const n=o.nodes,a=nn.produce(n,n=>{if(e===n.id)return n.id=t,!0});n!==a&&g({...o,nodes:a})}),v=Sr((e,t)=>{const n=o.nodes,a=nn.produce(n,n=>{if(e===n.id&&Boolean(n.folded)!==t)return n.folded=t,!0});n!==a&&g({...o,nodes:a})}),b=Sr((e,t)=>{const n=e.reduce((e,t)=>(e[t.id]=t,e),{}),a=[];e.forEach(e=>{e.parentId===t.id&&a.push(sa(e,n))});const r=t.childrenIds,s=o.nodes,i=nn.produce(s,e=>{if(e.id===t.id){const t=(e.children||[]).concat(a).reduce((e,t)=>(e[t.id]=t,e),{});return e.children=r.map(e=>t[e]),!0}});s!==i&&g({...o,nodes:i})}),E=Sr((e,t)=>{const n=o.nodes,a=Qt(n,e=>{const n={};nn.each(e,e=>{n[e.id]=e}),Object.keys(t).forEach(e=>{const a=n[e],o=t[e];a.children=a.children.filter(e=>!o[e.id])})});n!==a&&g({...o,nodes:a})}),N=Sr(e=>{const t=o.nodes,n=Qt(t,t=>{const n={};nn.each(t,e=>{n[e.id]=e}),Object.keys(e).forEach(t=>{n[t].children=e[t].map(e=>n[e])})});t!==n&&g({...o,nodes:n})});t.useEffect(()=>{const t=e=>{c.current||(c.current={timer:setTimeout(f),ids:{}}),c.current.ids[e]=!0},n=l.current;n.scrollLeft=a.x,n.scrollTop=a.y;const o={getData:u,setData:g,setViewport:m,setCenter(t){const n=e.getNodeDomById(t);n&&n.scrollIntoView({behavior:"smooth"})},resetNodeId:y,refreshNodeSize:t,refreshNodeUI:t,getViewport:p,zoomTo:h,zoomFit(){const e=l.current,t=e.scrollHeight,n=e.clientHeight/t,a=n>1?1:n<.1?.1:n;return e.scrollTop=0,h(a),a},foldNode:v,addNodes:b,deleteNodes:E,moveNodes:N};e.setFlowLayout(o),e.onLayoutRendered({layout:"code",layoutData:u(),viewport:p()}),e.onResized()},[]);const C=t.useCallback(({node:t})=>React.createElement(ii,{device:t,graph:e}),[e]),w=t.useCallback(({node:e})=>({"data-baseflow-role":sn.domRoles.FlowNodeRange,"data-baseflow-node":e.id}),[]),S=t.useMemo(()=>({transform:`scale(${s})`}),[s]);return t.useEffect(()=>{d.current&&(d.current=!1,e.onResized())}),React.createElement("div",{className:"ͼbaseflow-CodeFlow",ref:l,onScroll:e.onResized,"data-baseflow-role":sn.domRoles.GraphContiner},React.createElement(Ks,{namespace:"CodeLayoutTree",style:S,source:o.nodes,nodeRender:C,attributeRender:w,onSwitch:e.foldNode}))});function ci(e){return{id:e.id,position:{x:0,y:0},type:"DagreNode",data:{size:{width:0,height:0}}}}function di(e){const t={id:e.id,source:e.source.id,sourceHandle:e.source.port,target:e.target.id,targetHandle:e.target.port,className:e.source.type};return e.routeFork&&(t.type="DagreEdge"),e.markerEnd||(t.markerEnd=""),t}function ui(e,t){try{const t=function(e,t){const n={};let a=null;e.forEach(e=>{e.parentId||(a=e),n[e.id]=e});const o=[];return Fs(a,n,o,{n:Date.now()},t.toDagreEdge),{nodes:e.map(e=>t.toDagreNode(e)),edges:o}}(e,{toDagreNode:ci,toDagreEdge:di});let n;const a=e.reduce((e,t)=>(t.parentId||(n=t),e[t.id]=t,e),{}),o={};ma(a,n.id,(e,t)=>{o[e.id]=t.folded||o[t.id]});const r=Gs(e);t.nodes.forEach(e=>{e.hidden=o[e.id],r[e.id]&&(e.position=r[e.id].position,e.data.size=r[e.id].size)});const{nodes:s,edges:i}=t;return{nodes:s.filter(e=>e.id!==n.id),edges:i.filter(e=>e.source!==n.id&&e.target!==n.id)}}catch(e){return console.error(e),{nodes:[],edges:[]}}}function hi(e,t){const n=Gs(t.nodes);return e.map(e=>{if(n[e.id]){const t=n[e.id].size,a=n[e.id].position,o=e.data.size,r=e.position;if(o.width!==t.width||o.height!==t.height||r.x!==a.x||r.y!==a.y)return{...e,position:a,data:{size:t}}}return e})}function mi(e,t){const n=e.reduce((e,t)=>(e[`${t.source}-${t.target}`]=t,e),{}),a=function(e,t){const n={};let a=null;e.forEach(e=>{e.parentId||(a=e),n[e.id]=e});const o=[];return Fs(a,n,o,{n:Date.now()},t),o}(t,di);return a.map(e=>{const t=`${e.source}-${e.target}`;return n[t]?n[t]:e})}function pi(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,a=0;a<e.length;a++)""!==(n=pi(e[a]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var gi,fi,yi,vi,bi={exports:{}},Ei={},Ni={exports:{}},Ci={};function wi(){return fi||(fi=1,Ni.exports=function(){if(gi)return Ci;gi=1;var e=t,n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=e.useState,o=e.useEffect,r=e.useLayoutEffect,s=e.useDebugValue;function i(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!n(e,a)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),l=a({inst:{value:n,getSnapshot:t}}),c=l[0].inst,d=l[1];return r(function(){c.value=n,c.getSnapshot=t,i(c)&&d({inst:c})},[e,n,t]),o(function(){return i(c)&&d({inst:c}),e(function(){i(c)&&d({inst:c})})},[e]),s(n),n};return Ci.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,Ci}()),Ni.exports}var Si=(vi||(vi=1,bi.exports=function(){if(yi)return Ei;yi=1;var e=t,n=wi(),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=n.useSyncExternalStore,r=e.useRef,s=e.useEffect,i=e.useMemo,l=e.useDebugValue;return Ei.useSyncExternalStoreWithSelector=function(e,t,n,c,d){var u=r(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=i(function(){function e(e){if(!s){if(s=!0,o=e,e=c(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return r=t}return r=e}if(t=r,a(o,e))return t;var n=c(e);return void 0!==d&&d(t,n)?(o=e,t):(o=e,r=n)}var o,r,s=!1,i=void 0===n?null:n;return[function(){return e(t())},null===i?void 0:function(){return e(i())}]},[t,n,c,d]);var m=o(e,u[0],u[1]);return s(function(){h.hasValue=!0,h.value=m},[m]),l(m),m},Ei}()),bi.exports),xi=E(Si);const Ri=e=>{let t;const n=new Set,a=(e,a)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=a?a:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,r={setState:a,getState:o,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},s=t=e(a,o,r);return r},{useDebugValue:Mi}=t,{useSyncExternalStoreWithSelector:_i}=xi,Ii=e=>e;function ki(e,t=Ii,n){const a=_i(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Mi(a),a}const Li=(e,t)=>{const n=(e=>e?Ri(e):Ri)(e),a=(e,a=t)=>ki(n,e,a);return Object.assign(a,n),a};function Ti(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,a]of e)if(!Object.is(a,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const a of n)if(!Object.prototype.hasOwnProperty.call(t,a)||!Object.is(e[a],t[a]))return!1;return!0}var Di={value:()=>{}};function Ai(){for(var e,t=0,n=arguments.length,a={};t<n;++t){if(!(e=arguments[t]+"")||e in a||/[\s.]/.test(e))throw new Error("illegal type: "+e);a[e]=[]}return new $i(a)}function $i(e){this._=e}function Oi(e,t){for(var n,a=0,o=e.length;a<o;++a)if((n=e[a]).name===t)return n.value}function Pi(e,t,n){for(var a=0,o=e.length;a<o;++a)if(e[a].name===t){e[a]=Di,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=n&&e.push({name:t,value:n}),e}$i.prototype=Ai.prototype={constructor:$i,on:function(e,t){var n,a,o=this._,r=(a=o,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!a.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),s=-1,i=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<i;)if(n=(e=r[s]).type)o[n]=Pi(o[n],e.name,t);else if(null==t)for(n in o)o[n]=Pi(o[n],e.name,null);return this}for(;++s<i;)if((n=(e=r[s]).type)&&(n=Oi(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $i(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,a,o=new Array(n),r=0;r<n;++r)o[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=0,n=(a=this._[e]).length;r<n;++r)a[r].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],o=0,r=a.length;o<r;++o)a[o].value.apply(t,n)}};var zi="http://www.w3.org/1999/xhtml",Vi={svg:"http://www.w3.org/2000/svg",xhtml:zi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Bi(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Vi.hasOwnProperty(t)?{space:Vi[t],local:e}:e}function ji(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===zi&&t.documentElement.namespaceURI===zi?t.createElement(e):t.createElementNS(n,e)}}function Fi(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Hi(e){var t=Bi(e);return(t.local?Fi:ji)(t)}function Zi(){}function Yi(e){return null==e?Zi:function(){return this.querySelector(e)}}function Xi(){return[]}function Ui(e){return null==e?Xi:function(){return this.querySelectorAll(e)}}function Gi(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}function qi(e){return function(){return this.matches(e)}}function Ki(e){return function(t){return t.matches(e)}}var Qi=Array.prototype.find;function Wi(){return this.firstElementChild}var Ji=Array.prototype.filter;function el(){return Array.from(this.children)}function tl(e){return new Array(e.length)}function nl(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function al(e,t,n,a,o,r){for(var s,i=0,l=t.length,c=r.length;i<c;++i)(s=t[i])?(s.__data__=r[i],a[i]=s):n[i]=new nl(e,r[i]);for(;i<l;++i)(s=t[i])&&(o[i]=s)}function ol(e,t,n,a,o,r,s){var i,l,c,d=new Map,u=t.length,h=r.length,m=new Array(u);for(i=0;i<u;++i)(l=t[i])&&(m[i]=c=s.call(l,l.__data__,i,t)+"",d.has(c)?o[i]=l:d.set(c,l));for(i=0;i<h;++i)c=s.call(e,r[i],i,r)+"",(l=d.get(c))?(a[i]=l,l.__data__=r[i],d.delete(c)):n[i]=new nl(e,r[i]);for(i=0;i<u;++i)(l=t[i])&&d.get(m[i])===l&&(o[i]=l)}function rl(e){return e.__data__}function sl(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function il(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ll(e){return function(){this.removeAttribute(e)}}function cl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function dl(e,t){return function(){this.setAttribute(e,t)}}function ul(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function hl(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function ml(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function pl(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function gl(e){return function(){this.style.removeProperty(e)}}function fl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function yl(e,t,n){return function(){var a=t.apply(this,arguments);null==a?this.style.removeProperty(e):this.style.setProperty(e,a,n)}}function vl(e,t){return e.style.getPropertyValue(t)||pl(e).getComputedStyle(e,null).getPropertyValue(t)}function bl(e){return function(){delete this[e]}}function El(e,t){return function(){this[e]=t}}function Nl(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Cl(e){return e.trim().split(/^|\s+/)}function wl(e){return e.classList||new Sl(e)}function Sl(e){this._node=e,this._names=Cl(e.getAttribute("class")||"")}function xl(e,t){for(var n=wl(e),a=-1,o=t.length;++a<o;)n.add(t[a])}function Rl(e,t){for(var n=wl(e),a=-1,o=t.length;++a<o;)n.remove(t[a])}function Ml(e){return function(){xl(this,e)}}function _l(e){return function(){Rl(this,e)}}function Il(e,t){return function(){(t.apply(this,arguments)?xl:Rl)(this,e)}}function kl(){this.textContent=""}function Ll(e){return function(){this.textContent=e}}function Tl(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Dl(){this.innerHTML=""}function Al(e){return function(){this.innerHTML=e}}function $l(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Ol(){this.nextSibling&&this.parentNode.appendChild(this)}function Pl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function zl(){return null}function Vl(){var e=this.parentNode;e&&e.removeChild(this)}function Bl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function jl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Fl(e){return function(){var t=this.__on;if(t){for(var n,a=0,o=-1,r=t.length;a<r;++a)n=t[a],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function Hl(e,t,n){return function(){var a,o=this.__on,r=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var s=0,i=o.length;s<i;++s)if((a=o[s]).type===e.type&&a.name===e.name)return this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=r,a.options=n),void(a.value=t);this.addEventListener(e.type,r,n),a={type:e.type,name:e.name,value:t,listener:r,options:n},o?o.push(a):this.__on=[a]}}function Zl(e,t,n){var a=pl(e),o=a.CustomEvent;"function"==typeof o?o=new o(t,n):(o=a.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Yl(e,t){return function(){return Zl(this,e,t)}}function Xl(e,t){return function(){return Zl(this,e,t.apply(this,arguments))}}nl.prototype={constructor:nl,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},Sl.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Ul=[null];function Gl(e,t){this._groups=e,this._parents=t}function ql(){return new Gl([[document.documentElement]],Ul)}function Kl(e){return"string"==typeof e?new Gl([[document.querySelector(e)]],[document.documentElement]):new Gl([[e]],Ul)}function Ql(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var a=n.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,[(a=a.matrixTransform(t.getScreenCTM().inverse())).x,a.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}Gl.prototype=ql.prototype={constructor:Gl,select:function(e){"function"!=typeof e&&(e=Yi(e));for(var t=this._groups,n=t.length,a=new Array(n),o=0;o<n;++o)for(var r,s,i=t[o],l=i.length,c=a[o]=new Array(l),d=0;d<l;++d)(r=i[d])&&(s=e.call(r,r.__data__,d,i))&&("__data__"in r&&(s.__data__=r.__data__),c[d]=s);return new Gl(a,this._parents)},selectAll:function(e){e="function"==typeof e?Gi(e):Ui(e);for(var t=this._groups,n=t.length,a=[],o=[],r=0;r<n;++r)for(var s,i=t[r],l=i.length,c=0;c<l;++c)(s=i[c])&&(a.push(e.call(s,s.__data__,c,i)),o.push(s));return new Gl(a,o)},selectChild:function(e){return this.select(null==e?Wi:function(e){return function(){return Qi.call(this.children,e)}}("function"==typeof e?e:Ki(e)))},selectChildren:function(e){return this.selectAll(null==e?el:function(e){return function(){return Ji.call(this.children,e)}}("function"==typeof e?e:Ki(e)))},filter:function(e){"function"!=typeof e&&(e=qi(e));for(var t=this._groups,n=t.length,a=new Array(n),o=0;o<n;++o)for(var r,s=t[o],i=s.length,l=a[o]=[],c=0;c<i;++c)(r=s[c])&&e.call(r,r.__data__,c,s)&&l.push(r);return new Gl(a,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,rl);var n,a=t?ol:al,o=this._parents,r=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var s=r.length,i=new Array(s),l=new Array(s),c=new Array(s),d=0;d<s;++d){var u=o[d],h=r[d],m=h.length,p=sl(e.call(u,u&&u.__data__,d,o)),g=p.length,f=l[d]=new Array(g),y=i[d]=new Array(g);a(u,h,f,y,c[d]=new Array(m),p,t);for(var v,b,E=0,N=0;E<g;++E)if(v=f[E]){for(E>=N&&(N=E+1);!(b=y[N])&&++N<g;);v._next=b||null}}return(i=new Gl(i,o))._enter=l,i._exit=c,i},enter:function(){return new Gl(this._enter||this._groups.map(tl),this._parents)},exit:function(){return new Gl(this._exit||this._groups.map(tl),this._parents)},join:function(e,t,n){var a=this.enter(),o=this,r=this.exit();return"function"==typeof e?(a=e(a))&&(a=a.selection()):a=a.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?r.remove():n(r),a&&o?a.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,a=t._groups,o=n.length,r=a.length,s=Math.min(o,r),i=new Array(o),l=0;l<s;++l)for(var c,d=n[l],u=a[l],h=d.length,m=i[l]=new Array(h),p=0;p<h;++p)(c=d[p]||u[p])&&(m[p]=c);for(;l<o;++l)i[l]=n[l];return new Gl(i,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var a,o=e[t],r=o.length-1,s=o[r];--r>=0;)(a=o[r])&&(s&&4^a.compareDocumentPosition(s)&&s.parentNode.insertBefore(a,s),s=a);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=il);for(var n=this._groups,a=n.length,o=new Array(a),r=0;r<a;++r){for(var s,i=n[r],l=i.length,c=o[r]=new Array(l),d=0;d<l;++d)(s=i[d])&&(c[d]=s);c.sort(t)}return new Gl(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a=e[t],o=0,r=a.length;o<r;++o){var s=a[o];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,a=t.length;n<a;++n)for(var o,r=t[n],s=0,i=r.length;s<i;++s)(o=r[s])&&e.call(o,o.__data__,s,r);return this},attr:function(e,t){var n=Bi(e);if(arguments.length<2){var a=this.node();return n.local?a.getAttributeNS(n.space,n.local):a.getAttribute(n)}return this.each((null==t?n.local?cl:ll:"function"==typeof t?n.local?ml:hl:n.local?ul:dl)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?gl:"function"==typeof t?yl:fl)(e,t,null==n?"":n)):vl(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?bl:"function"==typeof t?Nl:El)(e,t)):this.node()[e]},classed:function(e,t){var n=Cl(e+"");if(arguments.length<2){for(var a=wl(this.node()),o=-1,r=n.length;++o<r;)if(!a.contains(n[o]))return!1;return!0}return this.each(("function"==typeof t?Il:t?Ml:_l)(n,t))},text:function(e){return arguments.length?this.each(null==e?kl:("function"==typeof e?Tl:Ll)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Dl:("function"==typeof e?$l:Al)(e)):this.node().innerHTML},raise:function(){return this.each(Ol)},lower:function(){return this.each(Pl)},append:function(e){var t="function"==typeof e?e:Hi(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:Hi(e),a=null==t?zl:"function"==typeof t?t:Yi(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),a.apply(this,arguments)||null)})},remove:function(){return this.each(Vl)},clone:function(e){return this.select(e?jl:Bl)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var a,o,r=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),s=r.length;if(!(arguments.length<2)){for(i=t?Hl:Fl,a=0;a<s;++a)this.each(i(r[a],t,n));return this}var i=this.node().__on;if(i)for(var l,c=0,d=i.length;c<d;++c)for(a=0,l=i[c];a<s;++a)if((o=r[a]).type===l.type&&o.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?Xl:Yl)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a,o=e[t],r=0,s=o.length;r<s;++r)(a=o[r])&&(yield a)}};const Wl={passive:!1},Jl={capture:!0,passive:!1};function ec(e){e.stopImmediatePropagation()}function tc(e){e.preventDefault(),e.stopImmediatePropagation()}function nc(e){var t=e.document.documentElement,n=Kl(e).on("dragstart.drag",tc,Jl);"onselectstart"in t?n.on("selectstart.drag",tc,Jl):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ac(e,t){var n=e.document.documentElement,a=Kl(e).on("dragstart.drag",null);t&&(a.on("click.drag",tc,Jl),setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in n?a.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var oc=e=>()=>e;function rc(e,{sourceEvent:t,subject:n,target:a,identifier:o,active:r,x:s,y:i,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:i,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}function sc(e){return!e.ctrlKey&&!e.button}function ic(){return this.parentNode}function lc(e,t){return null==t?{x:e.x,y:e.y}:t}function cc(){return navigator.maxTouchPoints||"ontouchstart"in this}function dc(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function uc(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function hc(){}rc.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var mc=.7,pc=1/mc,gc="\\s*([+-]?\\d+)\\s*",fc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",yc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vc=/^#([0-9a-f]{3,8})$/,bc=new RegExp(`^rgb\\(${gc},${gc},${gc}\\)$`),Ec=new RegExp(`^rgb\\(${yc},${yc},${yc}\\)$`),Nc=new RegExp(`^rgba\\(${gc},${gc},${gc},${fc}\\)$`),Cc=new RegExp(`^rgba\\(${yc},${yc},${yc},${fc}\\)$`),wc=new RegExp(`^hsl\\(${fc},${yc},${yc}\\)$`),Sc=new RegExp(`^hsla\\(${fc},${yc},${yc},${fc}\\)$`),xc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Rc(){return this.rgb().formatHex()}function Mc(){return this.rgb().formatRgb()}function _c(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=vc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Ic(t):3===n?new Tc(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?kc(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?kc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=bc.exec(e))?new Tc(t[1],t[2],t[3],1):(t=Ec.exec(e))?new Tc(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Nc.exec(e))?kc(t[1],t[2],t[3],t[4]):(t=Cc.exec(e))?kc(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=wc.exec(e))?zc(t[1],t[2]/100,t[3]/100,1):(t=Sc.exec(e))?zc(t[1],t[2]/100,t[3]/100,t[4]):xc.hasOwnProperty(e)?Ic(xc[e]):"transparent"===e?new Tc(NaN,NaN,NaN,0):null}function Ic(e){return new Tc(e>>16&255,e>>8&255,255&e,1)}function kc(e,t,n,a){return a<=0&&(e=t=n=NaN),new Tc(e,t,n,a)}function Lc(e,t,n,a){return 1===arguments.length?((o=e)instanceof hc||(o=_c(o)),o?new Tc((o=o.rgb()).r,o.g,o.b,o.opacity):new Tc):new Tc(e,t,n,null==a?1:a);var o}function Tc(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function Dc(){return`#${Pc(this.r)}${Pc(this.g)}${Pc(this.b)}`}function Ac(){const e=$c(this.opacity);return`${1===e?"rgb(":"rgba("}${Oc(this.r)}, ${Oc(this.g)}, ${Oc(this.b)}${1===e?")":`, ${e})`}`}function $c(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Oc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Pc(e){return((e=Oc(e))<16?"0":"")+e.toString(16)}function zc(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Bc(e,t,n,a)}function Vc(e){if(e instanceof Bc)return new Bc(e.h,e.s,e.l,e.opacity);if(e instanceof hc||(e=_c(e)),!e)return new Bc;if(e instanceof Bc)return e;var t=(e=e.rgb()).r/255,n=e.g/255,a=e.b/255,o=Math.min(t,n,a),r=Math.max(t,n,a),s=NaN,i=r-o,l=(r+o)/2;return i?(s=t===r?(n-a)/i+6*(n<a):n===r?(a-t)/i+2:(t-n)/i+4,i/=l<.5?r+o:2-r-o,s*=60):i=l>0&&l<1?0:s,new Bc(s,i,l,e.opacity)}function Bc(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function jc(e){return(e=(e||0)%360)<0?e+360:e}function Fc(e){return Math.max(0,Math.min(1,e||0))}function Hc(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}dc(hc,_c,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Rc,formatHex:Rc,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Vc(this).formatHsl()},formatRgb:Mc,toString:Mc}),dc(Tc,Lc,uc(hc,{brighter(e){return e=null==e?pc:Math.pow(pc,e),new Tc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?mc:Math.pow(mc,e),new Tc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Tc(Oc(this.r),Oc(this.g),Oc(this.b),$c(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dc,formatHex:Dc,formatHex8:function(){return`#${Pc(this.r)}${Pc(this.g)}${Pc(this.b)}${Pc(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Ac,toString:Ac})),dc(Bc,function(e,t,n,a){return 1===arguments.length?Vc(e):new Bc(e,t,n,null==a?1:a)},uc(hc,{brighter(e){return e=null==e?pc:Math.pow(pc,e),new Bc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?mc:Math.pow(mc,e),new Bc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,o=2*n-a;return new Tc(Hc(e>=240?e-240:e+120,o,a),Hc(e,o,a),Hc(e<120?e+240:e-120,o,a),this.opacity)},clamp(){return new Bc(jc(this.h),Fc(this.s),Fc(this.l),$c(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=$c(this.opacity);return`${1===e?"hsl(":"hsla("}${jc(this.h)}, ${100*Fc(this.s)}%, ${100*Fc(this.l)}%${1===e?")":`, ${e})`}`}}));var Zc=e=>()=>e;function Yc(e){return 1===(e=+e)?Xc:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):Zc(isNaN(t)?n:t)}}function Xc(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Zc(isNaN(e)?t:e)}var Uc=function e(t){var n=Yc(t);function a(e,t){var a=n((e=Lc(e)).r,(t=Lc(t)).r),o=n(e.g,t.g),r=n(e.b,t.b),s=Xc(e.opacity,t.opacity);return function(t){return e.r=a(t),e.g=o(t),e.b=r(t),e.opacity=s(t),e+""}}return a.gamma=e,a}(1);function Gc(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var qc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Kc=new RegExp(qc.source,"g");function Qc(e,t){var n,a,o,r=qc.lastIndex=Kc.lastIndex=0,s=-1,i=[],l=[];for(e+="",t+="";(n=qc.exec(e))&&(a=Kc.exec(t));)(o=a.index)>r&&(o=t.slice(r,o),i[s]?i[s]+=o:i[++s]=o),(n=n[0])===(a=a[0])?i[s]?i[s]+=a:i[++s]=a:(i[++s]=null,l.push({i:s,x:Gc(n,a)})),r=Kc.lastIndex;return r<t.length&&(o=t.slice(r),i[s]?i[s]+=o:i[++s]=o),i.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,a=0;a<t;++a)i[(n=l[a]).i]=n.x(e);return i.join("")})}var Wc,Jc=180/Math.PI,ed={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function td(e,t,n,a,o,r){var s,i,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*a)&&(n-=e*l,a-=t*l),(i=Math.sqrt(n*n+a*a))&&(n/=i,a/=i,l/=i),e*a<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:r,rotate:Math.atan2(t,e)*Jc,skewX:Math.atan(l)*Jc,scaleX:s,scaleY:i}}function nd(e,t,n,a){function o(e){return e.length?e.pop()+" ":""}return function(r,s){var i=[],l=[];return r=e(r),s=e(s),function(e,a,o,r,s,i){if(e!==o||a!==r){var l=s.push("translate(",null,t,null,n);i.push({i:l-4,x:Gc(e,o)},{i:l-2,x:Gc(a,r)})}else(o||r)&&s.push("translate("+o+t+r+n)}(r.translateX,r.translateY,s.translateX,s.translateY,i,l),function(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push(o(n)+"rotate(",null,a)-2,x:Gc(e,t)})):t&&n.push(o(n)+"rotate("+t+a)}(r.rotate,s.rotate,i,l),function(e,t,n,r){e!==t?r.push({i:n.push(o(n)+"skewX(",null,a)-2,x:Gc(e,t)}):t&&n.push(o(n)+"skewX("+t+a)}(r.skewX,s.skewX,i,l),function(e,t,n,a,r,s){if(e!==n||t!==a){var i=r.push(o(r)+"scale(",null,",",null,")");s.push({i:i-4,x:Gc(e,n)},{i:i-2,x:Gc(t,a)})}else 1===n&&1===a||r.push(o(r)+"scale("+n+","+a+")")}(r.scaleX,r.scaleY,s.scaleX,s.scaleY,i,l),r=s=null,function(e){for(var t,n=-1,a=l.length;++n<a;)i[(t=l[n]).i]=t.x(e);return i.join("")}}}var ad=nd(function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ed:td(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),od=nd(function(e){return null==e?ed:(Wc||(Wc=document.createElementNS("http://www.w3.org/2000/svg","g")),Wc.setAttribute("transform",e),(e=Wc.transform.baseVal.consolidate())?td((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):ed)},", ",")",")");function rd(e){return((e=Math.exp(e))+1/e)/2}var sd,id,ld=function e(t,n,a){function o(e,o){var r,s,i=e[0],l=e[1],c=e[2],d=o[0],u=o[1],h=o[2],m=d-i,p=u-l,g=m*m+p*p;if(g<1e-12)s=Math.log(h/c)/t,r=function(e){return[i+e*m,l+e*p,c*Math.exp(t*e*s)]};else{var f=Math.sqrt(g),y=(h*h-c*c+a*g)/(2*c*n*f),v=(h*h-c*c-a*g)/(2*h*n*f),b=Math.log(Math.sqrt(y*y+1)-y),E=Math.log(Math.sqrt(v*v+1)-v);s=(E-b)/t,r=function(e){var a,o=e*s,r=rd(b),d=c/(n*f)*(r*(a=t*o+b,((a=Math.exp(2*a))-1)/(a+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[i+d*m,l+d*p,c*r/rd(t*o+b)]}}return r.duration=1e3*s*t/Math.SQRT2,r}return o.rho=function(t){var n=Math.max(.001,+t),a=n*n;return e(n,a,a*a)},o}(Math.SQRT2,2,4),cd=0,dd=0,ud=0,hd=0,md=0,pd=0,gd="object"==typeof performance&&performance.now?performance:Date,fd="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function yd(){return md||(fd(vd),md=gd.now()+pd)}function vd(){md=0}function bd(){this._call=this._time=this._next=null}function Ed(e,t,n){var a=new bd;return a.restart(e,t,n),a}function Nd(){md=(hd=gd.now())+pd,cd=dd=0;try{!function(){yd(),++cd;for(var e,t=sd;t;)(e=md-t._time)>=0&&t._call.call(void 0,e),t=t._next;--cd}()}finally{cd=0,function(){var e,t,n=sd,a=1/0;for(;n;)n._call?(a>n._time&&(a=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:sd=t);id=e,wd(a)}(),md=0}}function Cd(){var e=gd.now(),t=e-hd;t>1e3&&(pd-=t,hd=e)}function wd(e){cd||(dd&&(dd=clearTimeout(dd)),e-md>24?(e<1/0&&(dd=setTimeout(Nd,e-gd.now()-pd)),ud&&(ud=clearInterval(ud))):(ud||(hd=gd.now(),ud=setInterval(Cd,1e3)),cd=1,fd(Nd)))}function Sd(e,t,n){var a=new bd;return t=null==t?0:+t,a.restart(n=>{a.stop(),e(n+t)},t,n),a}bd.prototype=Ed.prototype={constructor:bd,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?yd():+n)+(null==t?0:+t),this._next||id===this||(id?id._next=this:sd=this,id=this),this._call=e,this._time=n,wd()},stop:function(){this._call&&(this._call=null,this._time=1/0,wd())}};var xd=Ai("start","end","cancel","interrupt"),Rd=[];function Md(e,t,n,a,o,r){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var a,o=e.__transition;function r(e){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=e&&s(e-n.delay)}function s(r){var c,d,u,h;if(1!==n.state)return l();for(c in o)if((h=o[c]).name===n.name){if(3===h.state)return Sd(s);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[c])}if(Sd(function(){3===n.state&&(n.state=4,n.timer.restart(i,n.delay,n.time),i(r))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,a=new Array(u=n.tween.length),c=0,d=-1;c<u;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=h);a.length=d+1}}function i(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),r=-1,s=a.length;++r<s;)a[r].call(e,o);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var a in n.state=6,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=Ed(r,0,n.time)}(e,n,{name:t,index:a,group:o,on:xd,tween:Rd,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})}function _d(e,t){var n=kd(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Id(e,t){var n=kd(e,t);if(n.state>3)throw new Error("too late; already running");return n}function kd(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ld(e,t){var n,a,o,r=e.__transition,s=!0;if(r){for(o in t=null==t?null:t+"",r)(n=r[o]).name===t?(a=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[o]):s=!1;s&&delete e.__transition}}function Td(e,t){var n,a;return function(){var o=Id(this,e),r=o.tween;if(r!==n)for(var s=0,i=(a=n=r).length;s<i;++s)if(a[s].name===t){(a=a.slice()).splice(s,1);break}o.tween=a}}function Dd(e,t,n){var a,o;if("function"!=typeof n)throw new Error;return function(){var r=Id(this,e),s=r.tween;if(s!==a){o=(a=s).slice();for(var i={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=i;break}l===c&&o.push(i)}r.tween=o}}function Ad(e,t,n){var a=e._id;return e.each(function(){var e=Id(this,a);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return kd(e,a).value[t]}}function $d(e,t){var n;return("number"==typeof t?Gc:t instanceof _c?Uc:(n=_c(t))?(t=n,Uc):Qc)(e,t)}function Od(e){return function(){this.removeAttribute(e)}}function Pd(e){return function(){this.removeAttributeNS(e.space,e.local)}}function zd(e,t,n){var a,o,r=n+"";return function(){var s=this.getAttribute(e);return s===r?null:s===a?o:o=t(a=s,n)}}function Vd(e,t,n){var a,o,r=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===a?o:o=t(a=s,n)}}function Bd(e,t,n){var a,o,r;return function(){var s,i,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(i=l+"")?null:s===a&&i===o?r:(o=i,r=t(a=s,l));this.removeAttribute(e)}}function jd(e,t,n){var a,o,r;return function(){var s,i,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(i=l+"")?null:s===a&&i===o?r:(o=i,r=t(a=s,l));this.removeAttributeNS(e.space,e.local)}}function Fd(e,t){var n,a;function o(){var o=t.apply(this,arguments);return o!==a&&(n=(a=o)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,o)),n}return o._value=t,o}function Hd(e,t){var n,a;function o(){var o=t.apply(this,arguments);return o!==a&&(n=(a=o)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,o)),n}return o._value=t,o}function Zd(e,t){return function(){_d(this,e).delay=+t.apply(this,arguments)}}function Yd(e,t){return t=+t,function(){_d(this,e).delay=t}}function Xd(e,t){return function(){Id(this,e).duration=+t.apply(this,arguments)}}function Ud(e,t){return t=+t,function(){Id(this,e).duration=t}}var Gd=ql.prototype.constructor;function qd(e){return function(){this.style.removeProperty(e)}}var Kd=0;function Qd(e,t,n,a){this._groups=e,this._parents=t,this._name=n,this._id=a}function Wd(){return++Kd}var Jd=ql.prototype;Qd.prototype={constructor:Qd,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Yi(e));for(var a=this._groups,o=a.length,r=new Array(o),s=0;s<o;++s)for(var i,l,c=a[s],d=c.length,u=r[s]=new Array(d),h=0;h<d;++h)(i=c[h])&&(l=e.call(i,i.__data__,h,c))&&("__data__"in i&&(l.__data__=i.__data__),u[h]=l,Md(u[h],t,n,h,u,kd(i,n)));return new Qd(r,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Ui(e));for(var a=this._groups,o=a.length,r=[],s=[],i=0;i<o;++i)for(var l,c=a[i],d=c.length,u=0;u<d;++u)if(l=c[u]){for(var h,m=e.call(l,l.__data__,u,c),p=kd(l,n),g=0,f=m.length;g<f;++g)(h=m[g])&&Md(h,t,n,g,m,p);r.push(m),s.push(l)}return new Qd(r,s,t,n)},selectChild:Jd.selectChild,selectChildren:Jd.selectChildren,filter:function(e){"function"!=typeof e&&(e=qi(e));for(var t=this._groups,n=t.length,a=new Array(n),o=0;o<n;++o)for(var r,s=t[o],i=s.length,l=a[o]=[],c=0;c<i;++c)(r=s[c])&&e.call(r,r.__data__,c,s)&&l.push(r);return new Qd(a,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,a=t.length,o=n.length,r=Math.min(a,o),s=new Array(a),i=0;i<r;++i)for(var l,c=t[i],d=n[i],u=c.length,h=s[i]=new Array(u),m=0;m<u;++m)(l=c[m]||d[m])&&(h[m]=l);for(;i<a;++i)s[i]=t[i];return new Qd(s,this._parents,this._name,this._id)},selection:function(){return new Gd(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Wd(),a=this._groups,o=a.length,r=0;r<o;++r)for(var s,i=a[r],l=i.length,c=0;c<l;++c)if(s=i[c]){var d=kd(s,t);Md(s,e,n,c,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Qd(a,this._parents,e,n)},call:Jd.call,nodes:Jd.nodes,node:Jd.node,size:Jd.size,empty:Jd.empty,each:Jd.each,on:function(e,t){var n=this._id;return arguments.length<2?kd(this.node(),n).on.on(e):this.each(function(e,t,n){var a,o,r=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?_d:Id;return function(){var s=r(this,e),i=s.on;i!==a&&(o=(a=i).copy()).on(t,n),s.on=o}}(n,e,t))},attr:function(e,t){var n=Bi(e),a="transform"===n?od:$d;return this.attrTween(e,"function"==typeof t?(n.local?jd:Bd)(n,a,Ad(this,"attr."+e,t)):null==t?(n.local?Pd:Od)(n):(n.local?Vd:zd)(n,a,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var a=Bi(e);return this.tween(n,(a.local?Fd:Hd)(a,t))},style:function(e,t,n){var a="transform"==(e+="")?ad:$d;return null==t?this.styleTween(e,function(e,t){var n,a,o;return function(){var r=vl(this,e),s=(this.style.removeProperty(e),vl(this,e));return r===s?null:r===n&&s===a?o:o=t(n=r,a=s)}}(e,a)).on("end.style."+e,qd(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var a,o,r;return function(){var s=vl(this,e),i=n(this),l=i+"";return null==i&&(this.style.removeProperty(e),l=i=vl(this,e)),s===l?null:s===a&&l===o?r:(o=l,r=t(a=s,i))}}(e,a,Ad(this,"style."+e,t))).each(function(e,t){var n,a,o,r,s="style."+t,i="end."+s;return function(){var l=Id(this,e),c=l.on,d=null==l.value[s]?r||(r=qd(t)):void 0;c===n&&o===d||(a=(n=c).copy()).on(i,o=d),l.on=a}}(this._id,e)):this.styleTween(e,function(e,t,n){var a,o,r=n+"";return function(){var s=vl(this,e);return s===r?null:s===a?o:o=t(a=s,n)}}(e,a,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(null==t)return this.tween(a,null);if("function"!=typeof t)throw new Error;return this.tween(a,function(e,t,n){var a,o;function r(){var r=t.apply(this,arguments);return r!==o&&(a=(o=r)&&function(e,t,n){return function(a){this.style.setProperty(e,t.call(this,a),n)}}(e,r,n)),a}return r._value=t,r}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Ad(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,n;function a(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&function(e){return function(t){this.textContent=e.call(this,t)}}(a)),t}return a._value=e,a}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var a,o=kd(this.node(),n).tween,r=0,s=o.length;r<s;++r)if((a=o[r]).name===e)return a.value;return null}return this.each((null==t?Td:Dd)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Zd:Yd)(t,e)):kd(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Xd:Ud)(t,e)):kd(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){Id(this,e).ease=t}}(t,e)):kd(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;Id(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,a=n._id,o=n.size();return new Promise(function(r,s){var i={value:s},l={value:function(){0===--o&&r()}};n.each(function(){var n=Id(this,a),o=n.on;o!==e&&((t=(e=o).copy())._.cancel.push(i),t._.interrupt.push(i),t._.end.push(l)),n.on=t}),0===o&&r()})},[Symbol.iterator]:Jd[Symbol.iterator]};var eu={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function tu(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}ql.prototype.interrupt=function(e){return this.each(function(){Ld(this,e)})},ql.prototype.transition=function(e){var t,n;e instanceof Qd?(t=e._id,e=e._name):(t=Wd(),(n=eu).time=yd(),e=null==e?null:e+"");for(var a=this._groups,o=a.length,r=0;r<o;++r)for(var s,i=a[r],l=i.length,c=0;c<l;++c)(s=i[c])&&Md(s,e,t,c,i,n||tu(s,t));return new Qd(a,this._parents,e,t)};var nu=e=>()=>e;function au(e,{sourceEvent:t,target:n,transform:a,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:a,enumerable:!0,configurable:!0},_:{value:o}})}function ou(e,t,n){this.k=e,this.x=t,this.y=n}ou.prototype={constructor:ou,scale:function(e){return 1===e?this:new ou(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new ou(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ru=new ou(1,0,0);function su(e){e.stopImmediatePropagation()}function iu(e){e.preventDefault(),e.stopImmediatePropagation()}function lu(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function cu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function du(){return this.__zoom||ru}function uu(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function hu(){return navigator.maxTouchPoints||"ontouchstart"in this}function mu(e,t,n){var a=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],r=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o),s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s))}ou.prototype;const pu=t.createContext(null),gu=pu.Provider,fu=e=>`Node type "${e}" not found. Using fallback type "default".`,yu=()=>"The React Flow parent container needs a width and a height to render the graph.",vu=()=>"Only child nodes can use a parent extent.",bu=e=>`Marker type "${e}" doesn't exist.`,Eu=(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,Nu=()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",Cu=e=>`Edge type "${e}" not found. Using fallback type "default".`,wu=e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,Su=(()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001")();function xu(e,n){const a=t.useContext(pu);if(null===a)throw new Error(Su);return ki(a,e,n)}const Ru=()=>{const e=t.useContext(pu);if(null===e)throw new Error(Su);return t.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Mu=e=>e.userSelectionActive?"none":"all";function _u({position:e,children:n,className:a,style:o,...r}){const s=xu(Mu),i=`${e}`.split("-");return t.createElement("div",{className:pi(["react-flow__panel",a,...i]),style:{...o,pointerEvents:s},...r},n)}function Iu({proOptions:e,position:n="bottom-right"}){return e?.hideAttribution?null:t.createElement(_u,{position:n,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},t.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var ku=t.memo(({x:e,y:n,label:a,labelStyle:o={},labelShowBg:r=!0,labelBgStyle:s={},labelBgPadding:i=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const h=t.useRef(null),[m,p]=t.useState({x:0,y:0,width:0,height:0}),g=pi(["react-flow__edge-textwrapper",d]);return t.useEffect(()=>{if(h.current){const e=h.current.getBBox();p({x:e.x,y:e.y,width:e.width,height:e.height})}},[a]),void 0!==a&&a?t.createElement("g",{transform:`translate(${e-m.width/2} ${n-m.height/2})`,className:g,visibility:m.width?"visible":"hidden",...u},r&&t.createElement("rect",{width:m.width+2*i[0],x:-i[0],y:-i[1],height:m.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),t.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:h,style:o},a),c):null});const Lu=e=>({width:e.offsetWidth,height:e.offsetHeight}),Tu=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Du=(e={x:0,y:0},t)=>({x:Tu(e.x,t[0][0],t[1][0]),y:Tu(e.y,t[0][1],t[1][1])}),Au=(e,t,n)=>e<t?Tu(Math.abs(e-t),1,50)/50:e>n?-Tu(Math.abs(e-n),1,50)/50:0,$u=(e,t)=>[20*Au(e.x,35,t.width-35),20*Au(e.y,35,t.height-35)],Ou=e=>e.getRootNode?.()||window?.document,Pu=({x:e,y:t,width:n,height:a})=>({x:e,y:t,x2:e+n,y2:t+a}),zu=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Vu=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),a=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*a)},Bu=e=>!isNaN(e)&&isFinite(e),ju=Symbol.for("internals"),Fu=["Enter"," ","Escape"];function Hu(e){const t=(e=>"nativeEvent"in e)(e)?e.nativeEvent:e,n=t.composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const Zu=e=>"clientX"in e,Yu=(e,t)=>{const n=Zu(e),a=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:a-(t?.left??0),y:o-(t?.top??0)}},Xu=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0,Uu=({id:e,path:n,labelX:a,labelY:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:m,interactionWidth:p=20})=>t.createElement(t.Fragment,null,t.createElement("path",{id:e,style:u,d:n,fill:"none",className:"react-flow__edge-path",markerEnd:h,markerStart:m}),p&&t.createElement("path",{d:n,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),r&&Bu(a)&&Bu(o)?t.createElement(ku,{x:a,y:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);function Gu(e,t,n){return void 0===n?n:a=>{const o=t().edges.find(t=>t.id===e);o&&n(a,{...o})}}function qu({sourceX:e,sourceY:t,targetX:n,targetY:a}){const o=Math.abs(n-e)/2,r=n<e?n+o:n-o,s=Math.abs(a-t)/2;return[r,a<t?a+s:a-s,o,s]}function Ku({sourceX:e,sourceY:t,targetX:n,targetY:a,sourceControlX:o,sourceControlY:r,targetControlX:s,targetControlY:i}){const l=.125*e+.375*o+.375*s+.125*n,c=.125*t+.375*r+.375*i+.125*a;return[l,c,Math.abs(l-e),Math.abs(c-t)]}var Qu,Wu,Ju,eh,th,nh;function ah({pos:e,x1:t,y1:n,x2:a,y2:o}){return e===nh.Left||e===nh.Right?[.5*(t+a),n]:[t,.5*(n+o)]}function oh({sourceX:e,sourceY:t,sourcePosition:n=nh.Bottom,targetX:a,targetY:o,targetPosition:r=nh.Top}){const[s,i]=ah({pos:n,x1:e,y1:t,x2:a,y2:o}),[l,c]=ah({pos:r,x1:a,y1:o,x2:e,y2:t}),[d,u,h,m]=Ku({sourceX:e,sourceY:t,targetX:a,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:l,targetControlY:c});return[`M${e},${t} C${s},${i} ${l},${c} ${a},${o}`,d,u,h,m]}Uu.displayName="BaseEdge",function(e){e.Strict="strict",e.Loose="loose"}(Qu||(Qu={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(Wu||(Wu={})),function(e){e.Partial="partial",e.Full="full"}(Ju||(Ju={})),function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(eh||(eh={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(th||(th={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(nh||(nh={}));const rh=t.memo(({sourceX:e,sourceY:n,targetX:a,targetY:o,sourcePosition:r=nh.Bottom,targetPosition:s=nh.Top,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:m,markerEnd:p,markerStart:g,interactionWidth:f})=>{const[y,v,b]=oh({sourceX:e,sourceY:n,sourcePosition:r,targetX:a,targetY:o,targetPosition:s});return t.createElement(Uu,{path:y,labelX:v,labelY:b,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:m,markerEnd:p,markerStart:g,interactionWidth:f})});rh.displayName="SimpleBezierEdge";const sh={[nh.Left]:{x:-1,y:0},[nh.Right]:{x:1,y:0},[nh.Top]:{x:0,y:-1},[nh.Bottom]:{x:0,y:1}},ih=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function lh({source:e,sourcePosition:t=nh.Bottom,target:n,targetPosition:a=nh.Top,center:o,offset:r}){const s=sh[t],i=sh[a],l={x:e.x+s.x*r,y:e.y+s.y*r},c={x:n.x+i.x*r,y:n.y+i.y*r},d=(({source:e,sourcePosition:t=nh.Bottom,target:n})=>t===nh.Left||t===nh.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1})({source:l,sourcePosition:t,target:c}),u=0!==d.x?"x":"y",h=d[u];let m,p,g=[];const f={x:0,y:0},y={x:0,y:0},[v,b,E,N]=qu({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[u]*i[u]===-1){m=o.x??v,p=o.y??b;const e=[{x:m,y:l.y},{x:m,y:c.y}],t=[{x:l.x,y:p},{x:c.x,y:p}];g=s[u]===h?"x"===u?e:t:"x"===u?t:e}else{const o=[{x:l.x,y:c.y}],d=[{x:c.x,y:l.y}];if(g="x"===u?s.x===h?d:o:s.y===h?o:d,t===a){const t=Math.abs(e[u]-n[u]);if(t<=r){const a=Math.min(r-1,r-t);s[u]===h?f[u]=(l[u]>e[u]?-1:1)*a:y[u]=(c[u]>n[u]?-1:1)*a}}if(t!==a){const e="x"===u?"y":"x",t=s[u]===i[e],n=l[e]>c[e],a=l[e]<c[e];(1===s[u]&&(!t&&n||t&&a)||1!==s[u]&&(!t&&a||t&&n))&&(g="x"===u?o:d)}const v={x:l.x+f.x,y:l.y+f.y},b={x:c.x+y.x,y:c.y+y.y};Math.max(Math.abs(v.x-g[0].x),Math.abs(b.x-g[0].x))>=Math.max(Math.abs(v.y-g[0].y),Math.abs(b.y-g[0].y))?(m=(v.x+b.x)/2,p=g[0].y):(m=g[0].x,p=(v.y+b.y)/2)}return[[e,{x:l.x+f.x,y:l.y+f.y},...g,{x:c.x+y.x,y:c.y+y.y},n],m,p,E,N]}function ch({sourceX:e,sourceY:t,sourcePosition:n=nh.Bottom,targetX:a,targetY:o,targetPosition:r=nh.Top,borderRadius:s=5,centerX:i,centerY:l,offset:c=20}){const[d,u,h,m,p]=lh({source:{x:e,y:t},sourcePosition:n,target:{x:a,y:o},targetPosition:r,center:{x:i,y:l},offset:c});return[d.reduce((e,t,n)=>{let a="";return a=n>0&&n<d.length-1?function(e,t,n,a){const o=Math.min(ih(e,t)/2,ih(t,n)/2,a),{x:r,y:s}=t;if(e.x===r&&r===n.x||e.y===s&&s===n.y)return`L${r} ${s}`;if(e.y===s)return`L ${r+o*(e.x<n.x?-1:1)},${s}Q ${r},${s} ${r},${s+o*(e.y<n.y?1:-1)}`;const i=e.x<n.x?1:-1;return`L ${r},${s+o*(e.y<n.y?-1:1)}Q ${r},${s} ${r+o*i},${s}`}(d[n-1],t,d[n+1],s):`${0===n?"M":"L"}${t.x} ${t.y}`,e+=a},""),u,h,m,p]}const dh=t.memo(({sourceX:e,sourceY:n,targetX:a,targetY:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:h=nh.Bottom,targetPosition:m=nh.Top,markerEnd:p,markerStart:g,pathOptions:f,interactionWidth:y})=>{const[v,b,E]=ch({sourceX:e,sourceY:n,sourcePosition:h,targetX:a,targetY:o,targetPosition:m,borderRadius:f?.borderRadius,offset:f?.offset});return t.createElement(Uu,{path:v,labelX:b,labelY:E,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:p,markerStart:g,interactionWidth:y})});dh.displayName="SmoothStepEdge";const uh=t.memo(e=>t.createElement(dh,{...e,pathOptions:t.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));uh.displayName="StepEdge";const hh=t.memo(({sourceX:e,sourceY:n,targetX:a,targetY:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:m,interactionWidth:p})=>{const[g,f,y]=function({sourceX:e,sourceY:t,targetX:n,targetY:a}){const[o,r,s,i]=qu({sourceX:e,sourceY:t,targetX:n,targetY:a});return[`M ${e},${t}L ${n},${a}`,o,r,s,i]}({sourceX:e,sourceY:n,targetX:a,targetY:o});return t.createElement(Uu,{path:g,labelX:f,labelY:y,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:m,interactionWidth:p})});function mh(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function ph({pos:e,x1:t,y1:n,x2:a,y2:o,c:r}){switch(e){case nh.Left:return[t-mh(t-a,r),n];case nh.Right:return[t+mh(a-t,r),n];case nh.Top:return[t,n-mh(n-o,r)];case nh.Bottom:return[t,n+mh(o-n,r)]}}function gh({sourceX:e,sourceY:t,sourcePosition:n=nh.Bottom,targetX:a,targetY:o,targetPosition:r=nh.Top,curvature:s=.25}){const[i,l]=ph({pos:n,x1:e,y1:t,x2:a,y2:o,c:s}),[c,d]=ph({pos:r,x1:a,y1:o,x2:e,y2:t,c:s}),[u,h,m,p]=Ku({sourceX:e,sourceY:t,targetX:a,targetY:o,sourceControlX:i,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${i},${l} ${c},${d} ${a},${o}`,u,h,m,p]}hh.displayName="StraightEdge";const fh=t.memo(({sourceX:e,sourceY:n,targetX:a,targetY:o,sourcePosition:r=nh.Bottom,targetPosition:s=nh.Top,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:m,markerEnd:p,markerStart:g,pathOptions:f,interactionWidth:y})=>{const[v,b,E]=gh({sourceX:e,sourceY:n,sourcePosition:r,targetX:a,targetY:o,targetPosition:s,curvature:f?.curvature});return t.createElement(Uu,{path:v,labelX:b,labelY:E,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:m,markerEnd:p,markerStart:g,interactionWidth:y})});fh.displayName="BezierEdge";const yh=t.createContext(null),vh=yh.Provider;yh.Consumer;const bh=({source:e,sourceHandle:t,target:n,targetHandle:a})=>`reactflow__edge-${e}${t||""}-${n}${a||""}`,Eh=(e,t)=>{if(void 0===e)return"";if("string"==typeof e)return e;return`${t?`${t}__`:""}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join("&")}`},Nh=({x:e,y:t},[n,a,o],r,[s,i])=>{const l={x:(e-n)/o,y:(t-a)/o};return r?{x:s*Math.round(l.x/s),y:i*Math.round(l.y/i)}:l},Ch=({x:e,y:t},[n,a,o])=>({x:e*o+n,y:t*o+a}),wh=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],a=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-a};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-a}:o}},Sh=(e,t=[0,0])=>{if(0===e.length)return{x:0,y:0,width:0,height:0};return(({x:e,y:t,x2:n,y2:a})=>({x:e,y:t,width:n-e,height:a-t}))(e.reduce((e,n)=>{const{x:a,y:o}=wh(n,t).positionAbsolute;return r=e,s=Pu({x:a,y:o,width:n.width||0,height:n.height||0}),{x:Math.min(r.x,s.x),y:Math.min(r.y,s.y),x2:Math.max(r.x2,s.x2),y2:Math.max(r.y2,s.y2)};var r,s},{x:1/0,y:1/0,x2:-1/0,y2:-1/0}))},xh=(e,t,[n,a,o]=[0,0,1],r=!1,s=!1,i=[0,0])=>{const l={x:(t.x-n)/o,y:(t.y-a)/o,width:t.width/o,height:t.height/o},c=[];return e.forEach(e=>{const{width:t,height:n,selectable:a=!0,hidden:o=!1}=e;if(s&&!a||o)return!1;const{positionAbsolute:d}=wh(e,i),u={x:d.x,y:d.y,width:t||0,height:n||0},h=Vu(l,u);(void 0===t||void 0===n||null===t||null===n||r&&h>0||h>=(t||0)*(n||0)||e.dragging)&&c.push(e)}),c},Rh=(e,t)=>{const n=e.map(e=>e.id);return t.filter(e=>n.includes(e.source)||n.includes(e.target))},Mh=(e,t,n,a,o,r=.1)=>{const s=t/(e.width*(1+r)),i=n/(e.height*(1+r)),l=Math.min(s,i),c=Tu(l,a,o);return{x:t/2-(e.x+e.width/2)*c,y:n/2-(e.y+e.height/2)*c,zoom:c}},_h=(e,t=0)=>e.transition().duration(t);function Ih(e,t,n,a){return(t[n]||[]).reduce((t,o)=>(`${e.id}-${o.id}-${n}`!==a&&t.push({id:o.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+o.x+o.width/2,y:(e.positionAbsolute?.y??0)+o.y+o.height/2}),t),[])}const kh={source:null,target:null,sourceHandle:null,targetHandle:null},Lh=()=>({handleDomNode:null,isValid:!1,connection:kh,endHandle:null});function Th(e,t,n,a,o,r,s){const i="target"===o,l=s.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),c={...Lh(),handleDomNode:l};if(l){const e=Dh(void 0,l),o=l.getAttribute("data-nodeid"),s=l.getAttribute("data-handleid"),d=l.classList.contains("connectable"),u=l.classList.contains("connectableend"),h={source:i?o:n,sourceHandle:i?s:a,target:i?n:o,targetHandle:i?a:s};c.connection=h;d&&u&&(t===Qu.Strict?i&&"source"===e||!i&&"target"===e:o!==n||s!==a)&&(c.endHandle={nodeId:o,handleId:s,type:e},c.isValid=r(h))}return c}function Dh(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Ah(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function $h(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Oh({event:e,handleId:t,nodeId:n,onConnect:a,isTarget:o,getState:r,setState:s,isValidConnection:i,edgeUpdaterType:l,onReconnectEnd:c}){const d=Ou(e.target),{connectionMode:u,domNode:h,autoPanOnConnect:m,connectionRadius:p,onConnectStart:g,panBy:f,getNodes:y,cancelConnection:v}=r();let b,E=0;const{x:N,y:C}=Yu(e),w=d?.elementFromPoint(N,C),S=Dh(l,w),x=h?.getBoundingClientRect();if(!x||!S)return;let R,M=Yu(e,x),_=!1,I=null,k=!1,L=null;const T=function({nodes:e,nodeId:t,handleId:n,handleType:a}){return e.reduce((e,o)=>{if(o[ju]){const{handleBounds:r}=o[ju];let s=[],i=[];r&&(s=Ih(o,r,"source",`${t}-${n}-${a}`),i=Ih(o,r,"target",`${t}-${n}-${a}`)),e.push(...s,...i)}return e},[])}({nodes:y(),nodeId:n,handleId:t,handleType:S}),D=()=>{if(!m)return;const[e,t]=$u(M,x);f({x:e,y:t}),E=requestAnimationFrame(D)};function A(e){const{transform:a}=r();M=Yu(e,x);const{handle:l,validHandleResult:c}=function(e,t,n,a,o,r){const{x:s,y:i}=Yu(e),l=t.elementsFromPoint(s,i).find(e=>e.classList.contains("react-flow__handle"));if(l){const e=l.getAttribute("data-nodeid");if(e){const t=Dh(void 0,l),a=l.getAttribute("data-handleid"),s=r({nodeId:e,id:a,type:t});if(s){const r=o.find(n=>n.nodeId===e&&n.type===t&&n.id===a);return{handle:{id:a,type:t,nodeId:e,x:r?.x||n.x,y:r?.y||n.y},validHandleResult:s}}}}let c=[],d=1/0;if(o.forEach(e=>{const t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=a){const n=r(e);t<=d&&(t<d?c=[{handle:e,validHandleResult:n}]:t===d&&c.push({handle:e,validHandleResult:n}),d=t)}}),!c.length)return{handle:null,validHandleResult:Lh()};if(1===c.length)return c[0];const u=c.some(({validHandleResult:e})=>e.isValid),h=c.some(({handle:e})=>"target"===e.type);return c.find(({handle:e,validHandleResult:t})=>h?"target"===e.type:!u||t.isValid)||c[0]}(e,d,Nh(M,a,!1,[1,1]),p,T,e=>Th(e,u,n,t,o?"target":"source",i,d));if(b=l,_||(D(),_=!0),L=c.handleDomNode,I=c.connection,k=c.isValid,s({connectionPosition:b&&k?Ch({x:b.x,y:b.y},a):M,connectionStatus:$h(!!b,k),connectionEndHandle:c.endHandle}),!b&&!k&&!L)return Ah(R);I.source!==I.target&&L&&(Ah(R),R=L,L.classList.add("connecting","react-flow__handle-connecting"),L.classList.toggle("valid",k),L.classList.toggle("react-flow__handle-valid",k))}function $(e){(b||L)&&I&&k&&a?.(I),r().onConnectEnd?.(e),l&&c?.(e),Ah(R),v(),cancelAnimationFrame(E),_=!1,k=!1,I=null,L=null,d.removeEventListener("mousemove",A),d.removeEventListener("mouseup",$),d.removeEventListener("touchmove",A),d.removeEventListener("touchend",$)}s({connectionPosition:M,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:S,connectionStartHandle:{nodeId:n,handleId:t,type:S},connectionEndHandle:null}),g?.(e,{nodeId:n,handleId:t,handleType:S}),d.addEventListener("mousemove",A),d.addEventListener("mouseup",$),d.addEventListener("touchmove",A),d.addEventListener("touchend",$)}const Ph=()=>!0,zh=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Vh=t.forwardRef(({type:e="source",position:n=nh.Top,isValidConnection:a,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:s=!0,id:i,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:h,...m},p)=>{const g=i||null,f="target"===e,y=Ru(),v=t.useContext(yh),{connectOnClick:b,noPanClassName:E}=xu(zh,Ti),{connecting:N,clickConnecting:C}=xu(((e,t,n)=>a=>{const{connectionStartHandle:o,connectionEndHandle:r,connectionClickStartHandle:s}=a;return{connecting:o?.nodeId===e&&o?.handleId===t&&o?.type===n||r?.nodeId===e&&r?.handleId===t&&r?.type===n,clickConnecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n}})(v,g,e),Ti);v||y.getState().onError?.("010",Nu());const w=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:a}=y.getState(),o={...t,...e};if(a){const{edges:e,setEdges:t}=y.getState();t(((e,t)=>{if(!e.source||!e.target)return t;let n;var a;return n="id"in(a=e)&&"source"in a&&"target"in a?{...e}:{...e,id:bh(e)},((e,t)=>t.some(t=>!(t.source!==e.source||t.target!==e.target||t.sourceHandle!==e.sourceHandle&&(t.sourceHandle||e.sourceHandle)||t.targetHandle!==e.targetHandle&&(t.targetHandle||e.targetHandle))))(n,t)?t:t.concat(n)})(o,e))}n?.(o),l?.(o)},S=e=>{if(!v)return;const t=Zu(e);r&&(t&&0===e.button||!t)&&Oh({event:e,handleId:g,nodeId:v,onConnect:w,isTarget:f,getState:y.getState,setState:y.setState,isValidConnection:a||y.getState().isValidConnection||Ph}),t?u?.(e):h?.(e)};return t.createElement("div",{"data-handleid":g,"data-nodeid":v,"data-handlepos":n,"data-id":`${v}-${g}-${e}`,className:pi(["react-flow__handle",`react-flow__handle-${n}`,"nodrag",E,d,{source:!f,target:f,connectable:o,connectablestart:r,connectableend:s,connecting:C,connectionindicator:o&&(r&&!N||s&&N)}]),onMouseDown:S,onTouchStart:S,onClick:b?t=>{const{onClickConnectStart:n,onClickConnectEnd:o,connectionClickStartHandle:s,connectionMode:i,isValidConnection:l}=y.getState();if(!v||!s&&!r)return;if(!s)return n?.(t,{nodeId:v,handleId:g,handleType:e}),void y.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:g}});const c=Ou(t.target),d=a||l||Ph,{connection:u,isValid:h}=Th({nodeId:v,id:g,type:e},i,s.nodeId,s.handleId||null,s.type,d,c);h&&w(u),o?.(t),y.setState({connectionClickStartHandle:null})}:void 0,ref:p,...m},c)});Vh.displayName="Handle";var Bh=t.memo(Vh);const jh=({data:e,isConnectable:n,targetPosition:a=nh.Top,sourcePosition:o=nh.Bottom})=>t.createElement(t.Fragment,null,t.createElement(Bh,{type:"target",position:a,isConnectable:n}),e?.label,t.createElement(Bh,{type:"source",position:o,isConnectable:n}));jh.displayName="DefaultNode";var Fh=t.memo(jh);const Hh=({data:e,isConnectable:n,sourcePosition:a=nh.Bottom})=>t.createElement(t.Fragment,null,e?.label,t.createElement(Bh,{type:"source",position:a,isConnectable:n}));Hh.displayName="InputNode";var Zh=t.memo(Hh);const Yh=({data:e,isConnectable:n,targetPosition:a=nh.Top})=>t.createElement(t.Fragment,null,t.createElement(Bh,{type:"target",position:a,isConnectable:n}),e?.label);Yh.displayName="OutputNode";var Xh=t.memo(Yh);const Uh=()=>null;Uh.displayName="GroupNode";const Gh=e=>({selectedNodes:e.getNodes().filter(e=>e.selected),selectedEdges:e.edges.filter(e=>e.selected).map(e=>({...e}))}),qh=e=>e.id;function Kh(e,t){return Ti(e.selectedNodes.map(qh),t.selectedNodes.map(qh))&&Ti(e.selectedEdges.map(qh),t.selectedEdges.map(qh))}const Qh=t.memo(({onSelectionChange:e})=>{const n=Ru(),{selectedNodes:a,selectedEdges:o}=xu(Gh,Kh);return t.useEffect(()=>{const t={nodes:a,edges:o};e?.(t),n.getState().onSelectionChange.forEach(e=>e(t))},[a,o,e]),null});Qh.displayName="SelectionListener";const Wh=e=>!!e.onSelectionChange;function Jh({onSelectionChange:e}){const n=xu(Wh);return e||n?t.createElement(Qh,{onSelectionChange:e}):null}const em=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function tm(e,n){t.useEffect(()=>{void 0!==e&&n(e)},[e])}function nm(e,n,a){t.useEffect(()=>{void 0!==n&&a({[e]:n})},[n])}const am=({nodes:e,edges:n,defaultNodes:a,defaultEdges:o,onConnect:r,onConnectStart:s,onConnectEnd:i,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:h,edgesFocusable:m,edgesUpdatable:p,elevateNodesOnSelect:g,minZoom:f,maxZoom:y,nodeExtent:v,onNodesChange:b,onEdgesChange:E,elementsSelectable:N,connectionMode:C,snapGrid:w,snapToGrid:S,translateExtent:x,connectOnClick:R,defaultEdgeOptions:M,fitView:_,fitViewOptions:I,onNodesDelete:k,onEdgesDelete:L,onNodeDrag:T,onNodeDragStart:D,onNodeDragStop:A,onSelectionDrag:$,onSelectionDragStart:O,onSelectionDragStop:P,noPanClassName:z,nodeOrigin:V,rfId:B,autoPanOnConnect:j,autoPanOnNodeDrag:F,onError:H,connectionRadius:Z,isValidConnection:Y,nodeDragThreshold:X})=>{const{setNodes:U,setEdges:G,setDefaultNodesAndEdges:q,setMinZoom:K,setMaxZoom:Q,setTranslateExtent:W,setNodeExtent:J,reset:ee}=xu(em,Ti),te=Ru();return t.useEffect(()=>{const e=o?.map(e=>({...e,...M}));return q(a,e),()=>{ee()}},[]),nm("defaultEdgeOptions",M,te.setState),nm("connectionMode",C,te.setState),nm("onConnect",r,te.setState),nm("onConnectStart",s,te.setState),nm("onConnectEnd",i,te.setState),nm("onClickConnectStart",l,te.setState),nm("onClickConnectEnd",c,te.setState),nm("nodesDraggable",d,te.setState),nm("nodesConnectable",u,te.setState),nm("nodesFocusable",h,te.setState),nm("edgesFocusable",m,te.setState),nm("edgesUpdatable",p,te.setState),nm("elementsSelectable",N,te.setState),nm("elevateNodesOnSelect",g,te.setState),nm("snapToGrid",S,te.setState),nm("snapGrid",w,te.setState),nm("onNodesChange",b,te.setState),nm("onEdgesChange",E,te.setState),nm("connectOnClick",R,te.setState),nm("fitViewOnInit",_,te.setState),nm("fitViewOnInitOptions",I,te.setState),nm("onNodesDelete",k,te.setState),nm("onEdgesDelete",L,te.setState),nm("onNodeDrag",T,te.setState),nm("onNodeDragStart",D,te.setState),nm("onNodeDragStop",A,te.setState),nm("onSelectionDrag",$,te.setState),nm("onSelectionDragStart",O,te.setState),nm("onSelectionDragStop",P,te.setState),nm("noPanClassName",z,te.setState),nm("nodeOrigin",V,te.setState),nm("rfId",B,te.setState),nm("autoPanOnConnect",j,te.setState),nm("autoPanOnNodeDrag",F,te.setState),nm("onError",H,te.setState),nm("connectionRadius",Z,te.setState),nm("isValidConnection",Y,te.setState),nm("nodeDragThreshold",X,te.setState),tm(e,U),tm(n,G),tm(f,K),tm(y,Q),tm(x,W),tm(v,J),null},om={display:"none"},rm={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},sm="react-flow__node-desc",im="react-flow__edge-desc",lm=e=>e.ariaLiveMessage;function cm({rfId:e}){const n=xu(lm);return t.createElement("div",{id:`react-flow__aria-live-${e}`,"aria-live":"assertive","aria-atomic":"true",style:rm},n)}function dm({rfId:e,disableKeyboardA11y:n}){return t.createElement(t.Fragment,null,t.createElement("div",{id:`${sm}-${e}`,style:om},"Press enter or space to select a node.",!n&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),t.createElement("div",{id:`${im}-${e}`,style:om},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!n&&t.createElement(cm,{rfId:e}))}var um=(e=null,n={actInsideInputWithModifier:!0})=>{const[a,o]=t.useState(!1),r=t.useRef(!1),s=t.useRef(new Set([])),[i,l]=t.useMemo(()=>{if(null!==e){const t=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.split("+")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return t.useEffect(()=>{const t="undefined"!=typeof document?document:null,a=n?.target||t;if(null!==e){const e=e=>{r.current=e.ctrlKey||e.metaKey||e.shiftKey;if((!r.current||r.current&&!n.actInsideInputWithModifier)&&Hu(e))return!1;const t=mm(e.code,l);s.current.add(e[t]),hm(i,s.current,!1)&&(e.preventDefault(),o(!0))},t=e=>{if((!r.current||r.current&&!n.actInsideInputWithModifier)&&Hu(e))return!1;const t=mm(e.code,l);hm(i,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(e[t]),"Meta"===e.key&&s.current.clear(),r.current=!1},c=()=>{s.current.clear(),o(!1)};return a?.addEventListener("keydown",e),a?.addEventListener("keyup",t),window.addEventListener("blur",c),()=>{a?.removeEventListener("keydown",e),a?.removeEventListener("keyup",t),window.removeEventListener("blur",c)}}},[e,o]),a};function hm(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function mm(e,t){return t.includes(e)?"code":"key"}function pm(e,t,n,a){const o=e.parentNode||e.parentId;if(!o)return n;const r=t.get(o),s=wh(r,a);return pm(r,t,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(r[ju]?.z??0)>(n.z??0)?r[ju]?.z??0:n.z??0},a)}function gm(e,t,n){e.forEach(a=>{const o=a.parentNode||a.parentId;if(o&&!e.has(o))throw new Error(`Parent node ${o} not found`);if(o||n?.[a.id]){const{x:o,y:r,z:s}=pm(a,e,{...a.position,z:a[ju]?.z??0},t);a.positionAbsolute={x:o,y:r},a[ju].z=s,n?.[a.id]&&(a[ju].isParent=!0)}})}function fm(e,t,n,a){const o=new Map,r={},s=a?1e3:0;return e.forEach(e=>{const n=(Bu(e.zIndex)?e.zIndex:0)+(e.selected?s:0),a=t.get(e.id),i={...e,positionAbsolute:{x:e.position.x,y:e.position.y}},l=e.parentNode||e.parentId;l&&(r[l]=!0);const c=a?.type&&a?.type!==e.type;Object.defineProperty(i,ju,{enumerable:!1,value:{handleBounds:c?void 0:a?.[ju]?.handleBounds,z:n}}),o.set(e.id,i)}),gm(o,n,r),o}function ym(e,t={}){const{getNodes:n,width:a,height:o,minZoom:r,maxZoom:s,d3Zoom:i,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:u}=e(),h=t.initial&&!c&&d;if(i&&l&&(h||!t.initial)){const e=n().filter(e=>{const n=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return t.nodes?.length?n&&t.nodes.some(t=>t.id===e.id):n}),c=e.every(e=>e.width&&e.height);if(e.length>0&&c){const n=Sh(e,u),{x:c,y:d,zoom:h}=Mh(n,a,o,t.minZoom??r,t.maxZoom??s,t.padding??.1),m=ru.translate(c,d).scale(h);return"number"==typeof t.duration&&t.duration>0?i.transform(_h(l,t.duration),m):i.transform(l,m),!0}}return!1}function vm(e,t){return e.forEach(e=>{const n=t.get(e.id);n&&t.set(n.id,{...n,[ju]:n[ju],selected:e.selected})}),new Map(t)}function bm(e,t){return t.map(t=>{const n=e.find(e=>e.id===t.id);return n&&(t.selected=n.selected),t})}function Em({changedNodes:e,changedEdges:t,get:n,set:a}){const{nodeInternals:o,edges:r,onNodesChange:s,onEdgesChange:i,hasDefaultNodes:l,hasDefaultEdges:c}=n();e?.length&&(l&&a({nodeInternals:vm(e,o)}),s?.(e)),t?.length&&(c&&a({edges:bm(t,r)}),i?.(t))}const Nm=()=>{},Cm={zoomIn:Nm,zoomOut:Nm,zoomTo:Nm,getZoom:()=>1,setViewport:Nm,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Nm,fitBounds:Nm,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},wm=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection});function Sm(){const e=(()=>{const e=Ru(),{d3Zoom:n,d3Selection:a}=xu(wm,Ti),o=t.useMemo(()=>a&&n?{zoomIn:e=>n.scaleBy(_h(a,e?.duration),1.2),zoomOut:e=>n.scaleBy(_h(a,e?.duration),1/1.2),zoomTo:(e,t)=>n.scaleTo(_h(a,t?.duration),e),getZoom:()=>e.getState().transform[2],setViewport:(t,o)=>{const[r,s,i]=e.getState().transform,l=ru.translate(t.x??r,t.y??s).scale(t.zoom??i);n.transform(_h(a,o?.duration),l)},getViewport:()=>{const[t,n,a]=e.getState().transform;return{x:t,y:n,zoom:a}},fitView:t=>ym(e.getState,t),setCenter:(t,o,r)=>{const{width:s,height:i,maxZoom:l}=e.getState(),c=void 0!==r?.zoom?r.zoom:l,d=s/2-t*c,u=i/2-o*c,h=ru.translate(d,u).scale(c);n.transform(_h(a,r?.duration),h)},fitBounds:(t,o)=>{const{width:r,height:s,minZoom:i,maxZoom:l}=e.getState(),{x:c,y:d,zoom:u}=Mh(t,r,s,i,l,o?.padding??.1),h=ru.translate(c,d).scale(u);n.transform(_h(a,o?.duration),h)},project:t=>{const{transform:n,snapToGrid:a,snapGrid:o}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Nh(t,n,a,o)},screenToFlowPosition:t=>{const{transform:n,snapToGrid:a,snapGrid:o,domNode:r}=e.getState();if(!r)return t;const{x:s,y:i}=r.getBoundingClientRect(),l={x:t.x-s,y:t.y-i};return Nh(l,n,a,o)},flowToScreenPosition:t=>{const{transform:n,domNode:a}=e.getState();if(!a)return t;const{x:o,y:r}=a.getBoundingClientRect(),s=Ch(t,n);return{x:s.x+o,y:s.y+r}},viewportInitialized:!0}:Cm,[n,a]);return o})(),n=Ru(),a=t.useCallback(()=>n.getState().getNodes().map(e=>({...e})),[]),o=t.useCallback(e=>n.getState().nodeInternals.get(e),[]),r=t.useCallback(()=>{const{edges:e=[]}=n.getState();return e.map(e=>({...e}))},[]),s=t.useCallback(e=>{const{edges:t=[]}=n.getState();return t.find(t=>t.id===e)},[]),i=t.useCallback(e=>{const{getNodes:t,setNodes:a,hasDefaultNodes:o,onNodesChange:r}=n.getState(),s=t(),i="function"==typeof e?e(s):e;if(o)a(i);else if(r){r(0===i.length?s.map(e=>({type:"remove",id:e.id})):i.map(e=>({item:e,type:"reset"})))}},[]),l=t.useCallback(e=>{const{edges:t=[],setEdges:a,hasDefaultEdges:o,onEdgesChange:r}=n.getState(),s="function"==typeof e?e(t):e;if(o)a(s);else if(r){r(0===s.length?t.map(e=>({type:"remove",id:e.id})):s.map(e=>({item:e,type:"reset"})))}},[]),c=t.useCallback(e=>{const t=Array.isArray(e)?e:[e],{getNodes:a,setNodes:o,hasDefaultNodes:r,onNodesChange:s}=n.getState();if(r){o([...a(),...t])}else if(s){s(t.map(e=>({item:e,type:"add"})))}},[]),d=t.useCallback(e=>{const t=Array.isArray(e)?e:[e],{edges:a=[],setEdges:o,hasDefaultEdges:r,onEdgesChange:s}=n.getState();if(r)o([...a,...t]);else if(s){s(t.map(e=>({item:e,type:"add"})))}},[]),u=t.useCallback(()=>{const{getNodes:e,edges:t=[],transform:a}=n.getState(),[o,r,s]=a;return{nodes:e().map(e=>({...e})),edges:t.map(e=>({...e})),viewport:{x:o,y:r,zoom:s}}},[]),h=t.useCallback(({nodes:e,edges:t})=>{const{nodeInternals:a,getNodes:o,edges:r,hasDefaultNodes:s,hasDefaultEdges:i,onNodesDelete:l,onEdgesDelete:c,onNodesChange:d,onEdgesChange:u}=n.getState(),h=(e||[]).map(e=>e.id),m=(t||[]).map(e=>e.id),p=o().reduce((e,t)=>{const n=t.parentNode||t.parentId,a=!h.includes(t.id)&&n&&e.find(e=>e.id===n);return("boolean"!=typeof t.deletable||t.deletable)&&(h.includes(t.id)||a)&&e.push(t),e},[]),g=r.filter(e=>"boolean"!=typeof e.deletable||e.deletable),f=g.filter(e=>m.includes(e.id));if(p||f){const e=Rh(p,g),t=[...f,...e],o=t.reduce((e,t)=>(e.includes(t.id)||e.push(t.id),e),[]);if((i||s)&&(i&&n.setState({edges:r.filter(e=>!o.includes(e.id))}),s&&(p.forEach(e=>{a.delete(e.id)}),n.setState({nodeInternals:new Map(a)}))),o.length>0&&(c?.(t),u&&u(o.map(e=>({id:e,type:"remove"})))),p.length>0&&(l?.(p),d)){d(p.map(e=>({id:e.id,type:"remove"})))}}},[]),m=t.useCallback(e=>{const t=Bu((a=e).width)&&Bu(a.height)&&Bu(a.x)&&Bu(a.y);var a;const o=t?null:n.getState().nodeInternals.get(e.id);if(!t&&!o)return[null,null,t];return[t?e:zu(o),o,t]},[]),p=t.useCallback((e,t=!0,a)=>{const[o,r,s]=m(e);return o?(a||n.getState().getNodes()).filter(e=>{if(!(s||e.id!==r.id&&e.positionAbsolute))return!1;const n=zu(e),a=Vu(n,o);return t&&a>0||a>=o.width*o.height}):[]},[]),g=t.useCallback((e,t,n=!0)=>{const[a]=m(e);if(!a)return!1;const o=Vu(a,t);return n&&o>0||o>=a.width*a.height},[]);return t.useMemo(()=>({...e,getNodes:a,getNode:o,getEdges:r,getEdge:s,setNodes:i,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:h,getIntersectingNodes:p,isNodeIntersecting:g}),[e,a,o,r,s,i,l,c,d,u,h,p,g])}const xm={actInsideInputWithModifier:!1};const Rm={position:"absolute",width:"100%",height:"100%",top:0,left:0},Mm=e=>({x:e.x,y:e.y,zoom:e.k}),_m=(e,t)=>e.target.closest(`.${t}`),Im=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),km=e=>{const t=e.ctrlKey&&Xu()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t},Lm=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Tm=({onMove:e,onMoveStart:n,onMoveEnd:a,onPaneContextMenu:o,zoomOnScroll:r=!0,zoomOnPinch:s=!0,panOnScroll:i=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=Wu.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:h=!0,defaultViewport:m,translateExtent:p,minZoom:g,maxZoom:f,zoomActivationKeyCode:y,preventScrolling:v=!0,children:b,noWheelClassName:E,noPanClassName:N})=>{const C=t.useRef(),w=Ru(),S=t.useRef(!1),x=t.useRef(!1),R=t.useRef(null),M=t.useRef({x:0,y:0,zoom:0}),{d3Zoom:_,d3Selection:I,d3ZoomHandler:k,userSelectionActive:L}=xu(Lm,Ti),T=um(y),D=t.useRef(0),A=t.useRef(!1),$=t.useRef();return function(e){const n=Ru();t.useEffect(()=>{let t;const a=()=>{if(!e.current)return;const t=Lu(e.current);0!==t.height&&0!==t.width||n.getState().onError?.("004",yu()),n.setState({width:t.width||500,height:t.height||500})};return a(),window.addEventListener("resize",a),e.current&&(t=new ResizeObserver(()=>a()),t.observe(e.current)),()=>{window.removeEventListener("resize",a),t&&e.current&&t.unobserve(e.current)}},[])}(R),t.useEffect(()=>{if(R.current){const e=R.current.getBoundingClientRect(),t=function(){var e,t,n,a=lu,o=cu,r=mu,s=uu,i=hu,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,u=ld,h=Ai("start","zoom","end"),m=0,p=10;function g(e){e.property("__zoom",du).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",S).filter(i).on("touchstart.zoom",x).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new ou(t,e.x,e.y)}function y(e,t,n){var a=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return a===e.x&&o===e.y?e:new ou(e.k,a,o)}function v(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function b(e,t,n,a){e.on("start.zoom",function(){E(this,arguments).event(a).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(a).end()}).tween("zoom",function(){var e=this,r=arguments,s=E(e,r).event(a),i=o.apply(e,r),l=null==n?v(i):"function"==typeof n?n.apply(e,r):n,c=Math.max(i[1][0]-i[0][0],i[1][1]-i[0][1]),d=e.__zoom,h="function"==typeof t?t.apply(e,r):t,m=u(d.invert(l).concat(c/d.k),h.invert(l).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=m(e),n=c/t[2];e=new ou(n,l[0]-t[0]*n,l[1]-t[1]*n)}s.zoom(null,e)}})}function E(e,t,n){return!n&&e.__zooming||new N(e,t)}function N(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function C(e,...t){if(a.apply(this,arguments)){var n=E(this,t).event(e),o=this.__zoom,i=Math.max(l[0],Math.min(l[1],o.k*Math.pow(2,s.apply(this,arguments)))),d=Ql(e);if(n.wheel)n.mouse[0][0]===d[0]&&n.mouse[0][1]===d[1]||(n.mouse[1]=o.invert(n.mouse[0]=d)),clearTimeout(n.wheel);else{if(o.k===i)return;n.mouse=[d,o.invert(d)],Ld(this),n.start()}iu(e),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",r(y(f(o,i),n.mouse[0],n.mouse[1]),n.extent,c))}}function w(e,...t){if(!n&&a.apply(this,arguments)){var o=e.currentTarget,s=E(this,t,!0).event(e),i=Kl(e.view).on("mousemove.zoom",function(e){if(iu(e),!s.moved){var t=e.clientX-d,n=e.clientY-u;s.moved=t*t+n*n>m}s.event(e).zoom("mouse",r(y(s.that.__zoom,s.mouse[0]=Ql(e,o),s.mouse[1]),s.extent,c))},!0).on("mouseup.zoom",function(e){i.on("mousemove.zoom mouseup.zoom",null),ac(e.view,s.moved),iu(e),s.event(e).end()},!0),l=Ql(e,o),d=e.clientX,u=e.clientY;nc(e.view),su(e),s.mouse=[l,this.__zoom.invert(l)],Ld(this),s.start()}}function S(e,...t){if(a.apply(this,arguments)){var n=this.__zoom,s=Ql(e.changedTouches?e.changedTouches[0]:e,this),i=n.invert(s),l=n.k*(e.shiftKey?.5:2),u=r(y(f(n,l),s,i),o.apply(this,t),c);iu(e),d>0?Kl(this).transition().duration(d).call(b,u,s,e):Kl(this).call(g.transform,u,s,e)}}function x(n,...o){if(a.apply(this,arguments)){var r,s,i,l,c=n.touches,d=c.length,u=E(this,o,n.changedTouches.length===d).event(n);for(su(n),s=0;s<d;++s)l=[l=Ql(i=c[s],this),this.__zoom.invert(l),i.identifier],u.touch0?u.touch1||u.touch0[2]===l[2]||(u.touch1=l,u.taps=0):(u.touch0=l,r=!0,u.taps=1+!!e);e&&(e=clearTimeout(e)),r&&(u.taps<2&&(t=l[0],e=setTimeout(function(){e=null},500)),Ld(this),u.start())}}function R(e,...t){if(this.__zooming){var n,a,o,s,i=E(this,t).event(e),l=e.changedTouches,d=l.length;for(iu(e),n=0;n<d;++n)o=Ql(a=l[n],this),i.touch0&&i.touch0[2]===a.identifier?i.touch0[0]=o:i.touch1&&i.touch1[2]===a.identifier&&(i.touch1[0]=o);if(a=i.that.__zoom,i.touch1){var u=i.touch0[0],h=i.touch0[1],m=i.touch1[0],p=i.touch1[1],g=(g=m[0]-u[0])*g+(g=m[1]-u[1])*g,v=(v=p[0]-h[0])*v+(v=p[1]-h[1])*v;a=f(a,Math.sqrt(g/v)),o=[(u[0]+m[0])/2,(u[1]+m[1])/2],s=[(h[0]+p[0])/2,(h[1]+p[1])/2]}else{if(!i.touch0)return;o=i.touch0[0],s=i.touch0[1]}i.zoom("touch",r(y(a,o,s),i.extent,c))}}function M(e,...a){if(this.__zooming){var o,r,s=E(this,a).event(e),i=e.changedTouches,l=i.length;for(su(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),o=0;o<l;++o)r=i[o],s.touch0&&s.touch0[2]===r.identifier?delete s.touch0:s.touch1&&s.touch1[2]===r.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(r=Ql(r,this),Math.hypot(t[0]-r[0],t[1]-r[1])<p)){var c=Kl(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return g.transform=function(e,t,n,a){var o=e.selection?e.selection():e;o.property("__zoom",du),e!==o?b(e,t,n,a):o.interrupt().each(function(){E(this,arguments).event(a).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},g.scaleBy=function(e,t,n,a){g.scaleTo(e,function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)},n,a)},g.scaleTo=function(e,t,n,a){g.transform(e,function(){var e=o.apply(this,arguments),a=this.__zoom,s=null==n?v(e):"function"==typeof n?n.apply(this,arguments):n,i=a.invert(s),l="function"==typeof t?t.apply(this,arguments):t;return r(y(f(a,l),s,i),e,c)},n,a)},g.translateBy=function(e,t,n,a){g.transform(e,function(){return r(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)},null,a)},g.translateTo=function(e,t,n,a,s){g.transform(e,function(){var e=o.apply(this,arguments),s=this.__zoom,i=null==a?v(e):"function"==typeof a?a.apply(this,arguments):a;return r(ru.translate(i[0],i[1]).scale(s.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)},a,s)},N.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Kl(this.that).datum();h.call(e,this.that,new au(e,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:h}),t)}},g.wheelDelta=function(e){return arguments.length?(s="function"==typeof e?e:nu(+e),g):s},g.filter=function(e){return arguments.length?(a="function"==typeof e?e:nu(!!e),g):a},g.touchable=function(e){return arguments.length?(i="function"==typeof e?e:nu(!!e),g):i},g.extent=function(e){return arguments.length?(o="function"==typeof e?e:nu([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),g):o},g.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],g):[l[0],l[1]]},g.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],g):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},g.constrain=function(e){return arguments.length?(r=e,g):r},g.duration=function(e){return arguments.length?(d=+e,g):d},g.interpolate=function(e){return arguments.length?(u=e,g):u},g.on=function(){var e=h.on.apply(h,arguments);return e===h?g:e},g.clickDistance=function(e){return arguments.length?(m=(e=+e)*e,g):Math.sqrt(m)},g.tapDistance=function(e){return arguments.length?(p=+e,g):p},g}().scaleExtent([g,f]).translateExtent(p),n=Kl(R.current).call(t),a=ru.translate(m.x,m.y).scale(Tu(m.zoom,g,f)),o=[[0,0],[e.width,e.height]],r=t.constrain()(a,o,p);t.transform(n,r),t.wheelDelta(km),w.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[r.x,r.y,r.k],domNode:R.current.closest(".react-flow")})}},[]),t.useEffect(()=>{I&&_&&(!i||T||L?void 0!==k&&I.on("wheel.zoom",function(e,t){if(!v&&"wheel"===e.type&&!e.ctrlKey||_m(e,E))return null;e.preventDefault(),k.call(this,e,t)},{passive:!1}):I.on("wheel.zoom",t=>{if(_m(t,E))return!1;t.preventDefault(),t.stopImmediatePropagation();const o=I.property("__zoom").k||1;if(t.ctrlKey&&s){const e=Ql(t),n=km(t),a=o*Math.pow(2,n);return void _.scaleTo(I,a,e,t)}const r=1===t.deltaMode?20:1;let i=c===Wu.Vertical?0:t.deltaX*r,d=c===Wu.Horizontal?0:t.deltaY*r;!Xu()&&t.shiftKey&&c!==Wu.Vertical&&(i=t.deltaY*r,d=0),_.translateBy(I,-i/o*l,-d/o*l,{internal:!0});const u=Mm(I.property("__zoom")),{onViewportChangeStart:h,onViewportChange:m,onViewportChangeEnd:p}=w.getState();clearTimeout($.current),A.current||(A.current=!0,n?.(t,u),h?.(u)),A.current&&(e?.(t,u),m?.(u),$.current=setTimeout(()=>{a?.(t,u),p?.(u),A.current=!1},150))},{passive:!1}))},[L,i,c,I,_,k,T,s,v,E,n,e,a]),t.useEffect(()=>{_&&_.on("start",e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;D.current=e.sourceEvent?.button;const{onViewportChangeStart:t}=w.getState(),a=Mm(e.transform);S.current=!0,M.current=a,"mousedown"===e.sourceEvent?.type&&w.setState({paneDragging:!0}),t?.(a),n?.(e.sourceEvent,a)})},[_,n]),t.useEffect(()=>{_&&(L&&!S.current?_.on("zoom",null):L||_.on("zoom",t=>{const{onViewportChange:n}=w.getState();if(w.setState({transform:[t.transform.x,t.transform.y,t.transform.k]}),x.current=!(!o||!Im(h,D.current??0)),(e||n)&&!t.sourceEvent?.internal){const a=Mm(t.transform);n?.(a),e?.(t.sourceEvent,a)}}))},[L,_,e,h,o]),t.useEffect(()=>{_&&_.on("end",e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;const{onViewportChangeEnd:t}=w.getState();if(S.current=!1,w.setState({paneDragging:!1}),o&&Im(h,D.current??0)&&!x.current&&o(e.sourceEvent),x.current=!1,(a||t)&&(n=M.current,r=e.transform,n.x!==r.x||n.y!==r.y||n.zoom!==r.k)){const n=Mm(e.transform);M.current=n,clearTimeout(C.current),C.current=setTimeout(()=>{t?.(n),a?.(e.sourceEvent,n)},i?150:0)}var n,r})},[_,i,h,a,o]),t.useEffect(()=>{_&&_.filter(e=>{const t=T||r,n=s&&e.ctrlKey;if((!0===h||Array.isArray(h)&&h.includes(1))&&1===e.button&&"mousedown"===e.type&&(_m(e,"react-flow__node")||_m(e,"react-flow__edge")))return!0;if(!(h||t||i||d||s))return!1;if(L)return!1;if(!d&&"dblclick"===e.type)return!1;if(_m(e,E)&&"wheel"===e.type)return!1;if(_m(e,N)&&("wheel"!==e.type||i&&"wheel"===e.type&&!T))return!1;if(!s&&e.ctrlKey&&"wheel"===e.type)return!1;if(!t&&!i&&!n&&"wheel"===e.type)return!1;if(!h&&("mousedown"===e.type||"touchstart"===e.type))return!1;if(Array.isArray(h)&&!h.includes(e.button)&&"mousedown"===e.type)return!1;const a=Array.isArray(h)&&h.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&a})},[L,_,r,s,i,d,h,u,T]),t.createElement("div",{className:"react-flow__renderer",ref:R,style:Rm},b)},Dm=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Am(){const{userSelectionActive:e,userSelectionRect:n}=xu(Dm,Ti);return e&&n?t.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:n.width,height:n.height,transform:`translate(${n.x}px, ${n.y}px)`}}):null}function $m(e,t){const n=t.parentNode||t.parentId,a=e.find(e=>e.id===n);if(a){const e=t.position.x+t.width-a.width,n=t.position.y+t.height-a.height;if(e>0||n>0||t.position.x<0||t.position.y<0){if(a.style={...a.style}||{},a.style.width=a.style.width??a.width,a.style.height=a.style.height??a.height,e>0&&(a.style.width+=e),n>0&&(a.style.height+=n),t.position.x<0){const e=Math.abs(t.position.x);a.position.x=a.position.x-e,a.style.width+=e,t.position.x=0}if(t.position.y<0){const e=Math.abs(t.position.y);a.position.y=a.position.y-e,a.style.height+=e,t.position.y=0}a.width=a.style.width,a.height=a.style.height}}}function Om(e,t){return function(e,t){if(e.some(e=>"reset"===e.type))return e.filter(e=>"reset"===e.type).map(e=>e.item);const n=e.filter(e=>"add"===e.type).map(e=>e.item);return t.reduce((t,n)=>{const a=e.filter(e=>e.id===n.id);if(0===a.length)return t.push(n),t;const o={...n};for(const e of a)if(e)switch(e.type){case"select":o.selected=e.selected;break;case"position":void 0!==e.position&&(o.position=e.position),void 0!==e.positionAbsolute&&(o.positionAbsolute=e.positionAbsolute),void 0!==e.dragging&&(o.dragging=e.dragging),o.expandParent&&$m(t,o);break;case"dimensions":void 0!==e.dimensions&&(o.width=e.dimensions.width,o.height=e.dimensions.height),void 0!==e.updateStyle&&(o.style={...o.style||{},...e.dimensions}),"boolean"==typeof e.resizing&&(o.resizing=e.resizing),o.expandParent&&$m(t,o);break;case"remove":return t}return t.push(o),t},n)}(e,t)}const Pm=(e,t)=>({id:e,type:"select",selected:t});function zm(e,t){return e.reduce((e,n)=>{const a=t.includes(n.id);return!n.selected&&a?(n.selected=!0,e.push(Pm(n.id,!0))):n.selected&&!a&&(n.selected=!1,e.push(Pm(n.id,!1))),e},[])}const Vm=(e,t)=>n=>{n.target===t.current&&e?.(n)},Bm=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),jm=t.memo(({isSelecting:e,selectionMode:n=Ju.Full,panOnDrag:a,onSelectionStart:o,onSelectionEnd:r,onPaneClick:s,onPaneContextMenu:i,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:h})=>{const m=t.useRef(null),p=Ru(),g=t.useRef(0),f=t.useRef(0),y=t.useRef(),{userSelectionActive:v,elementsSelectable:b,dragging:E}=xu(Bm,Ti),N=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),g.current=0,f.current=0},C=e=>{s?.(e),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},w=l?e=>l(e):void 0,S=b&&(e||v);return t.createElement("div",{className:pi(["react-flow__pane",{dragging:E,selection:e}]),onClick:S?void 0:Vm(C,m),onContextMenu:Vm(e=>{Array.isArray(a)&&a?.includes(2)?e.preventDefault():i?.(e)},m),onWheel:Vm(w,m),onMouseEnter:S?void 0:c,onMouseDown:S?t=>{const{resetSelectedElements:n,domNode:a}=p.getState();if(y.current=a?.getBoundingClientRect(),!b||!e||0!==t.button||t.target!==m.current||!y.current)return;const{x:r,y:s}=Yu(t,y.current);n(),p.setState({userSelectionRect:{width:0,height:0,startX:r,startY:s,x:r,y:s}}),o?.(t)}:void 0,onMouseMove:S?t=>{const{userSelectionRect:a,nodeInternals:o,edges:r,transform:s,onNodesChange:i,onEdgesChange:l,nodeOrigin:c,getNodes:d}=p.getState();if(!e||!y.current||!a)return;p.setState({userSelectionActive:!0,nodesSelectionActive:!1});const u=Yu(t,y.current),h=a.startX??0,m=a.startY??0,v={...a,x:u.x<h?u.x:h,y:u.y<m?u.y:m,width:Math.abs(u.x-h),height:Math.abs(u.y-m)},b=d(),E=xh(o,v,s,n===Ju.Partial,!0,c),N=Rh(E,r).map(e=>e.id),C=E.map(e=>e.id);if(g.current!==C.length){g.current=C.length;const e=zm(b,C);e.length&&i?.(e)}if(f.current!==N.length){f.current=N.length;const e=zm(r,N);e.length&&l?.(e)}p.setState({userSelectionRect:v})}:d,onMouseUp:S?e=>{if(0!==e.button)return;const{userSelectionRect:t}=p.getState();!v&&t&&e.target===m.current&&C?.(e),p.setState({nodesSelectionActive:g.current>0}),N(),r?.(e)}:void 0,onMouseLeave:S?e=>{v&&(p.setState({nodesSelectionActive:g.current>0}),r?.(e)),N()}:u,ref:m,style:Rm},h,t.createElement(Am,null))});function Fm(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const a=t.get(n);return!!a&&(!!a.selected||Fm(a,t))}function Hm(e,t,n){let a=e;do{if(a?.matches(t))return!0;if(a===n.current)return!1;a=a.parentElement}while(a);return!1}function Zm(e,t,n,a){return Array.from(e.values()).filter(n=>(n.selected||n.id===a)&&(!n.parentNode||n.parentId||!Fm(n,e))&&(n.draggable||t&&void 0===n.draggable)).map(e=>({id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-(e.positionAbsolute?.x??0),y:n.y-(e.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent}))}function Ym(e,t,n,a,o=[0,0],r){const s=function(e,t){return t&&"parent"!==t?[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]:t}(e,e.extent||a);let i=s;const l=e.parentNode||e.parentId;if("parent"!==e.extent||e.expandParent){if(e.extent&&l&&"parent"!==e.extent){const t=n.get(l),{x:a,y:r}=wh(t,o).positionAbsolute;i=[[e.extent[0][0]+a,e.extent[0][1]+r],[e.extent[1][0]+a,e.extent[1][1]+r]]}}else if(l&&e.width&&e.height){const t=n.get(l),{x:a,y:r}=wh(t,o).positionAbsolute;i=t&&Bu(a)&&Bu(r)&&Bu(t.width)&&Bu(t.height)?[[a+e.width*o[0],r+e.height*o[1]],[a+t.width-e.width+e.width*o[0],r+t.height-e.height+e.height*o[1]]]:i}else r?.("005",vu()),i=s;let c={x:0,y:0};if(l){const e=n.get(l);c=wh(e,o).positionAbsolute}const d=i&&"parent"!==i?Du(t,i):t;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function Xm({nodeId:e,dragItems:t,nodeInternals:n}){const a=t.map(e=>({...n.get(e.id),position:e.position,positionAbsolute:e.positionAbsolute}));return[e?a.find(t=>t.id===e):a[0],a]}jm.displayName="Pane";const Um=(e,t,n,a)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const r=Array.from(o),s=t.getBoundingClientRect(),i=s.width*a[0],l=s.height*a[1];return r.map(e=>{const t=e.getBoundingClientRect();return{id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(t.left-s.left-i)/n,y:(t.top-s.top-l)/n,...Lu(e)}})};function Gm(e,t,n){return void 0===n?n:a=>{const o=t().nodeInternals.get(e);o&&n(a,{...o})}}function qm({id:e,store:t,unselect:n=!1,nodeRef:a}){const{addSelectedNodes:o,unselectNodesAndEdges:r,multiSelectionActive:s,nodeInternals:i,onError:l}=t.getState(),c=i.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(r({nodes:[c],edges:[]}),requestAnimationFrame(()=>a?.current?.blur())):o([e])):l?.("012",wu(e))}function Km(e){return(t,n,a)=>e?.(t,a)}function Qm({nodeRef:e,disabled:n=!1,noDragClassName:a,handleSelector:o,nodeId:r,isSelectable:s,selectNodesOnDrag:i}){const l=Ru(),[c,d]=t.useState(!1),u=t.useRef([]),h=t.useRef({x:null,y:null}),m=t.useRef(0),p=t.useRef(null),g=t.useRef({x:0,y:0}),f=t.useRef(null),y=t.useRef(!1),v=t.useRef(!1),b=t.useRef(!1),E=function(){const e=Ru(),n=t.useCallback(({sourceEvent:t})=>{const{transform:n,snapGrid:a,snapToGrid:o}=e.getState(),r=t.touches?t.touches[0].clientX:t.clientX,s=t.touches?t.touches[0].clientY:t.clientY,i={x:(r-n[0])/n[2],y:(s-n[1])/n[2]};return{xSnapped:o?a[0]*Math.round(i.x/a[0]):i.x,ySnapped:o?a[1]*Math.round(i.y/a[1]):i.y,...i}},[]);return n}();return t.useEffect(()=>{if(e?.current){const t=Kl(e.current),c=({x:e,y:t})=>{const{nodeInternals:n,onNodeDrag:a,onSelectionDrag:o,updateNodePositions:s,nodeExtent:i,snapGrid:c,snapToGrid:m,nodeOrigin:p,onError:g}=l.getState();h.current={x:e,y:t};let y=!1,v={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&i){const e=Sh(u.current,p);v=Pu(e)}if(u.current=u.current.map(a=>{const o={x:e-a.distance.x,y:t-a.distance.y};m&&(o.x=c[0]*Math.round(o.x/c[0]),o.y=c[1]*Math.round(o.y/c[1]));const r=[[i[0][0],i[0][1]],[i[1][0],i[1][1]]];u.current.length>1&&i&&!a.extent&&(r[0][0]=a.positionAbsolute.x-v.x+i[0][0],r[1][0]=a.positionAbsolute.x+(a.width??0)-v.x2+i[1][0],r[0][1]=a.positionAbsolute.y-v.y+i[0][1],r[1][1]=a.positionAbsolute.y+(a.height??0)-v.y2+i[1][1]);const s=Ym(a,o,n,r,p,g);return y=y||a.position.x!==s.position.x||a.position.y!==s.position.y,a.position=s.position,a.positionAbsolute=s.positionAbsolute,a}),!y)return;s(u.current,!0,!0),d(!0);const b=r?a:Km(o);if(b&&f.current){const[e,t]=Xm({nodeId:r,dragItems:u.current,nodeInternals:n});b(f.current,e,t)}},N=()=>{if(!p.current)return;const[e,t]=$u(g.current,p.current);if(0!==e||0!==t){const{transform:n,panBy:a}=l.getState();h.current.x=(h.current.x??0)-e/n[2],h.current.y=(h.current.y??0)-t/n[2],a({x:e,y:t})&&c(h.current)}m.current=requestAnimationFrame(N)},C=t=>{const{nodeInternals:n,multiSelectionActive:a,nodesDraggable:o,unselectNodesAndEdges:c,onNodeDragStart:d,onSelectionDragStart:m}=l.getState();v.current=!0;const p=r?d:Km(m);i&&s||a||!r||n.get(r)?.selected||c(),r&&s&&i&&qm({id:r,store:l,nodeRef:e});const g=E(t);if(h.current=g,u.current=Zm(n,o,g,r),p&&u.current){const[e,a]=Xm({nodeId:r,dragItems:u.current,nodeInternals:n});p(t.sourceEvent,e,a)}};if(!n){const n=function(){var e,t,n,a,o=sc,r=ic,s=lc,i=cc,l={},c=Ai("start","drag","end"),d=0,u=0;function h(e){e.on("mousedown.drag",m).filter(i).on("touchstart.drag",f).on("touchmove.drag",y,Wl).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(s,i){if(!a&&o.call(this,s,i)){var l=b(this,r.call(this,s,i),s,i,"mouse");l&&(Kl(s.view).on("mousemove.drag",p,Jl).on("mouseup.drag",g,Jl),nc(s.view),ec(s),n=!1,e=s.clientX,t=s.clientY,l("start",s))}}function p(a){if(tc(a),!n){var o=a.clientX-e,r=a.clientY-t;n=o*o+r*r>u}l.mouse("drag",a)}function g(e){Kl(e.view).on("mousemove.drag mouseup.drag",null),ac(e.view,n),tc(e),l.mouse("end",e)}function f(e,t){if(o.call(this,e,t)){var n,a,s=e.changedTouches,i=r.call(this,e,t),l=s.length;for(n=0;n<l;++n)(a=b(this,i,e,t,s[n].identifier,s[n]))&&(ec(e),a("start",e,s[n]))}}function y(e){var t,n,a=e.changedTouches,o=a.length;for(t=0;t<o;++t)(n=l[a[t].identifier])&&(tc(e),n("drag",e,a[t]))}function v(e){var t,n,o=e.changedTouches,r=o.length;for(a&&clearTimeout(a),a=setTimeout(function(){a=null},500),t=0;t<r;++t)(n=l[o[t].identifier])&&(ec(e),n("end",e,o[t]))}function b(e,t,n,a,o,r){var i,u,m,p=c.copy(),g=Ql(r||n,t);if(null!=(m=s.call(e,new rc("beforestart",{sourceEvent:n,target:h,identifier:o,active:d,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),a)))return i=m.x-g[0]||0,u=m.y-g[1]||0,function n(r,s,c){var f,y=g;switch(r){case"start":l[o]=n,f=d++;break;case"end":delete l[o],--d;case"drag":g=Ql(c||s,t),f=d}p.call(r,e,new rc(r,{sourceEvent:s,subject:m,target:h,identifier:o,active:f,x:g[0]+i,y:g[1]+u,dx:g[0]-y[0],dy:g[1]-y[1],dispatch:p}),a)}}return h.filter=function(e){return arguments.length?(o="function"==typeof e?e:oc(!!e),h):o},h.container=function(e){return arguments.length?(r="function"==typeof e?e:oc(e),h):r},h.subject=function(e){return arguments.length?(s="function"==typeof e?e:oc(e),h):s},h.touchable=function(e){return arguments.length?(i="function"==typeof e?e:oc(!!e),h):i},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(u=(e=+e)*e,h):Math.sqrt(u)},h}().on("start",e=>{const{domNode:t,nodeDragThreshold:n}=l.getState();0===n&&C(e),b.current=!1;const a=E(e);h.current=a,p.current=t?.getBoundingClientRect()||null,g.current=Yu(e.sourceEvent,p.current)}).on("drag",e=>{const t=E(e),{autoPanOnNodeDrag:n,nodeDragThreshold:a}=l.getState();if("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1&&(b.current=!0),!b.current){if(!y.current&&v.current&&n&&(y.current=!0,N()),!v.current){const n=t.xSnapped-(h?.current?.x??0),o=t.ySnapped-(h?.current?.y??0);Math.sqrt(n*n+o*o)>a&&C(e)}(h.current.x!==t.xSnapped||h.current.y!==t.ySnapped)&&u.current&&v.current&&(f.current=e.sourceEvent,g.current=Yu(e.sourceEvent,p.current),c(t))}}).on("end",e=>{if(v.current&&!b.current&&(d(!1),y.current=!1,v.current=!1,cancelAnimationFrame(m.current),u.current)){const{updateNodePositions:t,nodeInternals:n,onNodeDragStop:a,onSelectionDragStop:o}=l.getState(),s=r?a:Km(o);if(t(u.current,!1,!1),s){const[t,a]=Xm({nodeId:r,dragItems:u.current,nodeInternals:n});s(e.sourceEvent,t,a)}}}).filter(t=>{const n=t.target;return!t.button&&(!a||!Hm(n,`.${a}`,e))&&(!o||Hm(n,o,e))});return t.call(n),()=>{t.on(".drag",null)}}t.on(".drag",null)}},[e,n,a,o,s,l,r,i,E]),c}function Wm(){const e=Ru();return t.useCallback(t=>{const{nodeInternals:n,nodeExtent:a,updateNodePositions:o,getNodes:r,snapToGrid:s,snapGrid:i,onError:l,nodesDraggable:c}=e.getState(),d=r().filter(e=>e.selected&&(e.draggable||c&&void 0===e.draggable)),u=s?i[0]:5,h=s?i[1]:5,m=t.isShiftPressed?4:1,p=t.x*u*m,g=t.y*h*m;o(d.map(e=>{if(e.positionAbsolute){const t={x:e.positionAbsolute.x+p,y:e.positionAbsolute.y+g};s&&(t.x=i[0]*Math.round(t.x/i[0]),t.y=i[1]*Math.round(t.y/i[1]));const{positionAbsolute:o,position:r}=Ym(e,t,n,a,void 0,l);e.position=r,e.positionAbsolute=o}return e}),!0,!1)},[])}const Jm={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var ep=e=>{const n=({id:n,type:a,data:o,xPos:r,yPos:s,xPosOrigin:i,yPosOrigin:l,selected:c,onClick:d,onMouseEnter:u,onMouseMove:h,onMouseLeave:m,onContextMenu:p,onDoubleClick:g,style:f,className:y,isDraggable:v,isSelectable:b,isConnectable:E,isFocusable:N,selectNodesOnDrag:C,sourcePosition:w,targetPosition:S,hidden:x,resizeObserver:R,dragHandle:M,zIndex:_,isParent:I,noDragClassName:k,noPanClassName:L,initialized:T,disableKeyboardA11y:D,ariaLabel:A,rfId:$,hasHandleBounds:O})=>{const P=Ru(),z=t.useRef(null),V=t.useRef(null),B=t.useRef(w),j=t.useRef(S),F=t.useRef(a),H=b||v||d||u||h||m,Z=Wm(),Y=Gm(n,P.getState,u),X=Gm(n,P.getState,h),U=Gm(n,P.getState,m),G=Gm(n,P.getState,p),q=Gm(n,P.getState,g);t.useEffect(()=>()=>{V.current&&(R?.unobserve(V.current),V.current=null)},[]),t.useEffect(()=>{if(z.current&&!x){const e=z.current;T&&O&&V.current===e||(V.current&&R?.unobserve(V.current),R?.observe(e),V.current=e)}},[x,T,O]),t.useEffect(()=>{const e=F.current!==a,t=B.current!==w,o=j.current!==S;z.current&&(e||t||o)&&(e&&(F.current=a),t&&(B.current=w),o&&(j.current=S),P.getState().updateNodeDimensions([{id:n,nodeElement:z.current,forceUpdate:!0}]))},[n,a,w,S]);const K=Qm({nodeRef:z,disabled:x||!v,noDragClassName:k,handleSelector:M,nodeId:n,isSelectable:b,selectNodesOnDrag:C});return x?null:t.createElement("div",{className:pi(["react-flow__node",`react-flow__node-${a}`,{[L]:v},y,{selected:c,selectable:b,parent:I,dragging:K}]),ref:z,style:{zIndex:_,transform:`translate(${i}px,${l}px)`,pointerEvents:H?"all":"none",visibility:T?"visible":"hidden",...f},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Y,onMouseMove:X,onMouseLeave:U,onContextMenu:G,onClick:e=>{const{nodeDragThreshold:t}=P.getState();if(b&&(!C||!v||t>0)&&qm({id:n,store:P,nodeRef:z}),d){const t=P.getState().nodeInternals.get(n);t&&d(e,{...t})}},onDoubleClick:q,onKeyDown:N?e=>{if(!Hu(e)&&!D)if(Fu.includes(e.key)&&b){const t="Escape"===e.key;qm({id:n,store:P,unselect:t,nodeRef:z})}else v&&c&&Object.prototype.hasOwnProperty.call(Jm,e.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${e.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~r}, y: ${~~s}`}),Z({x:Jm[e.key].x,y:Jm[e.key].y,isShiftPressed:e.shiftKey}))}:void 0,tabIndex:N?0:void 0,role:N?"button":void 0,"aria-describedby":D?void 0:`${sm}-${$}`,"aria-label":A},t.createElement(vh,{value:n},t.createElement(e,{id:n,data:o,type:a,xPos:r,yPos:s,selected:c,isConnectable:E,sourcePosition:w,targetPosition:S,dragging:K,dragHandle:M,zIndex:_})))};return n.displayName="NodeWrapper",t.memo(n)};const tp=e=>{const t=e.getNodes().filter(e=>e.selected);return{...Sh(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};var np=t.memo(function({onSelectionContextMenu:e,noPanClassName:n,disableKeyboardA11y:a}){const o=Ru(),{width:r,height:s,x:i,y:l,transformString:c,userSelectionActive:d}=xu(tp,Ti),u=Wm(),h=t.useRef(null);if(t.useEffect(()=>{a||h.current?.focus({preventScroll:!0})},[a]),Qm({nodeRef:h}),d||!r||!s)return null;const m=e?t=>{const n=o.getState().getNodes().filter(e=>e.selected);e(t,n)}:void 0;return t.createElement("div",{className:pi(["react-flow__nodesselection","react-flow__container",n]),style:{transform:c}},t.createElement("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:a?void 0:-1,onKeyDown:a?void 0:e=>{Object.prototype.hasOwnProperty.call(Jm,e.key)&&u({x:Jm[e.key].x,y:Jm[e.key].y,isShiftPressed:e.shiftKey})},style:{width:r,height:s,top:l,left:i}}))});const ap=e=>e.nodesSelectionActive,op=({children:e,onPaneClick:n,onPaneMouseEnter:a,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:h,selectionOnDrag:m,selectionMode:p,onSelectionStart:g,onSelectionEnd:f,multiSelectionKeyCode:y,panActivationKeyCode:v,zoomActivationKeyCode:b,elementsSelectable:E,zoomOnScroll:N,zoomOnPinch:C,panOnScroll:w,panOnScrollSpeed:S,panOnScrollMode:x,zoomOnDoubleClick:R,panOnDrag:M,defaultViewport:_,translateExtent:I,minZoom:k,maxZoom:L,preventScrolling:T,onSelectionContextMenu:D,noWheelClassName:A,noPanClassName:$,disableKeyboardA11y:O})=>{const P=xu(ap),z=um(h),V=um(v),B=V||M,j=V||w,F=z||m&&!0!==B;return(({deleteKeyCode:e,multiSelectionKeyCode:n})=>{const a=Ru(),{deleteElements:o}=Sm(),r=um(e,xm),s=um(n);t.useEffect(()=>{if(r){const{edges:e,getNodes:t}=a.getState(),n=t().filter(e=>e.selected),r=e.filter(e=>e.selected);o({nodes:n,edges:r}),a.setState({nodesSelectionActive:!1})}},[r]),t.useEffect(()=>{a.setState({multiSelectionActive:s})},[s])})({deleteKeyCode:l,multiSelectionKeyCode:y}),t.createElement(Tm,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:s,elementsSelectable:E,zoomOnScroll:N,zoomOnPinch:C,panOnScroll:j,panOnScrollSpeed:S,panOnScrollMode:x,zoomOnDoubleClick:R,panOnDrag:!z&&B,defaultViewport:_,translateExtent:I,minZoom:k,maxZoom:L,zoomActivationKeyCode:b,preventScrolling:T,noWheelClassName:A,noPanClassName:$},t.createElement(jm,{onSelectionStart:g,onSelectionEnd:f,onPaneClick:n,onPaneMouseEnter:a,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:B,isSelecting:!!F,selectionMode:p},e,P&&t.createElement(np,{onSelectionContextMenu:D,noPanClassName:$,disableKeyboardA11y:O})))};op.displayName="FlowRenderer";var rp=t.memo(op);function sp(e){return{...{input:ep(e.input||Zh),default:ep(e.default||Fh),output:ep(e.output||Xh),group:ep(e.group||Uh)},...Object.keys(e).filter(e=>!["input","default","output","group"].includes(e)).reduce((t,n)=>(t[n]=ep(e[n]||Fh),t),{})}}const ip=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),lp=e=>{const{nodesDraggable:n,nodesConnectable:a,nodesFocusable:o,elementsSelectable:r,updateNodeDimensions:s,onError:i}=xu(ip,Ti),l=(c=e.onlyRenderVisibleElements,xu(t.useCallback(e=>c?xh(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):e.getNodes(),[c])));var c;const d=t.useRef(),u=t.useMemo(()=>{if("undefined"==typeof ResizeObserver)return null;const e=new ResizeObserver(e=>{const t=e.map(e=>({id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0}));s(t)});return d.current=e,e},[]);return t.useEffect(()=>()=>{d?.current?.disconnect()},[]),t.createElement("div",{className:"react-flow__nodes",style:Rm},l.map(s=>{let l=s.type||"default";e.nodeTypes[l]||(i?.("003",fu(l)),l="default");const c=e.nodeTypes[l]||e.nodeTypes.default,d=!!(s.draggable||n&&void 0===s.draggable),h=!!(s.selectable||r&&void 0===s.selectable),m=!!(s.connectable||a&&void 0===s.connectable),p=!!(s.focusable||o&&void 0===s.focusable),g=e.nodeExtent?Du(s.positionAbsolute,e.nodeExtent):s.positionAbsolute,f=g?.x??0,y=g?.y??0,v=(({x:e,y:t,width:n,height:a,origin:o})=>n&&a?o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-a*o[1]}:{x:e,y:t})({x:f,y:y,width:s.width??0,height:s.height??0,origin:e.nodeOrigin});return t.createElement(c,{key:s.id,id:s.id,className:s.className,style:s.style,type:l,data:s.data,sourcePosition:s.sourcePosition||nh.Bottom,targetPosition:s.targetPosition||nh.Top,hidden:s.hidden,xPos:f,yPos:y,xPosOrigin:v.x,yPosOrigin:v.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!s.selected,isDraggable:d,isSelectable:h,isConnectable:m,isFocusable:p,resizeObserver:u,dragHandle:s.dragHandle,zIndex:s[ju]?.z??0,isParent:!!s[ju]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!s.width&&!!s.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:s.ariaLabel,hasHandleBounds:!!s[ju]?.handleBounds})}))};lp.displayName="NodeRenderer";var cp=t.memo(lp);const dp=(e,t,n)=>n===nh.Left?e-t:n===nh.Right?e+t:e,up=(e,t,n)=>n===nh.Top?e-t:n===nh.Bottom?e+t:e,hp="react-flow__edgeupdater",mp=({position:e,centerX:n,centerY:a,radius:o=10,onMouseDown:r,onMouseEnter:s,onMouseOut:i,type:l})=>t.createElement("circle",{onMouseDown:r,onMouseEnter:s,onMouseOut:i,className:pi([hp,`${hp}-${l}`]),cx:dp(n,o,e),cy:up(a,o,e),r:o,stroke:"transparent",fill:"transparent"}),pp=()=>!0;var gp=e=>{const n=({id:n,className:a,type:o,data:r,onClick:s,onEdgeDoubleClick:i,selected:l,animated:c,label:d,labelStyle:u,labelShowBg:h,labelBgStyle:m,labelBgPadding:p,labelBgBorderRadius:g,style:f,source:y,target:v,sourceX:b,sourceY:E,targetX:N,targetY:C,sourcePosition:w,targetPosition:S,elementsSelectable:x,hidden:R,sourceHandleId:M,targetHandleId:_,onContextMenu:I,onMouseEnter:k,onMouseMove:L,onMouseLeave:T,reconnectRadius:D,onReconnect:A,onReconnectStart:$,onReconnectEnd:O,markerEnd:P,markerStart:z,rfId:V,ariaLabel:B,isFocusable:j,isReconnectable:F,pathOptions:H,interactionWidth:Z,disableKeyboardA11y:Y})=>{const X=t.useRef(null),[U,G]=t.useState(!1),[q,K]=t.useState(!1),Q=Ru(),W=t.useMemo(()=>`url('#${Eh(z,V)}')`,[z,V]),J=t.useMemo(()=>`url('#${Eh(P,V)}')`,[P,V]);if(R)return null;const ee=Gu(n,Q.getState,i),te=Gu(n,Q.getState,I),ne=Gu(n,Q.getState,k),ae=Gu(n,Q.getState,L),oe=Gu(n,Q.getState,T),re=(e,t)=>{if(0!==e.button)return;const{edges:a,isValidConnection:o}=Q.getState(),r=t?v:y,s=(t?_:M)||null,i=t?"target":"source",l=o||pp,c=t,d=a.find(e=>e.id===n);K(!0),$?.(e,d,i);Oh({event:e,handleId:s,nodeId:r,onConnect:e=>A?.(d,e),isTarget:c,getState:Q.getState,setState:Q.setState,isValidConnection:l,edgeUpdaterType:i,onReconnectEnd:e=>{K(!1),O?.(e,d,i)}})},se=()=>G(!0),ie=()=>G(!1),le=!x&&!s;return t.createElement("g",{className:pi(["react-flow__edge",`react-flow__edge-${o}`,a,{selected:l,animated:c,inactive:le,updating:U}]),onClick:e=>{const{edges:t,addSelectedEdges:a,unselectNodesAndEdges:o,multiSelectionActive:r}=Q.getState(),i=t.find(e=>e.id===n);i&&(x&&(Q.setState({nodesSelectionActive:!1}),i.selected&&r?(o({nodes:[],edges:[i]}),X.current?.blur()):a([n])),s&&s(e,i))},onDoubleClick:ee,onContextMenu:te,onMouseEnter:ne,onMouseMove:ae,onMouseLeave:oe,onKeyDown:j?e=>{if(!Y&&Fu.includes(e.key)&&x){const{unselectNodesAndEdges:t,addSelectedEdges:a,edges:o}=Q.getState();"Escape"===e.key?(X.current?.blur(),t({edges:[o.find(e=>e.id===n)]})):a([n])}}:void 0,tabIndex:j?0:void 0,role:j?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":null===B?void 0:B||`Edge from ${y} to ${v}`,"aria-describedby":j?`${im}-${V}`:void 0,ref:X},!q&&t.createElement(e,{id:n,source:y,target:v,selected:l,animated:c,label:d,labelStyle:u,labelShowBg:h,labelBgStyle:m,labelBgPadding:p,labelBgBorderRadius:g,data:r,style:f,sourceX:b,sourceY:E,targetX:N,targetY:C,sourcePosition:w,targetPosition:S,sourceHandleId:M,targetHandleId:_,markerStart:W,markerEnd:J,pathOptions:H,interactionWidth:Z}),F&&t.createElement(t.Fragment,null,("source"===F||!0===F)&&t.createElement(mp,{position:w,centerX:b,centerY:E,radius:D,onMouseDown:e=>re(e,!0),onMouseEnter:se,onMouseOut:ie,type:"source"}),("target"===F||!0===F)&&t.createElement(mp,{position:S,centerX:N,centerY:C,radius:D,onMouseDown:e=>re(e,!1),onMouseEnter:se,onMouseOut:ie,type:"target"})))};return n.displayName="EdgeWrapper",t.memo(n)};function fp(e){return{...{default:gp(e.default||fh),straight:gp(e.bezier||hh),step:gp(e.step||uh),smoothstep:gp(e.step||dh),simplebezier:gp(e.simplebezier||rh)},...Object.keys(e).filter(e=>!["default","bezier"].includes(e)).reduce((t,n)=>(t[n]=gp(e[n]||fh),t),{})}}function yp(e,t,n=null){const a=(n?.x||0)+t.x,o=(n?.y||0)+t.y,r=n?.width||t.width,s=n?.height||t.height;switch(e){case nh.Top:return{x:a+r/2,y:o};case nh.Right:return{x:a+r,y:o+s/2};case nh.Bottom:return{x:a+r/2,y:o+s};case nh.Left:return{x:a,y:o+s/2}}}function vp(e,t){return e?1!==e.length&&t?t&&e.find(e=>e.id===t)||null:e[0]:null}function bp(e){const t=e?.[ju]?.handleBounds||null,n=t&&e?.width&&e?.height&&void 0!==e?.positionAbsolute?.x&&void 0!==e?.positionAbsolute?.y;return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const Ep=[{level:0,isMaxLevel:!0,edges:[]}];function Np(e,n,a){return function(e,t,n=!1){let a=-1;const o=e.reduce((e,o)=>{const r=Bu(o.zIndex);let s=r?o.zIndex:0;if(n){const e=t.get(o.target),n=t.get(o.source),a=o.selected||e?.selected||n?.selected,i=Math.max(n?.[ju]?.z||0,e?.[ju]?.z||0,1e3);s=(r?o.zIndex:0)+(a?i:0)}return e[s]?e[s].push(o):e[s]=[o],a=s>a?s:a,e},{}),r=Object.entries(o).map(([e,t])=>{const n=+e;return{edges:t,level:n,isMaxLevel:n===a}});return 0===r.length?Ep:r}(xu(t.useCallback(t=>e?t.edges.filter(e=>{const a=n.get(e.source),o=n.get(e.target);return a?.width&&a?.height&&o?.width&&o?.height&&function({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:a,targetWidth:o,targetHeight:r,width:s,height:i,transform:l}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+a,t.y+r)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=Pu({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:s/l[2],height:i/l[2]}),u=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),h=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(u*h)>0}({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:o.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:o.width,targetHeight:o.height,width:t.width,height:t.height,transform:t.transform})}):t.edges,[e,n])),n,a)}const Cp={[th.Arrow]:({color:e="none",strokeWidth:n=1})=>t.createElement("polyline",{style:{stroke:e,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),[th.ArrowClosed]:({color:e="none",strokeWidth:n=1})=>t.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})};const wp=({id:e,type:n,color:a,width:o=12.5,height:r=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:l="auto-start-reverse"})=>{const c=function(e){const n=Ru();return t.useMemo(()=>Object.prototype.hasOwnProperty.call(Cp,e)?Cp[e]:(n.getState().onError?.("009",bu(e)),null),[e])}(n);return c?t.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0"},t.createElement(c,{color:a,strokeWidth:i})):null},Sp=({defaultColor:e,rfId:n})=>{const a=xu(t.useCallback((({defaultColor:e,rfId:t})=>n=>{const a=[];return n.edges.reduce((n,o)=>([o.markerStart,o.markerEnd].forEach(o=>{if(o&&"object"==typeof o){const r=Eh(o,t);a.includes(r)||(n.push({id:r,color:o.color||e,...o}),a.push(r))}}),n),[]).sort((e,t)=>e.id.localeCompare(t.id))})({defaultColor:e,rfId:n}),[e,n]),(e,t)=>!(e.length!==t.length||e.some((e,n)=>e.id!==t[n].id)));return t.createElement("defs",null,a.map(e=>t.createElement(wp,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient})))};Sp.displayName="MarkerDefinitions";var xp=t.memo(Sp);const Rp=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Mp=({defaultMarkerColor:e,onlyRenderVisibleElements:n,elevateEdgesOnSelect:a,rfId:o,edgeTypes:r,noPanClassName:s,onEdgeContextMenu:i,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:h,onReconnect:m,onReconnectStart:p,onReconnectEnd:g,reconnectRadius:f,children:y,disableKeyboardA11y:v})=>{const{edgesFocusable:b,edgesUpdatable:E,elementsSelectable:N,width:C,height:w,connectionMode:S,nodeInternals:x,onError:R}=xu(Rp,Ti),M=Np(n,x,a);return C?t.createElement(t.Fragment,null,M.map(({level:n,edges:a,isMaxLevel:y})=>t.createElement("svg",{key:n,style:{zIndex:n},width:C,height:w,className:"react-flow__edges react-flow__container"},y&&t.createElement(xp,{defaultColor:e,rfId:o}),t.createElement("g",null,a.map(e=>{const[n,a,y]=bp(x.get(e.source)),[C,w,M]=bp(x.get(e.target));if(!y||!M)return null;let _=e.type||"default";r[_]||(R?.("011",Cu(_)),_="default");const I=r[_]||r.default,k=S===Qu.Strict?w.target:(w.target??[]).concat(w.source??[]),L=vp(a.source,e.sourceHandle),T=vp(k,e.targetHandle),D=L?.position||nh.Bottom,A=T?.position||nh.Top,$=!!(e.focusable||b&&void 0===e.focusable),O=e.reconnectable||e.updatable,P=void 0!==m&&(O||E&&void 0===O);if(!L||!T)return R?.("008",Eu(L,e)),null;const{sourceX:z,sourceY:V,targetX:B,targetY:j}=((e,t,n,a,o,r)=>{const s=yp(n,e,t),i=yp(r,a,o);return{sourceX:s.x,sourceY:s.y,targetX:i.x,targetY:i.y}})(n,L,D,C,T,A);return t.createElement(I,{key:e.id,id:e.id,className:pi([e.className,s]),type:_,data:e.data,selected:!!e.selected,animated:!!e.animated,hidden:!!e.hidden,label:e.label,labelStyle:e.labelStyle,labelShowBg:e.labelShowBg,labelBgStyle:e.labelBgStyle,labelBgPadding:e.labelBgPadding,labelBgBorderRadius:e.labelBgBorderRadius,style:e.style,source:e.source,target:e.target,sourceHandleId:e.sourceHandle,targetHandleId:e.targetHandle,markerEnd:e.markerEnd,markerStart:e.markerStart,sourceX:z,sourceY:V,targetX:B,targetY:j,sourcePosition:D,targetPosition:A,elementsSelectable:N,onContextMenu:i,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:h,onReconnect:m,onReconnectStart:p,onReconnectEnd:g,reconnectRadius:f,rfId:o,ariaLabel:e.ariaLabel,isFocusable:$,isReconnectable:P,pathOptions:"pathOptions"in e?e.pathOptions:void 0,interactionWidth:e.interactionWidth,disableKeyboardA11y:v})})))),y):null};Mp.displayName="EdgeRenderer";var _p=t.memo(Mp);const Ip=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function kp({children:e}){const n=xu(Ip);return t.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},e)}const Lp={[nh.Left]:nh.Right,[nh.Right]:nh.Left,[nh.Top]:nh.Bottom,[nh.Bottom]:nh.Top},Tp=({nodeId:e,handleType:n,style:a,type:o=eh.Bezier,CustomComponent:r,connectionStatus:s})=>{const{fromNode:i,handleId:l,toX:c,toY:d,connectionMode:u}=xu(t.useCallback(t=>({fromNode:t.nodeInternals.get(e),handleId:t.connectionHandleId,toX:(t.connectionPosition.x-t.transform[0])/t.transform[2],toY:(t.connectionPosition.y-t.transform[1])/t.transform[2],connectionMode:t.connectionMode}),[e]),Ti),h=i?.[ju]?.handleBounds;let m=h?.[n];if(u===Qu.Loose&&(m=m||h?.["source"===n?"target":"source"]),!i||!m)return null;const p=l?m.find(e=>e.id===l):m[0],g=p?p.x+p.width/2:(i.width??0)/2,f=p?p.y+p.height/2:i.height??0,y=(i.positionAbsolute?.x??0)+g,v=(i.positionAbsolute?.y??0)+f,b=p?.position,E=b?Lp[b]:null;if(!b||!E)return null;if(r)return t.createElement(r,{connectionLineType:o,connectionLineStyle:a,fromNode:i,fromHandle:p,fromX:y,fromY:v,toX:c,toY:d,fromPosition:b,toPosition:E,connectionStatus:s});let N="";const C={sourceX:y,sourceY:v,sourcePosition:b,targetX:c,targetY:d,targetPosition:E};return o===eh.Bezier?[N]=gh(C):o===eh.Step?[N]=ch({...C,borderRadius:0}):o===eh.SmoothStep?[N]=ch(C):o===eh.SimpleBezier?[N]=oh(C):N=`M${y},${v} ${c},${d}`,t.createElement("path",{d:N,fill:"none",className:"react-flow__connection-path",style:a})};Tp.displayName="ConnectionLine";const Dp=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Ap({containerStyle:e,style:n,type:a,component:o}){const{nodeId:r,handleType:s,nodesConnectable:i,width:l,height:c,connectionStatus:d}=xu(Dp,Ti);return!!(r&&s&&l&&i)?t.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},t.createElement("g",{className:pi(["react-flow__connection",d])},t.createElement(Tp,{nodeId:r,handleType:s,style:n,type:a,CustomComponent:o,connectionStatus:d}))):null}function $p(e,n){t.useRef(null),Ru();return t.useMemo(()=>n(e),[e])}const Op=({nodeTypes:e,edgeTypes:n,onMove:a,onMoveStart:o,onMoveEnd:r,onInit:s,onNodeClick:i,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:h,onNodeMouseLeave:m,onNodeContextMenu:p,onSelectionContextMenu:g,onSelectionStart:f,onSelectionEnd:y,connectionLineType:v,connectionLineStyle:b,connectionLineComponent:E,connectionLineContainerStyle:N,selectionKeyCode:C,selectionOnDrag:w,selectionMode:S,multiSelectionKeyCode:x,panActivationKeyCode:R,zoomActivationKeyCode:M,deleteKeyCode:_,onlyRenderVisibleElements:I,elementsSelectable:k,selectNodesOnDrag:L,defaultViewport:T,translateExtent:D,minZoom:A,maxZoom:$,preventScrolling:O,defaultMarkerColor:P,zoomOnScroll:z,zoomOnPinch:V,panOnScroll:B,panOnScrollSpeed:j,panOnScrollMode:F,zoomOnDoubleClick:H,panOnDrag:Z,onPaneClick:Y,onPaneMouseEnter:X,onPaneMouseMove:U,onPaneMouseLeave:G,onPaneScroll:q,onPaneContextMenu:K,onEdgeContextMenu:Q,onEdgeMouseEnter:W,onEdgeMouseMove:J,onEdgeMouseLeave:ee,onReconnect:te,onReconnectStart:ne,onReconnectEnd:ae,reconnectRadius:oe,noDragClassName:re,noWheelClassName:se,noPanClassName:ie,elevateEdgesOnSelect:le,disableKeyboardA11y:ce,nodeOrigin:de,nodeExtent:ue,rfId:he})=>{const me=$p(e,sp),pe=$p(n,fp);return function(e){const n=Sm(),a=t.useRef(!1);t.useEffect(()=>{!a.current&&n.viewportInitialized&&e&&(setTimeout(()=>e(n),1),a.current=!0)},[e,n.viewportInitialized])}(s),t.createElement(rp,{onPaneClick:Y,onPaneMouseEnter:X,onPaneMouseMove:U,onPaneMouseLeave:G,onPaneContextMenu:K,onPaneScroll:q,deleteKeyCode:_,selectionKeyCode:C,selectionOnDrag:w,selectionMode:S,onSelectionStart:f,onSelectionEnd:y,multiSelectionKeyCode:x,panActivationKeyCode:R,zoomActivationKeyCode:M,elementsSelectable:k,onMove:a,onMoveStart:o,onMoveEnd:r,zoomOnScroll:z,zoomOnPinch:V,zoomOnDoubleClick:H,panOnScroll:B,panOnScrollSpeed:j,panOnScrollMode:F,panOnDrag:Z,defaultViewport:T,translateExtent:D,minZoom:A,maxZoom:$,onSelectionContextMenu:g,preventScrolling:O,noDragClassName:re,noWheelClassName:se,noPanClassName:ie,disableKeyboardA11y:ce},t.createElement(kp,null,t.createElement(_p,{edgeTypes:pe,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:I,onEdgeContextMenu:Q,onEdgeMouseEnter:W,onEdgeMouseMove:J,onEdgeMouseLeave:ee,onReconnect:te,onReconnectStart:ne,onReconnectEnd:ae,reconnectRadius:oe,defaultMarkerColor:P,noPanClassName:ie,elevateEdgesOnSelect:!!le,disableKeyboardA11y:ce,rfId:he},t.createElement(Ap,{style:b,type:v,component:E,containerStyle:N})),t.createElement("div",{className:"react-flow__edgelabel-renderer"}),t.createElement(cp,{nodeTypes:me,onNodeClick:i,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:h,onNodeMouseLeave:m,onNodeContextMenu:p,selectNodesOnDrag:L,onlyRenderVisibleElements:I,noPanClassName:ie,noDragClassName:re,disableKeyboardA11y:ce,nodeOrigin:de,nodeExtent:ue,rfId:he})))};Op.displayName="GraphView";var Pp=t.memo(Op);const zp=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Vp={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:zp,nodeExtent:zp,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Qu.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:(e,t)=>{},isValidConnection:void 0},Bp=()=>{return e=(e,t)=>({...Vp,setNodes:n=>{const{nodeInternals:a,nodeOrigin:o,elevateNodesOnSelect:r}=t();e({nodeInternals:fm(n,a,o,r)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:a={}}=t();e({edges:n.map(e=>({...a,...e}))})},setDefaultNodesAndEdges:(n,a)=>{const o=void 0!==n,r=void 0!==a,s=o?fm(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:r?a:[],hasDefaultNodes:o,hasDefaultEdges:r})},updateNodeDimensions:n=>{const{onNodesChange:a,nodeInternals:o,fitViewOnInit:r,fitViewOnInitDone:s,fitViewOnInitOptions:i,domNode:l,nodeOrigin:c}=t(),d=l?.querySelector(".react-flow__viewport");if(!d)return;const u=window.getComputedStyle(d),{m22:h}=new window.DOMMatrixReadOnly(u.transform),m=n.reduce((e,t)=>{const n=o.get(t.id);if(n?.hidden)o.set(n.id,{...n,[ju]:{...n[ju],handleBounds:void 0}});else if(n){const a=Lu(t.nodeElement);a.width&&a.height&&(n.width!==a.width||n.height!==a.height||t.forceUpdate)&&(o.set(n.id,{...n,[ju]:{...n[ju],handleBounds:{source:Um(".source",t.nodeElement,h,c),target:Um(".target",t.nodeElement,h,c)}},...a}),e.push({id:n.id,type:"dimensions",dimensions:a}))}return e},[]);gm(o,c);const p=s||r&&!s&&ym(t,{initial:!0,...i});e({nodeInternals:new Map(o),fitViewOnInitDone:p}),m?.length>0&&a?.(m)},updateNodePositions:(e,n=!0,a=!1)=>{const{triggerNodeChanges:o}=t();o(e.map(e=>{const t={id:e.id,type:"position",dragging:a};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t}))},triggerNodeChanges:n=>{const{onNodesChange:a,nodeInternals:o,hasDefaultNodes:r,nodeOrigin:s,getNodes:i,elevateNodesOnSelect:l}=t();if(n?.length){if(r){const t=fm(Om(n,i()),o,s,l);e({nodeInternals:t})}a?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:a,edges:o,getNodes:r}=t();let s,i=null;a?s=n.map(e=>Pm(e,!0)):(s=zm(r(),n),i=zm(o,[])),Em({changedNodes:s,changedEdges:i,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:a,edges:o,getNodes:r}=t();let s,i=null;a?s=n.map(e=>Pm(e,!0)):(s=zm(o,n),i=zm(r(),[])),Em({changedNodes:i,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:a}={})=>{const{edges:o,getNodes:r}=t(),s=a||o;Em({changedNodes:(n||r()).map(e=>(e.selected=!1,Pm(e.id,!1))),changedEdges:s.map(e=>Pm(e.id,!1)),get:t,set:e})},setMinZoom:n=>{const{d3Zoom:a,maxZoom:o}=t();a?.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:a,minZoom:o}=t();a?.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:a}=t();Em({changedNodes:a().filter(e=>e.selected).map(e=>Pm(e.id,!1)),changedEdges:n.filter(e=>e.selected).map(e=>Pm(e.id,!1)),get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:a}=t();a.forEach(e=>{e.positionAbsolute=Du(e.position,n)}),e({nodeExtent:n,nodeInternals:new Map(a)})},panBy:e=>{const{transform:n,width:a,height:o,d3Zoom:r,d3Selection:s,translateExtent:i}=t();if(!r||!s||!e.x&&!e.y)return!1;const l=ru.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),c=[[0,0],[a,o]],d=r?.constrain()(l,c,i);return r.transform(s,d),n[0]!==d.x||n[1]!==d.y||n[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Vp.connectionNodeId,connectionHandleId:Vp.connectionHandleId,connectionHandleType:Vp.connectionHandleType,connectionStatus:Vp.connectionStatus,connectionStartHandle:Vp.connectionStartHandle,connectionEndHandle:Vp.connectionEndHandle}),reset:()=>e({...Vp})}),t=Object.is,e?Li(e,t):Li;var e,t},jp=({children:e})=>{const n=t.useRef(null);return n.current||(n.current=Bp()),t.createElement(gu,{value:n.current},e)};jp.displayName="ReactFlowProvider";const Fp=({children:e})=>t.useContext(pu)?t.createElement(t.Fragment,null,e):t.createElement(jp,null,e);Fp.displayName="ReactFlowWrapper";const Hp={input:Zh,default:Fh,output:Xh,group:Uh},Zp={default:fh,straight:hh,step:uh,smoothstep:dh,simplebezier:rh},Yp=[0,0],Xp=[15,15],Up={x:0,y:0,zoom:1},Gp={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},qp=t.forwardRef(({nodes:e,edges:n,defaultNodes:a,defaultEdges:o,className:r,nodeTypes:s=Hp,edgeTypes:i=Zp,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:h,onMoveEnd:m,onConnect:p,onConnectStart:g,onConnectEnd:f,onClickConnectStart:y,onClickConnectEnd:v,onNodeMouseEnter:b,onNodeMouseMove:E,onNodeMouseLeave:N,onNodeContextMenu:C,onNodeDoubleClick:w,onNodeDragStart:S,onNodeDrag:x,onNodeDragStop:R,onNodesDelete:M,onEdgesDelete:_,onSelectionChange:I,onSelectionDragStart:k,onSelectionDrag:L,onSelectionDragStop:T,onSelectionContextMenu:D,onSelectionStart:A,onSelectionEnd:$,connectionMode:O=Qu.Strict,connectionLineType:P=eh.Bezier,connectionLineStyle:z,connectionLineComponent:V,connectionLineContainerStyle:B,deleteKeyCode:j="Backspace",selectionKeyCode:F="Shift",selectionOnDrag:H=!1,selectionMode:Z=Ju.Full,panActivationKeyCode:Y="Space",multiSelectionKeyCode:X=(Xu()?"Meta":"Control"),zoomActivationKeyCode:U=(Xu()?"Meta":"Control"),snapToGrid:G=!1,snapGrid:q=Xp,onlyRenderVisibleElements:K=!1,selectNodesOnDrag:Q=!0,nodesDraggable:W,nodesConnectable:J,nodesFocusable:ee,nodeOrigin:te=Yp,edgesFocusable:ne,edgesUpdatable:ae,elementsSelectable:oe,defaultViewport:re=Up,minZoom:se=.5,maxZoom:ie=2,translateExtent:le=zp,preventScrolling:ce=!0,nodeExtent:de,defaultMarkerColor:ue="#b1b1b7",zoomOnScroll:he=!0,zoomOnPinch:me=!0,panOnScroll:pe=!1,panOnScrollSpeed:ge=.5,panOnScrollMode:fe=Wu.Free,zoomOnDoubleClick:ye=!0,panOnDrag:ve=!0,onPaneClick:be,onPaneMouseEnter:Ee,onPaneMouseMove:Ne,onPaneMouseLeave:Ce,onPaneScroll:we,onPaneContextMenu:Se,children:xe,onEdgeContextMenu:Re,onEdgeDoubleClick:Me,onEdgeMouseEnter:_e,onEdgeMouseMove:Ie,onEdgeMouseLeave:ke,onEdgeUpdate:Le,onEdgeUpdateStart:Te,onEdgeUpdateEnd:De,onReconnect:Ae,onReconnectStart:$e,onReconnectEnd:Oe,reconnectRadius:Pe=10,edgeUpdaterRadius:ze=10,onNodesChange:Ve,onEdgesChange:Be,noDragClassName:je="nodrag",noWheelClassName:Fe="nowheel",noPanClassName:He="nopan",fitView:Ze=!1,fitViewOptions:Ye,connectOnClick:Xe=!0,attributionPosition:Ue,proOptions:Ge,defaultEdgeOptions:qe,elevateNodesOnSelect:Ke=!0,elevateEdgesOnSelect:Qe=!1,disableKeyboardA11y:We=!1,autoPanOnConnect:Je=!0,autoPanOnNodeDrag:et=!0,connectionRadius:tt=20,isValidConnection:nt,onError:at,style:ot,id:rt,nodeDragThreshold:st,...it},lt)=>{const ct=rt||"1";return t.createElement("div",{...it,style:{...ot,...Gp},ref:lt,className:pi(["react-flow",r]),"data-testid":"rf__wrapper",id:rt},t.createElement(Fp,null,t.createElement(Pp,{onInit:d,onMove:u,onMoveStart:h,onMoveEnd:m,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:b,onNodeMouseMove:E,onNodeMouseLeave:N,onNodeContextMenu:C,onNodeDoubleClick:w,nodeTypes:s,edgeTypes:i,connectionLineType:P,connectionLineStyle:z,connectionLineComponent:V,connectionLineContainerStyle:B,selectionKeyCode:F,selectionOnDrag:H,selectionMode:Z,deleteKeyCode:j,multiSelectionKeyCode:X,panActivationKeyCode:Y,zoomActivationKeyCode:U,onlyRenderVisibleElements:K,selectNodesOnDrag:Q,defaultViewport:re,translateExtent:le,minZoom:se,maxZoom:ie,preventScrolling:ce,zoomOnScroll:he,zoomOnPinch:me,zoomOnDoubleClick:ye,panOnScroll:pe,panOnScrollSpeed:ge,panOnScrollMode:fe,panOnDrag:ve,onPaneClick:be,onPaneMouseEnter:Ee,onPaneMouseMove:Ne,onPaneMouseLeave:Ce,onPaneScroll:we,onPaneContextMenu:Se,onSelectionContextMenu:D,onSelectionStart:A,onSelectionEnd:$,onEdgeContextMenu:Re,onEdgeDoubleClick:Me,onEdgeMouseEnter:_e,onEdgeMouseMove:Ie,onEdgeMouseLeave:ke,onReconnect:Ae??Le,onReconnectStart:$e??Te,onReconnectEnd:Oe??De,reconnectRadius:Pe??ze,defaultMarkerColor:ue,noDragClassName:je,noWheelClassName:Fe,noPanClassName:He,elevateEdgesOnSelect:Qe,rfId:ct,disableKeyboardA11y:We,nodeOrigin:te,nodeExtent:de}),t.createElement(am,{nodes:e,edges:n,defaultNodes:a,defaultEdges:o,onConnect:p,onConnectStart:g,onConnectEnd:f,onClickConnectStart:y,onClickConnectEnd:v,nodesDraggable:W,nodesConnectable:J,nodesFocusable:ee,edgesFocusable:ne,edgesUpdatable:ae,elementsSelectable:oe,elevateNodesOnSelect:Ke,minZoom:se,maxZoom:ie,nodeExtent:de,onNodesChange:Ve,onEdgesChange:Be,snapToGrid:G,snapGrid:q,connectionMode:O,translateExtent:le,connectOnClick:Xe,defaultEdgeOptions:qe,fitView:Ze,fitViewOptions:Ye,onNodesDelete:M,onEdgesDelete:_,onNodeDragStart:S,onNodeDrag:x,onNodeDragStop:R,onSelectionDrag:L,onSelectionDragStart:k,onSelectionDragStop:T,noPanClassName:He,nodeOrigin:te,rfId:ct,autoPanOnConnect:Je,autoPanOnNodeDrag:et,onError:at,connectionRadius:tt,isValidConnection:nt,nodeDragThreshold:st}),t.createElement(Jh,{onSelectionChange:I}),xe,t.createElement(Iu,{proOptions:Ge,position:Ue}),t.createElement(dm,{rfId:ct,disableKeyboardA11y:We})))});qp.displayName="ReactFlow";var Kp=t.memo(({id:e,sourceX:t,sourceY:n,targetX:a,targetY:o,markerStart:r,markerEnd:s,style:i})=>{const[l]=ch({sourceX:t,sourceY:n,targetX:a,targetY:o,centerY:o-37});return React.createElement(Uu,{id:e,path:l,style:i,markerStart:r,markerEnd:s})});const Qp={},Wp={...ln,...n};var Jp=t.memo(({locale:e="en-US",lang:n,nodeDefaultSize:a,widgets:o,monacoEditorUrl:r,expressionUtils:s,children:i})=>(t.useMemo(()=>{if(n){const t={};Object.keys(n).forEach(a=>{const o=`${e}_`;a.startsWith(o)&&(t[a.substring(o.length)]=n[a])}),Object.assign(Wp,t),b({lang:t}),na({lang:t})}e&&na({locale:e}),a&&b({nodeDefaultSize:a}),r&&na({monacoEditorUrl:r}),s&&na({expressionUtils:s}),o&&function(e){Object.assign(ra,e)}(o),o&&Tr(o)},[]),t.useEffect(()=>{oa.createValidateProvider(),Object.assign(Qp,ra,Lr)},[]),React.createElement(React.Fragment,null,i,React.createElement(kr,null))));const eg=t.createContext({});const tg=t.createContext({graph:null}),ng=t.createContext({graph:null});function ag(){return React.createElement("svg",{className:"empty-line"},React.createElement("line",{x1:"50%",y1:"0",x2:"50%",y2:"100%",className:"empty-line-path"}))}const og={DagreNode:t.memo(e=>{const a=t.useContext(ng).graph,o=e.id,r=a.get_NodeById(o),i=r.getData(),l=r.getSize(),c=r.getType(),d=r.isFolded(),u=r.isContainer(),h=r.isFork(),m=!r.getChildrenLength(),p=u&&(d||m),g=e.data.size;return React.createElement("div",{style:{width:g.width,height:g.height},className:sn.classNames("ͼbaseflow-DagreFlow__node",{isFolded:d})},React.createElement(Bh,{type:"target",position:nh.Top,id:"in"}),React.createElement(Bh,{type:"source",position:nh.Bottom,id:"out"}),u&&React.createElement(React.Fragment,null,React.createElement(Bh,{type:"target",position:nh.Top,id:"in2",className:"in2"}),React.createElement(Bh,{type:"source",position:nh.Bottom,id:"out2",className:"out2"})),React.createElement("div",{"data-baseflow-role":sn.domRoles.FlowNodeRange,"data-baseflow-node":r.id,className:sn.classNames("ͼbaseflow-DagreFlow__nodeBg",i.tag,{"is-loop":c===s.Loop,"is-group":c===s.Group})},p&&React.createElement(ag,null)),React.createElement("div",{"data-baseflow-role":sn.domRoles.FlowNode,"data-baseflow-node":r.id,className:"ͼbaseflow-Flow__NodeWraper",style:{width:l.width,height:l.height}},React.createElement(si,{node:r,nodeData:i,graph:a})),u&&!m&&React.createElement("div",{className:"ͼbaseflow-DagreFlow__collapse",style:{top:l.height},onClick:()=>r.fold()},React.createElement(vo,{className:d?"isFolded":"",name:xa,title:d?n.fold:n.unfold})),c!==s.End&&c!==s.Return&&c!==s.Break&&React.createElement(vo,{name:Fa,"data-baseflow-role":sn.domRoles.FlowNodePlus,"data-baseflow-action":`${u?"inside":"behind"}::${r.id}`,style:{top:l.height},className:sn.classNames("ͼbaseflow-DagreFlow__nodePlus",{"is-inside":u}),onClick:e=>a.showCreator({sourceNode:r,place:u?"inside":"behind",target:e.target})}),u&&React.createElement(vo,{name:Fa,"data-baseflow-role":sn.domRoles.FlowNodePlus,"data-baseflow-action":`behind::${r.id}`,className:sn.classNames("ͼbaseflow-DagreFlow__nodePlus",{"is-branch":h,"is-default":r.isDefaultBranch()}),style:h?{top:l.height/2,marginLeft:l.width/2+5}:{top:"100%"},onClick:e=>a.showCreator({sourceNode:r,place:"behind",target:e.target})}))})},rg={DagreEdge:Kp},sg={markerEnd:{type:th.ArrowClosed,width:26,height:26}};var ig=t.memo(({graph:e,initialLayoutData:n,initialViewport:a})=>{const[o,r]=t.useState(n.nodes),[s,i]=t.useState(n.edges),[l,c]=t.useState(),d=t.useRef(void 0),u=t.useRef(!1),h=t.useCallback(()=>l?.getViewport()||a,[a,l]),m=t.useCallback(t=>{l?.setViewport(t),e.onResized()},[e,l]),p=Sr(()=>({nodes:o,edges:s})),g=Sr((e,t)=>{e.nodes&&e.nodes!==o&&r(e.nodes),e.edges&&e.edges!==s&&i(e.edges),t&&m(t),u.current=!0}),f=Sr(()=>{const t=d.current?.ids||{};d.current=void 0;let n=o;t._&&(delete t._,n=hi(n,e.getGraphData())),Object.keys(t)&&(n=n.map(e=>t[e.id]?{...e,data:{...e.data}}:e)),g({nodes:n})}),y=Sr((t,n)=>{const a={};n?e.eachChildrenData(t,e=>{a[e.id]=!0}):e.eachChildrenData(t,(e,t)=>{a[e.id]=t.folded||a[t.id]});let r=o.map(e=>a.hasOwnProperty(e.id)&&Boolean(e.hidden)!==Boolean(a[e.id])?{...e,hidden:a[e.id]}:e);r=hi(r,e.getGraphData()),g({nodes:r}),setTimeout(()=>{const e=l.getNode(t);if(e){const{position:t,width:n=0,height:a=0}=e;l.setCenter(t.x+n/2,t.y+a/2,{zoom:1})}})}),v=Sr((e,t)=>{const n=l.getNode(e);if(n){const{position:e,width:a=0,height:o=0}=n;l.setCenter(e.x+a/2+(t?300:0),e.y+o/2,{zoom:1,duration:500})}}),b=Sr(t=>{const n=e.getGraphData(),a=t.map(e=>ci(e)),r=hi(o.concat(a),n),i=mi(s,n.nodes);g({nodes:r,edges:i})}),E=Sr(t=>{const n=e.getGraphData(),a=hi(o.filter(e=>!t[e.id]),n),r=mi(s,n.nodes);g({nodes:a,edges:r})}),N=Sr(()=>{const t=e.getGraphData(),n=hi(o,t),a=mi(s,t.nodes);g({nodes:n,edges:a})}),C=Sr((t,n)=>{const a=e.getGraphData(),r=o.map(e=>e.id===t?{...e,id:n}:e),i=mi(s,a.nodes);g({nodes:r,edges:i})}),w=Sr(t=>{c(t),e.onLayoutRendered({layout:"dagre",layoutData:p(),viewport:h()}),e.onResized()});return t.useMemo(()=>{if(l){const t={getViewport:h,getData:p,setData:g,setViewport:m,setCenter:v,resetNodeId:C,refreshNodeSize:()=>{d.current||(d.current={timer:setTimeout(f),ids:{}}),d.current.ids._=!0},refreshNodeUI:e=>{d.current||(d.current={timer:setTimeout(f),ids:{}}),d.current.ids[e]=!0},zoomTo:t=>{l.zoomTo(t),e.onResized()},zoomFit:()=>(l.fitView({minZoom:.1,maxZoom:1}),e.onResized(),l.getZoom()),foldNode:y,addNodes:b,deleteNodes:E,moveNodes:N};e.setFlowLayout(t)}},[l]),t.useEffect(()=>{u.current&&(u.current=!1,e.onResized())}),React.createElement(qp,{"data-baseflow-role":sn.domRoles.GraphContiner,className:"ͼbaseflow-DagreFlow",fitView:!1,defaultViewport:a,onInit:w,nodeTypes:og,nodes:o,edges:s,defaultEdgeOptions:sg,edgeTypes:rg,nodesDraggable:!1,nodesConnectable:!1,nodesFocusable:!1,edgesFocusable:!1,elementsSelectable:!1,panOnScroll:!0,panOnDrag:!0,minZoom:.2,maxZoom:1,onMove:e.onResized,zoomOnDoubleClick:!1})});function lg(e,t,n){return"meta"!==n&&"props"!==n&&"outputSchema"!==n&&("sources"!==n||1!==e)}var cg=t.memo(({graph:e,initialLayoutData:a})=>{const[o,r]=t.useState(a),s=Sr(()=>o),i=Sr(e=>{const t=ga.graphToJson(e);r(t)}),l=Sr(()=>{ra.clipboard.write(JSON.stringify(o)).then(()=>ra.message.success(n.alreadyToClipboard))});return t.useEffect(()=>{const t={getData:s,setData:r,setViewport:()=>{},setCenter:()=>{},resetNodeId:()=>{},refreshNodeSize:()=>{},refreshNodeUI:()=>{},getViewport:()=>({zoom:1,x:0,y:0}),zoomTo:()=>{},zoomFit:()=>1,foldNode:()=>{},addNodes:()=>{},deleteNodes:()=>{},moveNodes:()=>{}};return e.setFlowLayout(t),e.onLayoutRendered({layout:"dsl",layoutData:o,viewport:{zoom:1,x:0,y:0}}),e.onResized(),e.addListener("dataChanged",i)},[]),React.createElement("div",{className:"ͼbaseflow-DSLFlow","data-baseflow-role":sn.domRoles.GraphContiner},React.createElement(vo,{className:"copy",name:Oa,button:!0,onClick:l}),React.createElement("div",{className:"code"},React.createElement(bs,{data:o,shouldExpandNode:lg})))});var dg=t.memo(({graph:e})=>{const[n,a]=t.useState(e.getLayout());return t.useEffect(()=>e.addListener("layoutChanged",e=>a(e.layout)),[]),React.createElement("div",{className:"ͼbaseflow-Flow__LayoutTools"},React.createElement("div",{className:"item"+("dagre"===n?" on":""),title:"Dagre-Layout"},React.createElement(vo,{name:Wa,onClick:()=>e.setLayout("dagre")})),React.createElement("div",{className:"item"+("code"===n?" on":""),title:"Code-Layout"},React.createElement(vo,{name:Qa,onClick:()=>e.setLayout("code")})),React.createElement("div",{className:"item"+("dsl"===n?" on":""),title:"Code-Layout"},React.createElement(vo,{name:yo,onClick:()=>e.setLayout("dsl")})))});var ug=t.memo(({nodeData:e,node:a,currentTab:o,onTabChange:r})=>{const[i,l]=t.useState(!1),[c,d]=t.useState(!1),u=a.getConfig(),h=a.getStatus(),p=a.getErrors(),g=e.meta.name||`${e.tag}-???`,f=e.id,y=Boolean(e.meta.mockState),v=u.type===s.Trigger,b=t.useCallback(e=>{l(!1),e&&e!==g&&a.updateMeta({name:e})},[g,a]),E=t.useCallback(e=>{if(d(!1),e!==f){const t=a.resetId(e);t&&ra.message.error(t)}},[f,a]),N=t.useCallback(()=>{const e=a.setMockState(!0);e?ra.message.error(e):r("mock")},[a,r]),C=t.useCallback(()=>{a.getGraph().uploadNodeData(a.id)},[a]),w=t.useCallback(()=>{a.getGraph().downloadNodeData(a.id)},[a]);return React.createElement("div",{className:"ͼbaseflow-NodePanel__Header"},React.createElement(Ws,{icon:u.icon,status:h,mocked:y,message:p.configurationErrors||p.referenceErrors}),i?React.createElement(Qs,{className:"node-name input",value:g,onSubmit:b}):React.createElement("div",{className:"node-name",onClick:()=>l(!0)},g),c?React.createElement(Qs,{className:"node-id input",value:f,onSubmit:E}):React.createElement("div",{className:"node-id",onClick:()=>d(!0)},`ID: ${f}`),React.createElement("div",{className:"ͼbaseflow-NodePanel__HeaderTabs"},!y&&React.createElement("div",{className:sn.classNames("tab",{on:"in"===o}),onClick:()=>"in"!==o&&r("in")},React.createElement("span",null,v?n.listen:n.input)),!y&&React.createElement("div",{className:sn.classNames("tab",{on:"out"===o}),onClick:()=>"out"!==o&&r("out")},React.createElement("span",null,v?n.mapping:n.output)),React.createElement("div",{className:sn.classNames("tab",{on:"log"===o}),onClick:()=>"log"!==o&&r("log")},React.createElement("span",null,n.log)),!y&&React.createElement(vo,{className:"link upload",name:Za,onMouseEnter:e=>Lr.tooltip({content:n.downloadConfig,target:e.target}),onClick:w}),!y&&React.createElement(vo,{className:"link upload",name:Ha,onMouseEnter:e=>Lr.tooltip({content:n.uploadConfig,target:e.target}),onClick:C}),m.mockAble(e.type)&&React.createElement(vo,{className:sn.classNames("link",{on:"mock"===o,disabled:y}),name:no,onMouseEnter:e=>Lr.tooltip({content:n.disable,target:e.target}),onClick:()=>y?"mock"!==o&&r("mock"):N()}),React.createElement(vo,{name:uo,className:sn.classNames("link",{on:"info"===o}),onMouseEnter:e=>Lr.tooltip({content:n.help,target:e.target}),onClick:()=>"info"!==o&&r("info")})))});var hg=t.memo(({node:e,nodeData:t,content:n})=>{const a=e.getSource(),o=e.getConfig();return React.createElement("div",{className:"ͼbaseflow-NodePanel__Helper"},React.createElement("div",{className:"version"},React.createElement("div",{className:"lang"},React.createElement("span",null,"Executor："),React.createElement("cite",null,Object.keys(o.executor).join(" / "))),React.createElement("div",{className:"source"},React.createElement("div",null,React.createElement("label",null,"tag:"),t.tag),React.createElement("div",null,React.createElement("label",null,"src:"),a.name),React.createElement("div",null,React.createElement("label",null,"ver:"),React.createElement("em",null,`v${a.actualVersion}`),React.createElement("span",{style:{color:"var(--bf-tx-lesser)"}},`(@${a.formalVersion})`))),React.createElement("div",{className:"desc"},React.createElement(vo,{className:"info-icon",name:mo}),o.desc)),n&&React.createElement(Lr.DescMD,{value:n}))});const mg=(e,t)=>{if(!t)return{name:n.flowInput}};var pg=t.memo(({node:e,nodeData:t})=>{const a=e.getGraph().getInputSchema(),r=t.meta.valueReference?.value,s=Sr(t=>{e.updateMeta({valueReference:{path:"start",value:t}})}),i=Sr(()=>{e.updateErrors(void 0,"configurationErrors"),!a&&r&&e.updateMeta({valueReference:{path:"start",value:void 0}})});return React.createElement(React.Fragment,null,t.meta.configurationErrors===o.inputSchemaChanged&&React.createElement("div",{className:"alert"},React.createElement("div",null,React.createElement(vo,{name:mo}),React.createElement("span",null,n.inputSchemaChanged)),React.createElement(Lr.Button,{size:"small",type:"primary",onClick:i},ln.ButtonOk)),(a||r)&&React.createElement(js,{labelRender:mg,schema:a,value:r,onChange:s}))});const gg=(e,t)=>{if(!t)return{name:"output",label:n.mock}};var fg=t.memo(({nodeData:e,node:t,onTabChange:a})=>{const o=e?.meta.mockState,r=e.meta.outputSchema,i=Sr(()=>{const e=t.setMockState(!0);e&&ra.message.error(e)}),l=Sr(()=>{t.setMockState(void 0),a("in")}),c=Sr(e=>{e?r?t.setMockState(Hn.createSchemaValueByModel(r)):ra.message.error("节点未定义输出"):t.setMockState(!0)});if(o){const a=!0===o?void 0:o;return React.createElement("div",{className:"ͼbaseflow-NodePanel__MockState"},React.createElement("div",{className:"hd"},React.createElement("div",{className:"title on"},React.createElement("span",null,n.currentNodeIsDisabled),React.createElement(Lr.Switch,{value:!1,checkedChildren:n.enableNode,unCheckedChildren:n.enableNode,onChange:l})),e.type!==s.Trigger&&React.createElement("div",{className:"desc"},React.createElement("span",null,n.currentNodeIsDisabledDesc),React.createElement(Lr.Switch,{value:!0!==o,checkedChildren:n.mockOutput,unCheckedChildren:n.mockOutput,onChange:c}))),a&&r&&React.createElement("div",{className:"bd"},React.createElement(js,{labelRender:gg,schema:r,value:a,onChange:t.setMockState})))}return React.createElement("div",{className:"ͼbaseflow-NodePanel__MockState"},React.createElement("div",{className:"hd"},React.createElement("div",{className:"title"},React.createElement("span",null,n.currentNodeIsDisabledDesc),React.createElement(Lr.Switch,{value:!1,checkedChildren:n.disableNode,unCheckedChildren:n.disableNode,onChange:i}))))});var yg=t.memo(({node:e,nodeData:t})=>{const a=e.getGraph(),o=e.getGraph().getLastLogs(),r=Sr(()=>{a.reselect("");const e=document.getElementById("_BaseflowDebug_");e?.click()});if(!o)return React.createElement("div",{className:"ͼbaseflow-NodePanel__NodeLogs"},React.createElement("div",{className:"empty"},React.createElement(vo,{name:mo}),React.createElement("span",{style:{marginLeft:"5px"}},n.noLogsTips),React.createElement(Lr.Button,{size:"small",type:"link",icon:React.createElement(vo,{name:co}),onClick:r},n.load)));const s=o.info,i=o.result,l=o.nodes[t.id];return React.createElement("div",{className:"ͼbaseflow-NodePanel__NodeLogs"},React.createElement("div",{className:"flow-status"},React.createElement("div",null,React.createElement(vo,{name:go,className:"run"}),React.createElement("span",{className:"title"},`${n.runLogs}:`),React.createElement("span",{className:"label"},s.label),React.createElement("span",{className:"time"},`(${s.datetime})`)),React.createElement(Lr.Button,{className:"switch",size:"small",type:"link",icon:React.createElement(vo,{name:Va}),onClick:r},n.switchLogs)),React.createElement("div",{className:sn.classNames("ͼbaseflow-Flow__SettingsLogsForm__result",i.status)},React.createElement("div",null,React.createElement("div",{className:"field"},n.flowStatus),React.createElement("div",{className:"status"},i.status.toUpperCase())),React.createElement("div",null,React.createElement("div",{className:"field"},n.totalTime),React.createElement("div",null,`${i.totalTime}s`)),React.createElement("div",null,React.createElement("div",{className:"field"},n.executionNodes),React.createElement("div",null,`${i.totalNodes}`))),l?React.createElement(React.Fragment,null,React.createElement("div",{className:sn.classNames("node-status",l.status)},React.createElement("div",null,React.createElement(vo,{name:Wa,className:"run"}),React.createElement("span",{className:"title"},`${n.currentNode}:`),React.createElement("span",{className:"label"},l.id)),React.createElement("div",null,React.createElement("span",{className:"status"},l.status.toUpperCase()),l.time?React.createElement("span",{className:"time"},`(${n.executionTime}: ${l.time}s)`):null)),React.createElement("div",{className:"console"},React.createElement(qs,{header:React.createElement("div",null,"Output")},React.createElement("pre",{className:"output"},l.output)),React.createElement(qs,{header:React.createElement("div",null,"Console")},React.createElement("pre",{className:"console"},l.console)))):React.createElement("div",{className:"node-status"},React.createElement("div",null,React.createElement("span",{className:"title"},`${n.currentNode}:`),React.createElement("span",{className:"label"},t.id))))});const vg=(e,t)=>{if(!t)return{name:"Output"}};var bg=t.memo(({node:e,nodeData:t,options:a})=>{const o=t.meta.outputSchema;return o?a?.editable?React.createElement(Ts,{variant:"borderless",labelRender:vg,editableFilter:a.editableFilter,toolsFilter:a.toolsFilter,value:o,onChange:e.updateOutputSchema}):React.createElement(Os,{labelRender:vg,schema:o}):React.createElement("div",{className:"ͼbaseflow-sr-empty"},React.createElement(vo,{name:_a}),React.createElement("span",null,n.noDataPrompt))});var Eg=t.memo(({node:e,graph:n})=>{const[a,o]=t.useState(()=>{const e=n.getTGraph();return{graphReader:e[0],graphActions:e[1],graph:n.getIGraph()}}),[r,i]=t.useState(),l=t.useRef(0),[c,d]=t.useState(0),[u,h]=t.useState("in"),m=r?.type===s.Trigger,{NodeInputPanel:p,NodeOutputPanel:g,NodeHelperPanel:f}=t.useMemo(()=>{if(e){const t=e.getData();return i(t),h(t.meta.mockState?"mock":"in"),e.getConfig()}return i(void 0),h("in"),{NodeInputPanel:void 0,NodeOutputPanel:void 0,NodeHelperPanel:void 0}},[e]),y=Sr(t=>{if(e&&t.changed[e.id]){const n=t.changed[e.id];t.inHistory&&l.current++,i(n)}}),v=Sr(()=>{const e=n.getTGraph();o({graphReader:e[0],graphActions:e[1],graph:n.getIGraph()})}),b=Sr(t=>{e&&e.id===t&&(l.current++,d(c+1))});return t.useEffect(()=>{const e=[n.addListener("dataChanged",v),n.addListener("nodeDataChanged",y),n.addListener("refreshNodePanel",b)];return()=>{e.forEach(e=>{e()})}},[]),React.createElement("div",{className:sn.classNames("ͼbaseflow-NodePanel",{on:e})},e&&r&&React.createElement(React.Fragment,null,React.createElement(ug,{nodeData:r,node:e,currentTab:u,onTabChange:h}),React.createElement("div",{className:"ͼbaseflow-NodePanel__Body"},"in"===u&&p&&React.createElement(eg,{value:a},React.createElement(p,{key:e.id,nodeData:r,rebuildKey:l.current})),"out"===u&&(m?React.createElement(pg,{key:e.id,nodeData:r,node:e}):React.createElement(bg,{key:e.id,nodeData:r,node:e,options:g})),"mock"===u&&React.createElement(fg,{key:e.id,nodeData:r,node:e,onTabChange:h}),"log"===u&&React.createElement(yg,{key:e.id,nodeData:r,node:e}),"info"===u&&React.createElement(hg,{key:e.id,nodeData:r,node:e,content:f}))))});var Ng=t.memo(({graph:e,onSubmit:a})=>{const[o,r]=t.useState(),[s,i]=t.useState(!1),l=o?.list,c=t.useCallback(t=>{i(!0),e.fetchLogsItem(t).then(e=>{Lr.popup(null),a(e)}).finally(()=>i(!1))},[e,a]),d=t.useCallback(()=>{ra.clipboard.write(o?.commitId||"").then(()=>ra.message.success(n.alreadyToClipboard))},[o?.commitId]);return t.useEffect(()=>{e.fetchLogsList().then(e=>r(e))},[]),React.createElement("div",{className:"ͼbaseflow-Flow__DebugForm"},React.createElement("div",{className:"info"},React.createElement("div",null,React.createElement("div",{className:"title"},n.runLogs),o?React.createElement("div",{className:"commit"},React.createElement("span",{onClick:d,onMouseEnter:e=>Lr.tooltip({content:n.copyCommitId,target:e.target})},`CommitID: ${o.commitId.substring(0,20)}...`),React.createElement(vo,{className:"help",name:uo,onMouseEnter:e=>Lr.tooltip({content:n.commitIdPrompt,target:e.target})})):React.createElement("div",{className:"commit"},React.createElement("span",null,"loading..."))),React.createElement("div",null,React.createElement(vo,{button:!0,name:Ia,onMouseEnter:e=>Lr.tooltip({content:ln.import,target:e.target})}),React.createElement(vo,{button:!0,name:Oa,onMouseEnter:e=>Lr.tooltip({content:ln.paste,target:e.target})}))),s&&React.createElement("div",{className:"loading"},React.createElement(Lr.Spin,{size:"small"})),l?l.length?React.createElement("ul",{className:"list"},l.map(e=>React.createElement("li",{key:e.id,onClick:()=>c(e.id)},React.createElement("div",{className:"time"},`▷ ${e.time}`),React.createElement("div",{className:"label"},e.label),React.createElement("div",{className:`status ${e.status}`})))):React.createElement("div",{className:"empty"},n.noLogsPrompt):React.createElement("div",{className:"loading"},React.createElement(Lr.Spin,{size:"small"})))});var Cg=t.memo(({className:e,graph:t,device:n,status:a})=>{const o=t.getNodeDataById(n.id),r=o.meta.name||`${o.tag}-???`,s=t.getNodeConfigById(n.id);return React.createElement("div",{className:sn.classNames("ͼbaseflow-OutputSelector-DeviceItem ͼbaseflow-Flow__SettingsLogs",e,{selected:n.highlighted}),"data-node-id":n.id},React.createElement("div",{className:"ͼbaseflow-OutputSelector-DeviceItem__node"},React.createElement("div",{className:"device-icon"},React.createElement("img",{src:s.icon})),React.createElement("div",{className:"device-name"},React.createElement("em",null,o.id),React.createElement("span",null,r)),React.createElement("div",{className:sn.classNames("device-status",a)})))});const wg=(e,t)=>{if(!t)return{name:n.output}},Sg=t.forwardRef(({graph:e,data:a,onClose:o},r)=>{const[s,i]=t.useState(Boolean(a.running)),l=t.useRef(void 0),[c]=t.useState(()=>e.getNodeDataMaps()),[d,u]=t.useState(()=>ia(e.getGraphData().nodes).nodes),[h,m]=t.useState(""),p=a.logs,g=a.running,f=p.nodes[h],y=Object.values(p.nodes).filter(e=>"running"===e.status),v=Sr(e=>{const t=e.target.getAttribute("data-node-id")||"";if(h!==t){m(t);const e=nn.produce(d,e=>{e.id===t?e.highlighted=!0:e.highlighted&&(e.highlighted=void 0)});u(e)}}),b=Sr(()=>{g?.abort().then(()=>{p.result={...p.result,status:"error"};const e={};Object.values(p.nodes).forEach(t=>{"running"===t.status&&(t.status="error",e[t.id]=t.status)});const t=nn.produce(d,t=>{e[t.id]&&(t.key=t.key?t.key+1:1)});u(t),i(!1)})}),E=Sr(()=>{g?.retry().then(()=>{i(!0)})}),N=Sr(()=>{s?(sn.addClass(l.current,"anmi"),setTimeout(()=>sn.removeClass(l.current,"anmi"),200)):o()}),C=Sr(e=>{const t=e.nodes;p.result=e.result;const a=p.nodes,o={};Object.keys(t).forEach(e=>{const n=t[e],r=a[e];r?(r.status!==n.status&&(o[e]=n.status),a[e]={...r,...n,console:(r.console||"")+(n.console||"")}):(a[e]=n,o[e]=n.status)});const r=nn.produce(d,e=>{o[e.id]&&(e.key=e.key?e.key+1:1)});u(r),"running"!==p.result.status&&("error"===p.result.status?ra.message.error(n.executionCompleted):ra.message.success(n.executionCompleted),i(!1))}),w=Sr(e=>{const t=nn.produce(d,t=>{if(t.id===e)return t.folded=!t.folded,!0});u(t)}),S=Sr(({node:t})=>React.createElement(Cg,{graph:e,device:t,status:p.nodes[t.id]?.status}));t.useEffect(()=>{s||e.setLastLogs(p)},[p,e,s]),t.useImperativeHandle(r,()=>({close:N,onMessage:C}),[N,C]);const x=t.useMemo(()=>{const e=p.result,t=y[0]?.id;return React.createElement("div",{className:sn.classNames("ͼbaseflow-Flow__SettingsLogsForm__result",e.status)},React.createElement("div",null,React.createElement("div",{className:sn.classNames("field",{running:s})},n.flowStatus),t?React.createElement("div",{className:"current"},t.toUpperCase()):React.createElement("div",{className:"status"},e.status.toUpperCase())),React.createElement("div",null,React.createElement("div",{className:"field"},n.totalTime),React.createElement("div",null,`${e.totalTime}s`)),React.createElement("div",null,React.createElement("div",{className:"field"},n.executionNodes),React.createElement("div",null,`${e.totalNodes}`)))},[p.result,s]),R=t.useMemo(()=>{if(!f)return null;const t=c[f.id],a=t.meta.name||`${t.tag}-???`,o=e.getNodeConfigById(f.id),r=t.meta.outputSchema;return React.createElement(React.Fragment,null,React.createElement("div",{className:"ͼbaseflow-OutputSelector-DeviceItem"},React.createElement("div",{className:sn.classNames("ͼbaseflow-OutputSelector-DeviceItem__node")},React.createElement("div",{className:"device-icon"},React.createElement("img",{src:o.icon})),React.createElement("div",{className:"device-name"},React.createElement("em",null,t.id),React.createElement("span",null,a)))),React.createElement("div",{className:sn.classNames("status",f.status)},React.createElement("span",{className:"text"},f.status.toUpperCase()),f.time?React.createElement("span",null,`${n.executionTime}: ${f.time}s`):null),React.createElement("div",{className:"console"},r&&React.createElement(qs,{header:React.createElement("div",null,"Schema")},React.createElement("div",{className:"schema"},React.createElement(Os,{labelRender:wg,schema:r}))),React.createElement(qs,{header:React.createElement("div",null,"Output")},React.createElement("pre",{className:"output"},'\n{\n    "layout": "dagre",\n    "sources": {\n        "@baseflow-nodes/flow": "@baseflow-nodes/flow@1.0.0",\n        "@baseflow-nodes/start": "@baseflow-nodes/start@1.0.0",\n        "@baseflow-nodes/choice": "@baseflow-nodes/choice@1.0.0",\n        "@baseflow-nodes/branch": "@baseflow-nodes/branch@1.0.0",\n        "@baseflow-nodes/http": "@baseflow-nodes/http@1.0.0",\n        "@baseflow-nodes/variable": "@baseflow-nodes/variable@1.0.0",\n        "@baseflow-nodes/end": "@baseflow-nodes/end@1.0.0"\n    },\n    "triggers": [],\n}\n              ')),React.createElement(qs,{header:React.createElement("div",null,"Console")},React.createElement("pre",{className:"console"},React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手啊粉萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手啊萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大手啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大萨芬是大方啊说分手啊粉丝大啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手啊粉丝大发是大法师大 sa fafasd"),React.createElement("p",null,"sdfsdafasd"),React.createElement("p",null,"撒大法师大方似懂非懂萨芬是大方啊说分手啊粉丝大发是大法师大 sa fafasd")))))},[f]);return React.createElement(React.Fragment,null,React.createElement("div",{className:"ͼbaseflow-Flow__SettingsLogsForm",onClick:v},React.createElement("div",{className:"hd"},React.createElement("div",null,React.createElement("div",null,React.createElement("span",{className:"title"},`${n.runLogs}:`),React.createElement("span",{className:"name"},p.info?.label)),React.createElement("div",{className:"time"},p.info?.datetime)),s?React.createElement(Lr.Button,{ref:l,className:"pause-btn",size:"small",color:"primary",variant:"text",icon:React.createElement(vo,{name:no}),onClick:b},n.stop):React.createElement("div",null,React.createElement(Lr.Button,{size:"small",type:"text",className:"cancel",icon:React.createElement(vo,{name:za}),onClick:o},n.cancel),g&&React.createElement(Lr.Button,{ref:l,size:"small",color:"primary",variant:"text",icon:React.createElement(vo,{name:Ja}),onClick:E},n.retry))),React.createElement("div",{className:"bd"},x,React.createElement(Ks,{namespace:"OutputSelector",source:d,nodeRender:S,onSwitch:w}))),React.createElement("div",{className:sn.classNames("ͼbaseflow-Flow__SettingsLogsDetail",{on:f})},R))});var xg=t.memo(Sg);const Rg=(e,t)=>{if(!t)return{name:n.flowInput}},Mg=[{label:"development",value:"development"},{label:"test",value:"test"},{label:"production",value:"production"}];var _g=t.memo(({graph:e})=>{const[a,o]=t.useState(e.getStatus()),r=t.useRef(null),[s,i]=t.useState(),[l,c]=t.useState(),[d,u]=t.useState("development"),[h,m]=t.useState(),p=t.useRef(null),g=Sr(e=>{p.current.onMessage(e)}),f=Sr(()=>{if("error"===a)return ra.message.error(n.graphErrorsPrompt),void e.setCenterNode();const t=e.getInputSchema();if(t){const e=Hn.createSchemaValueByModel(t,l);c(e),i(t)}else c(void 0),i("none")}),y=Sr(()=>{i(void 0)}),v=Sr(()=>{m(void 0)}),b=Sr(()=>{const t=Hn.checkForm(r.current);t?ra.message.error(t):e.testRun(g,d,l).then(e=>{i(void 0),m(e)})}),E=Sr(t=>{Lr.popup({content:React.createElement(Ng,{graph:e,onSubmit:e=>m({logs:e})}),target:t.target,offset:{left:"-8px",top:"5px"}})});t.useEffect(()=>e.addListener("statusChanged",o),[e]);const N=Boolean(s||h);return React.createElement(React.Fragment,null,React.createElement("div",{className:"ͼbaseflow-Flow__RunTools"},React.createElement("div",{className:"group"},"error"===a?React.createElement(vo,{className:sn.classNames("item info",{err:"error"===a}),name:mo,onClick:()=>e.setCenterNode(),onMouseEnter:e=>Lr.tooltip({content:n.graphErrorsPrompt,target:e.target})}):React.createElement(vo,{className:"item info",name:mo,onClick:()=>ra.message.success(n.noErrors)}),React.createElement("span",{className:"split"}),React.createElement("div",{className:sn.classNames("item primary",{err:"error"===a}),onClick:f},React.createElement(vo,{name:Ja}),React.createElement("span",{className:"label"},n.testRun)),React.createElement("span",{className:"split"}),React.createElement(vo,{className:"item debug",name:co,id:"_BaseflowDebug_",onClick:E})),React.createElement("div",{className:"group"},React.createElement("div",{className:"item"},React.createElement(vo,{name:Ma}),React.createElement("span",{className:"label"},n.publish)))),React.createElement("div",{className:sn.classNames("ͼbaseflow-Flow__Settings",{on:N})},s&&React.createElement("div",{className:"ͼbaseflow-Flow__SettingsInputForm"},React.createElement("div",{className:"hd"},React.createElement("div",{className:"title"},`${n.testRun}...`),React.createElement("div",{className:"actions"},React.createElement(Lr.Button,{size:"small",type:"text",className:"cancel",icon:React.createElement(vo,{name:za}),onClick:y},n.cancel),React.createElement(Lr.Button,{size:"small",color:"primary",variant:"text",icon:React.createElement(vo,{name:Pa}),onClick:b},n.submit))),React.createElement("div",{className:"cd"},React.createElement(vo,{name:uo,onMouseEnter:e=>Lr.tooltip({content:n.envModeTips,target:e.target})}),React.createElement("span",null,`${n.envMode}:`),React.createElement(Lr.Select,{className:"env-select",size:"small",value:d,options:Mg,onChange:u})),React.createElement("div",{className:"bd",ref:r},"none"!==s&&React.createElement(js,{labelRender:Rg,schema:s,value:l,onChange:c}))),h&&React.createElement(xg,{graph:e,data:h,onClose:v,ref:p})),N&&React.createElement("div",{className:"ͼbaseflow-Flow__SettingsMask",onClick:()=>{s?y():p.current&&p.current.close()}}))});function Ig(e,t){const n=t.offset,a={left:[],right:[],top:[],bottom:[]};e.forEach(e=>{const o=t.nodes[e].getBoundingClientRect();Object.assign(t.boxs[e].style,{left:o.left-n.left+"px",top:o.top-n.top+"px",width:`${o.width}px`,height:`${o.height}px`});const r=t.bgs[e].getBoundingClientRect();a.left.push(r.left),a.top.push(r.top),a.right.push(r.left+r.width),a.bottom.push(r.top+r.height)});const o=Math.min(...a.left),r=Math.min(...a.top),s=Math.max(...a.right)-o,i=Math.max(...a.bottom)-r;Object.assign(t.boxs.$.style,{left:o-n.left+"px",top:r-n.top+"px",width:`${s}px`,height:`${i}px`}),Object.assign(t.boxs._.style,{left:o-n.left+"px",top:r-n.top-16+"px"})}var kg=t.memo(({selected:e,graph:a,children:o})=>{const r=t.useRef(null),i=t.useRef(null),l=t.useRef(null),c=t.useRef(void 0),d=t.useRef(void 0),u=Sr(e=>{e.metaKey&&a.select(e.target.dataset.id)}),h=Sr(()=>{if(c.current){const e=a.getContainer(),t=c.current;e.querySelectorAll(`div[data-baseflow-role=${sn.domRoles.FlowNode}]`).forEach(e=>{const n=e.getAttribute("data-baseflow-node")||"";t.boxs[n]&&(t.nodes[n]=e)}),e.querySelectorAll(`div[data-baseflow-role=${sn.domRoles.FlowNodeRange}]`).forEach(e=>{const n=e.getAttribute("data-baseflow-node")||"";t.boxs[n]&&(t.bgs[n]=e)})}}),m=Sr(()=>{c.current&&Ig(e,c.current)}),p=Sr(()=>{const e=a.getSelected()[0];e&&e.showMenu()}),g=Sr(()=>{const e=a.getSelected();if(e.length)try{a.deleteNodes(e.map(e=>e.id))}catch(e){ra.message.error(e.message||e)}}),f=Sr(()=>{const e=a.getSelected();e.length&&a.toClipboard("copy",e.map(e=>e.id))}),y=Sr(()=>{const e=a.getSelected();e.length&&a.toClipboard("cut",e.map(e=>e.id))}),v=Sr(e=>{if(e.dataset.baseflowRole===sn.domRoles.FlowNodePlus){const[t,n]=(e.dataset.baseflowAction||"").split("::"),o=a.getSelectedIds();if(t&&n&&o.length)try{a.moveNodes(n,t,o)}catch(e){ra.message.error(e.message||e)}}}),b=t.useCallback(e=>{const t=e.target;t.dataset.id&&"true"!==t.dataset.trigger&&(d.current?d.current(e):d.current=function(e,t,n,a,o,r){const s={left:t.style.left,top:t.style.width},i=t.getBoundingClientRect(),l=a.clientX-i.left,c=a.clientY-i.top;let d=!1;const u=a=>{d||(d=!0,e.style.pointerEvents="none",n.style.visibility="hidden");const o=a.clientX-l,r=a.clientY-c;t.style.left=o-i.x+"px",t.style.top=r-i.y+"px"},h=e=>{e.preventDefault()},m=a=>{d=!1,e.style.pointerEvents="auto",n.style.visibility="visible",o.current=void 0,t.style.left=s.left,t.style.top=s.top,window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",m),window.removeEventListener("selectstart",h),r(a.target)};return window.addEventListener("mousemove",u),window.addEventListener("mouseup",m),window.addEventListener("selectstart",h),m}(t,i.current,l.current,e,d,v))},[v]),{activated:E,isTrigger:N}=t.useMemo(()=>"dsl"===a.getLayout()?{activated:!1,isTrigger:!1}:e[0]?{activated:!0,isTrigger:a.getNodeDataById(e[0]).type===s.Trigger}:{activated:!1,isTrigger:!1},[a,e]),C=1===e.length;return t.useEffect(()=>{if(E){const t=a.getContainer(),n={boxs:{$:r.current,_:l.current},nodes:{},bgs:{},offset:i.current.getBoundingClientRect()};i.current.querySelectorAll("div[data-id]").forEach(e=>{const t=e.getAttribute("data-id")||"";n.boxs[t]=e}),t.querySelectorAll(`div[data-baseflow-role=${sn.domRoles.FlowNode}]`).forEach(e=>{const t=e.getAttribute("data-baseflow-node")||"";n.boxs[t]&&(n.nodes[t]=e)}),t.querySelectorAll(`div[data-baseflow-role=${sn.domRoles.FlowNodeRange}]`).forEach(e=>{const t=e.getAttribute("data-baseflow-node")||"";n.boxs[t]&&(n.bgs[t]=e)}),c.current=n,Ig(e,n)}else c.current=void 0},[e]),t.useEffect(()=>a?.addListener("layoutRendered",h),[a,h]),t.useEffect(()=>a?.addListener("viewportResized",m),[a,m]),React.createElement(React.Fragment,null,React.createElement("div",{className:"ͼbaseflow-FlowSelection range"},E&&React.createElement("div",{className:"box",ref:r})),o,React.createElement("div",{className:"ͼbaseflow-FlowSelection ghost"+(N?" triggers":""),ref:i,onMouseDown:b},E&&React.createElement("div",{className:`ͼbaseflow-FlowSelection__tools ${a.getLayout()}`,ref:l},React.createElement(vo,{name:Da,title:n.delete,onClick:g}),React.createElement(vo,{name:Oa,title:n.copy,onClick:f}),React.createElement(vo,{name:$a,title:n.cut,onClick:y}),C&&React.createElement(vo,{name:po,title:n.more,onClick:p})),e.map(e=>React.createElement("div",{className:"box",key:e,"data-id":e,"data-trigger":N,onClick:u}))))});var Lg=t.memo(({graph:e,initialList:a,selected:o,onShowCreater:r})=>{const[s,i]=t.useState(a);t.useMemo(()=>{i(a)},[a]);const l=t.useCallback(t=>{ra.confirm(n.deleteConfirm,n=>{if(n)try{e.deleteTrigger(t)}catch(e){ra.message.error(e.message)}})},[e]),c=Sr(e=>{i(s.map(t=>t.id===e.id?e:t))});return t.useEffect(()=>{const t={refreshNodeUI:c,setNodes:i};e.setTriggerLayout(t)},[]),React.createElement("div",{className:"ͼbaseflow-FlowTriggers","data-baseflow-role":sn.domRoles.GraphContiner},React.createElement(vo,{name:uo,style:{fontSize:"12px",marginRight:"-1px"},onMouseEnter:e=>Lr.tooltip({content:n.triggersTips,target:e.target})}),React.createElement("div",{className:"subject"},n.triggers),s.map(t=>{const a=e.getNodeConfigByTag(t.tag),r=Boolean(t.meta.referenceErrors||t.meta.configurationErrors),s=Boolean(t.meta.mockState);return React.createElement("div",{className:sn.classNames("item",{on:o===t.id}),key:t.id},React.createElement("div",{className:"tools"},React.createElement(vo,{className:"action",name:Da,title:n.delete,onClick:()=>l(t.id)}),React.createElement(vo,{className:"action",name:Oa,title:n.copy,onClick:()=>e.toClipboard("copy",[t.id])})),React.createElement("div",{className:"node-item","data-baseflow-role":sn.domRoles.FlowNode,"data-baseflow-node":t.id},React.createElement(Ws,{icon:a.icon,status:r?"error":"normal",message:t.meta.configurationErrors||t.meta.referenceErrors,mocked:s})),React.createElement("div",{className:"node-bg","data-baseflow-role":sn.domRoles.FlowNodeRange,"data-baseflow-node":t.id}))}),React.createElement("div",{className:"add",onClick:t=>r({sourceNode:e.getNodeById("flow"),place:"inside",target:t.currentTarget})},React.createElement(vo,{name:Ga})))});var Tg=t.memo(({options:e,value:t,onChange:n})=>React.createElement("div",{className:"ͼbaseflow-LinkNav"},e.map(e=>React.createElement("div",{key:e.value,className:sn.classNames("item",{on:t===e.value}),onClick:()=>{t!==e.value&&n?.(e.value)}},e.label))));var Dg=t.memo(({className:e,graph:a,onSwitchOutput:o,onSelectedVariable:r,onSwitchAllSchema:s,onSwitchSchema:i,device:l})=>{const c=l.outputSchema,d=a.getNodeDataById(l.id),u=d.meta.name||`${d.tag}-???`,h=a.getNodeConfigById(l.id),m=Boolean(d.meta.mockState),[p,g]=t.useState(!1),[f,y]=t.useState(()=>!!c&&!c.folded),v=t.useMemo(()=>c?.children,[c]);t.useMemo(()=>y(!!c&&!c.folded),[c]);const b=Sr(e=>{i(l.id,e)}),E=Sr(()=>{s(l.id,!p),g(!p)}),N=Sr(()=>{c?o(l.id):y(!f)});return React.createElement("div",{className:sn.classNames("ͼbaseflow-OutputSelector-DeviceItem",e)},React.createElement("div",{className:sn.classNames("ͼbaseflow-OutputSelector-DeviceItem__node"),"data-node-id":c?c.id:void 0,onClick:N},React.createElement("div",{className:sn.classNames("device-icon",{mocked:m})},React.createElement("img",{alt:"node-icon",src:h.icon})),React.createElement("div",{className:"device-name"},u),c&&React.createElement(vo,{className:"device-output",name:wa}),c&&React.createElement(vo,{className:"device-data",name:c.type})),f&&React.createElement("div",{className:"ͼbaseflow-OutputSelector-DeviceItem__output"},v&&React.createElement(vo,{name:lo,className:sn.classNames("expand-all",{on:p}),onClick:E}),c?React.createElement(As,{schema:c,onSwitch:b,onSelected:r}):React.createElement("div",{className:"no-output"},n.noOutputs)))});var Ag=t.memo(({graph:e,currentDeviceId:t,source:n,onSelectedVariable:a,onSourceChange:o})=>{const r=Sr(e=>{const t=nn.produce(n,t=>{if(t.id===e)return t.folded=!t.folded,!0});o?.(t)}),s=Sr(e=>{const t=nn.produce(n,t=>{if(t.id===e)return t.outputSchema.folded=!t.outputSchema.folded,!0});o?.(t)}),i=Sr((e,t)=>{const a=nn.produce(n,n=>{if(n.id===e)return nn.each(n.outputSchema,e=>{e.id===t&&(e.folded=!e.folded)}),!0});o?.(a)}),l=Sr((e,t)=>{const a=nn.produce(n,n=>{if(n.id===e)return nn.each(n.outputSchema,(e,{parent:n})=>{n&&(e.folded=!t)}),!0});o?.(a)}),c=Sr(({node:n})=>React.createElement(Dg,{className:sn.classNames({on:n.id===t,disabled:n.disabled}),graph:e,device:n,onSwitchSchema:i,onSwitchOutput:s,onSelectedVariable:a,onSwitchAllSchema:l}));return React.createElement(Ks,{namespace:"OutputSelector",source:n,nodeRender:c,onSwitch:r})});const $g=e=>({name:e.label,label:""});var Og=t.memo(({schema:e,isUtils:t,onSourceChange:n,onSelectedVariable:a})=>{const o=Sr(t=>{const a=nn.produce(e,e=>{if(e.id===t)return e.folded=!e.folded,!0});n?.(a)});return React.createElement(As,{className:"ͼbaseflow-VarSelector-Schema",labelRender:t?$g:void 0,schema:e,onSelected:a,onSwitch:o})});const Pg=[{label:n.allNodes,value:"all"},{label:n.variableNodes,value:s.Variable}];function zg(e){setTimeout(()=>{const t=e?.querySelector(".item-title.highlight");t&&t.scrollIntoView({behavior:"smooth"})},50)}const Vg={runtimeOutputs:{id:"flow",data:s.Flow,children:[]},runtimeVariableMaps:{}},Bg=t.forwardRef((e,a)=>{const{graph:o,superInput:r,currentNodeId:s}=e,i=t.useRef(!1),[l,c]=t.useState(),[d,u]=t.useState(""),[h,m]=t.useState(),[p,g]=t.useState($n.getConstants()),[f,y]=t.useState($n.getUtils()),[v,b]=t.useState("output"),[E,N]=t.useState(""),C=t.useRef(null),w=t.useRef(null),S=t.useRef(null),x=o.validateServer.editorDom,R=o.validateServer.tsServer,M=r?.getMode();t.useMemo(()=>{r&&!s&&b("constant")},[!s,r]);const _=Sr((e,t)=>{"simple"===M?r?.insertVariable(e,t):R.iv("utils"===v?`${e}()`:e)}),I=Sr((e,t)=>{const{output:n,context:a}=t||{output:l,context:h},o=$n.getVariableMode(e);if("output"===o&&n){const t=an.highlightOutputs(e,n,!0);b("output"),c(t)}else if("context"===o&&a){const t=En.highlightOutputs(e,a,!0);b("context"),m(t)}else if("constant"===o){const t=En.highlightOutputs(e,p,!0);b("constant"),g(t)}else if("utils"===o){const t=En.highlightOutputs(e,f,!0);b("utils"),g(t)}}),k=Sr(()=>{R.fm().then(()=>{const e=R.gc().trim();r?.setText(e),o.setCurrentSuperInput(void 0)})}),L=Sr(e=>{const t=function(e){const t=e.split($);return A.stringify(t,'"')}(e);I(t),zg(w.current)}),T=t.useMemo(()=>{if(r&&!E){const e="variable"===r.getBrand()?"Variable":"all";return N(e),e}return E},[r,E]);t.useMemo(()=>{if(r){const e=r.getVariableFilter(),{runtimeOutputs:t,runtimeVariableMaps:n}=o.getCurrentNode()||Vg;let a,s=l||t;s&&(s=e?an.produceDeviceAndOutput(s,(t,{isDevice:n})=>{let a;if(n){a=("all"===T?void 0:t.data!==T)||void 0}else{a=e(t)||void 0}t.disabled!==a&&(t.disabled=a)}):an.produceDeviceAndOutput(s,(e,{isDevice:t})=>{let n;if(t){n=("all"===T?void 0:e.data!==T)||void 0}else n=void 0;e.disabled!==n&&(e.disabled=n)})),c(s);const d=r.getContext();u(d),d?(a=n[d],a=$n.getContext(d,a),a&&e&&(a=nn.produce(a,t=>{const n=e(t)||void 0;t.disabled=n})),m(a)):m(void 0);const h=r.getHighlight();h&&(I(h,{output:s,context:a}),i.current&&zg(w.current))}},[r,M,T]);const D=t.useMemo(()=>r?React.createElement(React.Fragment,null,React.createElement("div",{className:"ͼbaseflow-VarSelector__header"},React.createElement("div",{className:sn.classNames("tab",{on:"output"===v,disabled:!s}),onClick:e=>!e.target.className.includes("disabled")&&b("output")},n.outputsTab),React.createElement("div",{className:sn.classNames("tab",{on:"context"===v}),onClick:e=>!e.target.className.includes("disabled")&&b("context")},n.contextTab),React.createElement("div",{className:sn.classNames("tab",{on:"constant"===v}),onClick:e=>!e.target.className.includes("disabled")&&b("constant")},ln.systemVariables),React.createElement("div",{className:sn.classNames("tab",{on:"utils"===v,disabled:"complex"!==M}),onClick:e=>!e.target.className.includes("disabled")&&b("utils")},n.utilsTab)),React.createElement("div",{className:"ͼbaseflow-VarSelector__body",ref:w},React.createElement("div",{className:sn.classNames("tab-panel outputs",{on:"output"===v})},React.createElement("div",{className:"filter"},React.createElement(Tg,{value:T,options:Pg,onChange:N})),l?React.createElement(Ag,{graph:o,source:l,currentDeviceId:s,onSourceChange:c,onSelectedVariable:_}):React.createElement("div",{className:"ͼbaseflow-sr-empty"},React.createElement(vo,{name:_a}),React.createElement("span",null,n.noDataPrompt))),React.createElement("div",{className:sn.classNames("tab-panel",{on:"context"===v})},h?React.createElement(Og,{schema:h,onSourceChange:m,onSelectedVariable:_}):React.createElement("div",{className:"ͼbaseflow-sr-empty"},React.createElement(vo,{name:_a}),React.createElement("span",null,n.noDataPrompt))),React.createElement("div",{className:sn.classNames("tab-panel",{on:"constant"===v})},React.createElement(Og,{schema:p,onSourceChange:g,onSelectedVariable:_})),React.createElement("div",{className:sn.classNames("tab-panel",{on:"utils"===v})},React.createElement(Og,{isUtils:!0,schema:f,onSourceChange:y,onSelectedVariable:_})))):null,[l,h,p,f,v,M,T]),O=!r;return t.useMemo(()=>{r&&"complex"===M?R.sc(r.getValue()?.text||"",ea.contextToInspector(d),r.getRuntime()):R.sc("")},[r,M,R,d]),t.useMemo(()=>{O&&(i.current=!1,b("output"),N(""),u(""),m(void 0),c(void 0),g($n.getConstants()),y($n.getUtils()))},[O]),t.useEffect(()=>{const e=[];return r&&(e.push(r.addListener("valueChanged",()=>{})),e.push(r.addListener("variableClick",({variable:e})=>{I(e),zg(w.current)})),e.push(r.addListener("expressionClick",()=>{}))),()=>{e.forEach(e=>{e()})}},[r]),t.useEffect(()=>{"complex"!==M&&"visible"===x.style.visibility&&(x.style="")},[M,x,r]),t.useEffect(()=>{const e=C.current,t=t=>{if(t.target===e&&"transform"===t.propertyName){if(i.current="ͼbaseflow-VarSelector"!==e.className,"complex"===e.dataset.mode){const e=S.current.getBoundingClientRect();x.style=`top: ${e.top}px; left: ${e.left}px;visibility: visible;`}i.current&&zg(w.current)}},n=t=>{if("complex"===e.dataset.mode){const e=S.current.getBoundingClientRect();x.style=`top: ${e.top}px; left: ${e.left}px;visibility: visible;`}};return R.ol(L),e.addEventListener("transitionend",t),window.addEventListener("resize",n),()=>{e.removeEventListener("transitionend",t),window.removeEventListener("resize",n)}},[]),React.createElement(React.Fragment,null,React.createElement("div",{className:sn.classNames("ͼbaseflow-VarSelector",M,{testRun:!s}),"data-mode":M,"data-baseflow-role":sn.domRoles.SuperInputVariables,ref:C},D,React.createElement("div",{className:"ͼbaseflow-VarSelector__editor"},React.createElement("div",{className:"monaco",ref:S}),React.createElement("div",{className:"footer"},React.createElement(Lr.Button,{onClick:()=>o.setCurrentSuperInput(void 0)},n.cancel),React.createElement(Lr.Button,{type:"dashed",onClick:R.fm},n.format),React.createElement(Lr.Button,{type:"primary",onClick:k},n.submit)))),"complex"===M&&React.createElement("div",{className:"ͼbaseflow-Modal__mask ͼbaseflow-VarSelector__mask"}))});var jg=t.memo(Bg);var Fg=t.memo(({graph:e})=>{const[n,a]=t.useState(1);return t.useEffect(()=>e.addListener("viewportZoomed",a),[]),React.createElement("div",{className:"ͼbaseflow-Flow__ZoomTools"},React.createElement("div",{className:"item"+(n>=1?" disable":""),title:"Zoom-In"},React.createElement(vo,{name:Ga,onClick:e.zoomIn})),React.createElement("div",{className:"item",title:"Fit-All"},React.createElement(vo,{name:Ka,onClick:e.zoomFit})),React.createElement("div",{className:"item"+(n<=.2?" disable":""),title:"Zoom-Out"},React.createElement(vo,{name:qa,onClick:e.zoomOut})))});var Hg=t.memo(({className:e,initialData:n,graphHooks:a,onShowCreater:o,options:r,onInit:s,onClick:i})=>{const[l,c]=t.useState(),[d,h]=t.useState(n.triggers),[m,p]=t.useState(),[g,f]=t.useState([]),[y,v]=t.useState(),[b,E]=t.useState(),N=t.useRef(null),C=l?.graph.getState(),[w,S]=t.useState(),x=Sr(e=>{const t=function(e,t,n,a,o,r){return new Na(e,t,n,a,o,r)}(n,N.current,o,a,r||{},e);p({layout:t.getLayout()}),c({graph:t}),t.addListener("triggersChanged",h),t.addListener("layoutChanged",p),t.addListener("selectedChanged",f),t.addListener("currentNodeChanged",v),t.addListener("currentInputChanged",E),s?.(t.getIGraph())}),R=t.useMemo(()=>{if(l)return{graph:l.graph.getIGraph()}},[l]),M=t.useMemo(()=>{if(l&&m){const{layout:e,layoutData:t,viewport:n}=m,a=l.graph.getGraphData().nodes;let o=t;o||("dagre"===e?o=ui(a,l.graph):"code"===e?o=ia(a):"dsl"===e&&(o=ga.graphToJson(l.graph.getGraphData())));return{layout:e,graph:l.graph,initialLayoutData:o,initialViewport:n||{zoom:1,x:0,y:0}}}},[l,m]),_=t.useMemo(()=>{if(l){return{validateSuperInput:l.graph.validateServer.validateSuperInput,setActivedSuperInput:e=>l.graph.setCurrentSuperInput(e||void 0),getActivedSuperInput:()=>l.graph.getCurrentSuperInput()||null}}},[l]);return t.useEffect(()=>{const e=oa.createValidateProvider();return Promise.all([e.proxy,u(n.sources,{},a.onImportNode.bind(a))]).then(e=>x(e[0]),e=>S(e)),()=>{e.destory(),l?.graph.dispose()}},[]),w?React.createElement("div",{className:sn.classNames("ͼbaseflow-Flow",C,e)},React.createElement("div",{style:{padding:"10px",color:"red"}},w?.message||w.toString())):React.createElement("div",{className:sn.classNames("ͼbaseflow-Flow",C,e),ref:N,onClick:i},M?React.createElement(ng.Provider,{value:l},React.createElement(tg.Provider,{value:R},React.createElement(kg,{selected:g,graph:l.graph},"code"===M.layout?React.createElement(li,{...M}):"dagre"===M.layout?React.createElement(ig,{...M}):React.createElement(cg,{...M}),React.createElement(Lg,{graph:l.graph,initialList:d,selected:g?.[0],onShowCreater:o})),React.createElement("div",{className:"tools"},React.createElement(dg,{graph:R.graph}),"dsl"!==M.layout&&React.createElement(Fg,{graph:R.graph})),React.createElement(wr,{value:_},React.createElement(_g,{graph:l.graph}),React.createElement(Eg,{node:y?.node,graph:l.graph})),React.createElement(jg,{graph:l.graph,superInput:b,currentNodeId:y?.nodeId}))):React.createElement("div",{style:{padding:"10px"}},React.createElement(Lr.Spin,null)))});var Zg=t.memo(({graph:e})=>{const[n,a]=t.useState({undoAble:!1,redoAble:!1}),[o,r]=t.useState(e.getSaverState()),s=e.getState(),i="NodeOnly"===s||"ReadOnly"===s;return t.useEffect(()=>e.addListener("historyChanged",a),[]),t.useEffect(()=>e.addListener("saverChanged",r),[]),React.createElement("div",{className:"ͼbaseflow-Flow__HistoryTools"},React.createElement("div",{className:sn.classNames("item",{disable:!n.undoAble||i}),title:"Undo"},React.createElement(vo,{name:Ba,onClick:e.undo})),React.createElement("div",{className:sn.classNames("item",{disable:!n.redoAble||i}),title:"Redo"},React.createElement(vo,{name:ja,onClick:e.redo})),React.createElement(Lr.Button,{className:"save",type:"primary",disabled:"disable"===o||i,loading:"saving"===o,onClick:()=>e.save()},"保存"))});e.BaseLang=Wp,e.BaseWidgets=Qp,e.ConditionSelector=ss,e.DataType=R,e.DefalutGraphHooks=class{_graph;setGraph(e){this._graph=e}getGraph(){return this._graph}onBeforeSelect(e){if(e.getType()===s.Flow)throw new Error(n.notAllowedToSelectFlowNode)}onBeforeReselect(e){if(e.find(e=>e.getType()===s.Flow)&&1!==e.length)throw new Error(n.notAllowedToSelectFlowNode)}onBeforeApplyTrigger(){}onBeforeDeleteTrigger(){}onBeforeApplyNodes(e,t,o){const r=o.reduce((e,t)=>(t.id&&(e[t.id]=t.id),e),{});o=o.filter(e=>!r[e.parentId||""]);const i=this.getGraph().getNodeById(e),l=i.getName(),c=i.getType(),d="inside"===t?i:this.getGraph().getNodeById(i.getParentId()),u=d.getType(),h=d.getName();if("behind"===t&&(c===s.End||i.isDefaultBranch()))throw new Error(a(n.notAllowedToAddBehind,{node:l}));if(!d.isContainer())throw new Error(a(n.notAllowedToAddChild,{node:h}));for(const e of o){const o=e.tag||"",r=this.getGraph().getNodeConfigByTag(o).type;if((r===s.Start||r===s.End)&&"replace"!==t)throw new Error(n.startOrEndCanOnlyBeReplace);if(u===s.Choice&&r!==s.Branch||u===s.Parallel&&r!==s.Thread)throw new Error(a(n.onlySameBranchCanBeAdd,{node:h}));if(r===s.Branch&&u!==s.Choice||r===s.Thread&&u!==s.Parallel)throw new Error(a(n.notAllowedToAddBranch,{node:h}))}}onBeforeDeleteNodes(e,t,o){for(const e in t){const t=this.getGraph().getNodeById(e);if(!t)throw new Error(a(n.nodeNotExist,{node:e}));if(!m.deleteAble(t.getType()))throw new Error(a(n.notAllowedToDelete,{node:t.getName()}));if(t.isDefaultBranch())throw new Error(a(n.notAllowedToDeleteDefaultBranch,{node:t.getName()}))}for(const e in o){const t=this.getGraph().getNodeById(e),r=o[e];if(t.isRoute()&&t.getChildrenLength()-Object.keys(r).length<2)throw new Error(a(n.keepAtLeast2Branches,{node:t.getName()}))}}onBeforeMoveNodes(e,t,o,r,i){const l=this.getGraph().getNodeById(e),c="inside"===t?l.getId():l.getParentId();if(o[e])throw new Error(a(n.notAllowedToMoveThat,{node:l.getName()}));for(const e in r){const t=this.getGraph().getNodeById(e);if(!t)throw new Error(a(n.nodeNotExist,{node:e}));if(t.getType()===s.Start||t.getType()===s.End)throw new Error(a(n.notAllowedToMove,{node:t.getName()}));if(t.isDefaultBranch())throw new Error(a(n.notAllowedToMoveDefaultBranch,{node:t.getName()}))}for(const o in i){const r=this.getGraph().getNodeById(o),s=i[o];if(c!==o){if(r.isRoute()&&r.getChildrenLength()-Object.keys(s).length<2)throw new Error(a(n.keepAtLeast2Branches,{node:r.getName()}));this.onBeforeApplyNodes(e,t,Object.keys(s).map(e=>this.getGraph().getNodeDataById(e)))}}}},e.DslTools=ga,e.Flow=Hg,e.FlowConfigProvider=Jp,e.FlowErrors=o,e.HistoryTools=Zg,e.JsonView=bs,e.KeyValues=Ns,e.LayoutTools=dg,e.NodeType=s,e.RequiredRule=[{required:!0}],e.SchemaModelForm=Ts,e.SchemaSelector=As,e.SchemaShow=Os,e.SchemaValueForm=js,e.SuperInput=Wr,e.SvgIcon=vo,e.ValueSource=I,e.XMLBuilder=Ge,e.XMLParser=Be,e.XMLValidator=We,e.ZoomTools=Fg,e.classnames=S,e.createSchemaValueByModel=Ca,e.getLocale=function(){return ta.locale},e.getNodeDefaultSize=function(){return v.nodeDefaultSize},e.getRegisteredNode=function(e){return l[e]},e.produce=Qt,e.produceOriginal=function(e){const t=mt(e);if(!t)throw new Error(`original() is only used for a draft, parameter: ${e}`);return t.original},e.registerNode=d,e.useEvent=Sr,e.useGraph=function(){return t.useContext(eg)},e.useNode=function(e){t.useContext(eg);const{graph:n}=t.useContext(ng),a=n.get_NodeById(e),[o,r]=a.getTNode();return{nodeReader:o,nodeActions:r,node:a.getINode()}}});
